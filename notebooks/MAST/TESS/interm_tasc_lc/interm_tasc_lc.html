
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Intermediate: Finding Flares and Variable Stars in TASC Light Curves &#8212; MAST Notebook Repository</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/main.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/table.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Intermediate: Retrieve TESS Pixel Response Function Images" href="../interm_tess_prf_retrieve/interm_tess_prf_retrieve.html" />
    <link rel="prev" title="Intermediate: Search and Download GI Program Light Curves" href="../interm_gi_query/interm_gi_query.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../../_static/mastlogo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">MAST Notebook Repository</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../../intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Astroquery
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../astroquery/beginner_search_astroquery/beginner_search_astroquery.html">
   Beginner: Searching MAST using astroquery.mast
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../astroquery/large_downloads/large_downloads.html">
   Large Downloads in
   <code class="docutils literal notranslate">
    <span class="pre">
     astroquery.mast
    </span>
   </code>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  HSC
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../HSC/HCV_API/HCV_API_demo.html">
   Hubble Catalog of Variables Notebook (API version)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../HSC/HCV_CASJOBS/HCV_casjobs_demo.html">
   Hubble Catalog of Variables Notebook (CasJobs version)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../HSC/HSCV3_API/hscv3_api.html">
   Hubble Source Catalog API Notebook
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../HSC/HSCV3_SMC_API/hscv3_smc_api.html">
   Hubble Source Catalog API Notebook: SMC Color-Magnitude Diagram
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../HSC/HSC_TAP/HSC_TAP.html">
   MAST Table Access Protocol Hubble Source Catalog Demo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../HSC/SWEEPS_HSCV3P1/sweeps_hscv3p1.html">
   Hubble Source Catalog SWEEPS Proper Motion Notebook
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../HSC/SWEEPS_HSCV3P1_API/sweeps_hscv3p1_api.html">
   Hubble Source Catalog SWEEPS Proper Motion Notebook
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  JWST
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../JWST/download_by_program_id/download_by_program_id.html">
   Accessing JWST Proposal Data in astroquery.mast
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../JWST/Engineering_Database_Retreival/EDB_Retrieval.html">
   JWST Engineering Data Retrieval
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Kepler K2
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../K2/K2_Lightcurve/K2_Lightcurve.html">
   Beginner: Read and Plot A K2 Light Curve File
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../K2/K2_TPF/K2_TPF.html">
   Beginner: Read and Display A K2 Target Pixel File
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../K2/beginner_how_to_use_ffi/beginner_how_to_use_ffi.html">
   Beginner: Read and Display a K2 Full Frame Image
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../K2/k2_removing_instrumental_noise_using_pld/k2_removing_instrumental_noise_using_pld.html">
   Removing Instrumental Noise from
   <em>
    K2
   </em>
   and
   <em>
    TESS
   </em>
   Light Curves Using Pixel Level Decorrelation (PLD)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Kepler
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/Kepler_DVT/Kepler_DVT.html">
   Read and Plot A Kepler Data Validation Timeseries File
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/Kepler_FFI/kepler_ffi.html">
   Plotting a Catalog over a Kepler Full Frame Image File
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/Kepler_Lightcurve/kepler_lightcurve.html">
   Using Kepler Data to Plot a Light Curve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/Kepler_TPF/kepler_tpf.html">
   Plotting Images from Kepler Target Pixel Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_combining_multiple_quarters/kepler_combining_multiple_quarters.html">
   Combining Multiple Quarters of
   <em>
    Kepler
   </em>
   Data with Lightkurve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_creating_periodograms/kepler_creating_periodograms.html">
   Creating Periodograms and Identifying Significant Peaks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_creating_your_own_light_curves/kepler_creating_your_own_light_curves.html">
   Creating Your Own Light Curves using Custom Aperture Photometry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_how_to_estimate_a_stars_mass_and_radius_using_asteroseismology/kepler_how_to_estimate_a_stars_mass_and_radius_using_asteroseismology.html">
   How to Estimate a Star’s Mass and Radius Using Asteroseismology
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_how_to_understand_and_manipulate_the_periodogram_of_an_oscillating_star/kepler_how_to_understand_and_manipulate_the_periodogram_of_an_oscillating_star.html">
   How to Understand and Manipulate the Periodogram of an Oscillating Star
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_identifying_transiting_planet_signals/kepler_identifying_transiting_planet_signals.html">
   Identifying Transiting Planet Signals in a
   <em>
    Kepler
   </em>
   Light Curve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_instrumental_noise_1_data_gaps_and_quality_flags/kepler_instrumental_noise_1_data_gaps_and_quality_flags.html">
   Instrumental Noise in
   <em>
    Kepler
   </em>
   and
   <em>
    K2
   </em>
   #1: Data Gaps and Quality Flags
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_instrumental_noise_2_spurious_signals_and_time_sampling_effects/kepler_instrumental_noise_2_spurious_signals_and_time_sampling_effects.html">
   Instrumental Noise in
   <em>
    Kepler
   </em>
   and
   <em>
    K2
   </em>
   #2: Spurious Signals and Time Sampling Effects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_instrumental_noise_3_seasonal_and_detector_effects/kepler_instrumental_noise_3_seasonal_and_detector_effects.html">
   Instrumental Noise in
   <em>
    Kepler
   </em>
   and
   <em>
    K2
   </em>
   #3: Seasonal and Detector Effects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_instrumental_noise_4_electronic_noise/kepler_instrumental_noise_4_electronic_noise.html">
   Instrumental Noise in
   <em>
    Kepler
   </em>
   and
   <em>
    K2
   </em>
   #4: Electronic Noise
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_interactively_inspecting_target_pixel_files_and_light_curves/kepler_interactively_inspecting_target_pixel_files_and_light_curves.html">
   Interactively Inspecting Target Pixel Files and Light Curves
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_measuring_a_rotation_period/kepler_measuring_a_rotation_period.html">
   Measuring and Removing a Rotation Period Signal from a
   <em>
    Kepler
   </em>
   Light Curve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_plotting_target_pixel_files/kepler_plotting_target_pixel_files.html">
   Plotting
   <em>
    Kepler
   </em>
   Target Pixel File Products with Lightkurve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_searching_for_data_products/kepler_searching_for_data_products.html">
   Searching for
   <em>
    Kepler
   </em>
   /
   <em>
    K2
   </em>
   and
   <em>
    TESS
   </em>
   Data Products Using Lightkurve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_using_light_curve_products_with_lightkurve/kepler_using_light_curve_products_with_lightkurve.html">
   Using
   <em>
    Kepler
   </em>
   Light Curve Products with Lightkurve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_using_target_pixel_file_products_with_lightkurve/kepler_using_target_pixel_file_products_with_lightkurve.html">
   Using
   <em>
    Kepler
   </em>
   Target Pixel File Products with Lightkurve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_verifying_the_location_of_a_signal/kepler_verifying_the_location_of_a_signal.html">
   Verifying the Location of a Signal in
   <em>
    Kepler
   </em>
   Pixel Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_visualizing_periodic_signals_using_a_river_plot/kepler_visualizing_periodic_signals_using_a_river_plot.html">
   Visualizing Periodic Signals Using a River Plot
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  PanSTARRS
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../PanSTARRS/PS1_DR2_TAP/PS1_DR2_TAP.html">
   MAST Table Access Protocol PanSTARRS 1 DR2 Demo
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  TESS
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../beginner_astroquery_dv/beginner_astroquery_dv.html">
   Beginner: Retrieve TESS Data Validation Products with Astroquery
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../beginner_how_to_use_dvt/beginner_how_to_use_dvt.html">
   Beginner: Read and Plot A TESS Data Validation Timeseries File
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../beginner_how_to_use_ffi/beginner_how_to_use_ffi.html">
   Beginner: Read and Display a TESS Full Frame Image
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../beginner_how_to_use_lc/beginner_how_to_use_lc.html">
   Beginner: Read and Plot A TESS Light Curve File
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../beginner_how_to_use_tp/beginner_how_to_use_tp.html">
   Beginner: Read and Display A TESS Target Pixel File
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../beginner_tess_exomast/beginner_tess_exomast.html">
   Exoplanet Data and TESS Light Curves Using Python Requests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../beginner_tess_tap_search/beginner_tess_tap_search.html">
   Download MAST TESS Light Curves Within an FFI Footprint Using TAP
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../beginner_tic_search_hd209458/beginner_tic_search_hd209458.html">
   Beginner: Search The TESS Input Catalog Centered On HD 209458.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../beginner_tour_lc_tp/beginner_tour_lc_tp.html">
   Beginnner: A Tour of the Contents of the TESS 2-minute Cadence Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../interm_gi_query/interm_gi_query.html">
   Intermediate:  Search and Download GI Program Light Curves
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Intermediate: Finding Flares and Variable Stars in TASC Light Curves
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../interm_tess_prf_retrieve/interm_tess_prf_retrieve.html">
   Intermediate: Retrieve TESS Pixel Response Function Images
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../interm_tesscut_astroquery/interm_tesscut_astroquery.html">
   Beginner: Cutout of the TESS FFIs using Astrocut and Astroquery
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../interm_tesscut_dss_overlay/interm_tesscut_dss_overlay.html">
   Intermediate: Overlay a Cutout of the TESS FFIs with DSS imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../interm_tesscut_requests/interm_tesscut_requests.html">
   Intermediate: Create TESS FFI Cutout using Python Requests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tess_removing_scattered_light_using_regression/tess_removing_scattered_light_using_regression.html">
   Removing Scattered Light from
   <em>
    TESS
   </em>
   Data Using the Lightkurve
   <code class="docutils literal notranslate">
    <span class="pre">
     RegressionCorrector
    </span>
   </code>
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/spacetelescope/mast_notebooks"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/spacetelescope/mast_notebooks/issues/new?title=Issue%20on%20page%20%2Fnotebooks/MAST/TESS/interm_tasc_lc/interm_tasc_lc.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../../_sources/notebooks/MAST/TESS/interm_tasc_lc/interm_tasc_lc.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#table-of-contents">
   Table of contents
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#terminology">
   Terminology
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#imports">
   Imports
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exploring-a-stellar-flare">
   Exploring a stellar flare
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#selecting-the-flare">
     Selecting the flare
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#querying-mast">
     Querying MAST
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mission-light-curves">
       Mission light curves
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#tasoc-light-curves">
       TASOC light curves
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#downloading-the-light-curves">
     Downloading the light curves
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#querying-for-the-list-of-associated-data-products">
       Querying for the list of associated data products
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#downloading-files">
       Downloading files
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plotting-the-light-curves">
     Plotting the light curves
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#making-an-animation">
     Making an animation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exploring-the-cutout-time-series">
       Exploring the cutout time series
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#looking-at-the-animated-cutout">
       Looking at the animated cutout
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exploring-a-variable-star">
   Exploring a variable star
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#overlaying-tic-sources">
     Overlaying TIC sources
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plotting-sources-on-an-individual-cutout">
       Plotting sources on an individual cutout
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#getting-the-variable-star-light-curve">
     Getting the variable star light curve
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plotting-the-variable-star-light-curve">
     Plotting the variable star light curve
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-the-period">
     Finding the period
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plotting-the-periodogram">
       Plotting the periodogram
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#phasing-on-the-highest-power-period-frequency">
       Phasing on the highest power period/frequency
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#additional-resources">
   Additional Resources
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#about-this-notebook">
   About this Notebook
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Intermediate: Finding Flares and Variable Stars in TASC Light Curves</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#table-of-contents">
   Table of contents
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#terminology">
   Terminology
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#imports">
   Imports
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exploring-a-stellar-flare">
   Exploring a stellar flare
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#selecting-the-flare">
     Selecting the flare
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#querying-mast">
     Querying MAST
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mission-light-curves">
       Mission light curves
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#tasoc-light-curves">
       TASOC light curves
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#downloading-the-light-curves">
     Downloading the light curves
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#querying-for-the-list-of-associated-data-products">
       Querying for the list of associated data products
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#downloading-files">
       Downloading files
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plotting-the-light-curves">
     Plotting the light curves
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#making-an-animation">
     Making an animation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exploring-the-cutout-time-series">
       Exploring the cutout time series
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#looking-at-the-animated-cutout">
       Looking at the animated cutout
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exploring-a-variable-star">
   Exploring a variable star
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#overlaying-tic-sources">
     Overlaying TIC sources
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plotting-sources-on-an-individual-cutout">
       Plotting sources on an individual cutout
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#getting-the-variable-star-light-curve">
     Getting the variable star light curve
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plotting-the-variable-star-light-curve">
     Plotting the variable star light curve
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-the-period">
     Finding the period
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plotting-the-periodogram">
       Plotting the periodogram
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#phasing-on-the-highest-power-period-frequency">
       Phasing on the highest power period/frequency
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#additional-resources">
   Additional Resources
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#about-this-notebook">
   About this Notebook
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <p><a id="title_ID"></a></p>
<section class="tex2jax_ignore mathjax_ignore" id="intermediate-finding-flares-and-variable-stars-in-tasc-light-curves">
<h1>Intermediate: Finding Flares and Variable Stars in TASC Light Curves<a class="headerlink" href="#intermediate-finding-flares-and-variable-stars-in-tasc-light-curves" title="Permalink to this headline">#</a></h1>
<p>This notebook demostrates MAST’s programmatic tools for accessing TESS time series data while exploring a flaring star from the literature (<a class="reference external" href="https://arxiv.org/abs/1901.00443">Günther et al 2019</a>) and a nearby variable star.</p>
<p>The following topics will be covered:</p>
<ul class="simple">
<li><p>Using the MAST API to get mission pipeline and TASOC light curves</p></li>
<li><p>Plotting TESS light curves in Python</p></li>
<li><p>Using the MAST API to make an full frame image (FFI) cutout</p></li>
<li><p>Creating a movie of TPF frames in Python</p></li>
<li><p>Using the MAST API to get a list of TESS Input Catalog (TIC) sources</p></li>
<li><p>Over plotting TIC sources on TESS images</p></li>
<li><p>Exploring the period of a variable star</p></li>
</ul>
<section id="table-of-contents">
<h2>Table of contents<a class="headerlink" href="#table-of-contents" title="Permalink to this headline">#</a></h2>
<ol class="simple">
<li><p><a class="reference external" href="#Exploring-a-stellar-flare">Exploring a known stellar flare</a></p>
<ol class="simple">
<li><p><a class="reference external" href="#Querying-MAST">Querying MAST</a></p></li>
<li><p><a class="reference external" href="#Downloading-the-light-curves">Downloading the light curves</a></p></li>
<li><p><a class="reference external" href="#Plotting-the-light-curves">Plotting the light curves</a></p></li>
<li><p><a class="reference external" href="#Making-an-animation">Making an animation</a></p></li>
</ol>
</li>
<li><p><a class="reference external" href="#Exploring-a-variable-star">Exploring a variable star</a></p>
<ol class="simple">
<li><p><a class="reference external" href="#Overlaying-TIC-sources">Overlaying TESS Input Catalog sources</a></p></li>
<li><p><a class="reference external" href="#Getting-the-variable-star-light-curve">Getting the variable star light curve</a></p></li>
<li><p><a class="reference external" href="#Plotting-the-variable-star-light-curve">Plotting the variable star light curve</a></p></li>
<li><p><a class="reference external" href="#Finding-the-period">Finding the period of the variable star</a></p></li>
</ol>
</li>
<li><p><a class="reference external" href="#Additional-Resources">Additional Resources</a></p></li>
<li><p><a class="reference external" href="#About-this-Notebook">About this Notebook</a></p></li>
</ol>
</section>
<hr class="docutils" />
<section id="terminology">
<h2>Terminology<a class="headerlink" href="#terminology" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><strong>TESS:</strong> The Transiting Exoplanet Survey Satellite</p></li>
<li><p><strong>TASOC:</strong> The TESS Asteroseismic Science Operations Center</p></li>
<li><p><strong>Sector:</strong> TESS observed the sky in regions of 24x96 degrees along the southern, then northern, ecliptic hemispheres. Each of these regions is referred to as a “sector”, starting with Sector 1.</p></li>
<li><p><strong>TIC:</strong> The TESS input catalog.</p></li>
<li><p><strong>FFI:</strong> TESS periodically reads out the entire frame of all four cameras, nominally every 30 minutes, and stores them as full frame images (FFIs).</p></li>
<li><p><strong>TPF:</strong> Target Pixel File, a fits file containing stacks of small images centered on a target, one image for every timestamp the telescope took data.</p></li>
<li><p><strong>HDU:</strong> Header Data Unit. A FITS file is made up of HDUs that contain data and metadata relating to the file. The first HDU is called the primary HDU, and anything that follows is considered an “extension”, e.g., “the first FITS extension”, “the second FITS extension”, etc.</p></li>
<li><p><strong>HDUList:</strong> A list of HDUs that comprise a fits file.</p></li>
<li><p><strong>BJD:</strong> Barycentric Julian Date, the Julian Date that has been corrected for differences in the Earth’s position with respect to the Solar System center of mass.</p></li>
<li><p><strong>BTJD:</strong> Barycentric TESS Julian Date, the timestamp measured in BJD, but offset by 2457000.0. I.e., BTJD = BJD - 2457000.0</p></li>
<li><p><strong>WCS:</strong> World Coordinate System, the coordinates that locate an astronomical object on the sky.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this headline">#</a></h2>
<p>In this notbook we will use the MAST module of Astroquery (<code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code>) to query and download data, and various <code class="docutils literal notranslate"><span class="pre">astropy</span></code> and <code class="docutils literal notranslate"><span class="pre">numpy</span></code> functions to manipulate the data. We will use both the <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> and <code class="docutils literal notranslate"><span class="pre">bokeh</span></code> plotting packages to visualize our data as they have different strengths and weaknesses.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For querying for data</span>
<span class="kn">from</span> <span class="nn">astroquery.mast</span> <span class="kn">import</span> <span class="n">Tesscut</span><span class="p">,</span> <span class="n">Observations</span><span class="p">,</span> <span class="n">Catalogs</span>

<span class="c1"># For manipulating data</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">Table</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">SkyCoord</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="kn">from</span> <span class="nn">astropy.wcs</span> <span class="kn">import</span> <span class="n">WCS</span>
<span class="kn">from</span> <span class="nn">astropy.timeseries</span> <span class="kn">import</span> <span class="n">LombScargle</span>
<span class="kn">from</span> <span class="nn">astropy.time</span> <span class="kn">import</span> <span class="n">Time</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>

<span class="c1"># For matplotlib plotting</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.animation</span> <span class="k">as</span> <span class="nn">animation</span>

<span class="c1"># For animation display</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rc</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>
<span class="n">rc</span><span class="p">(</span><span class="s1">&#39;animation&#39;</span><span class="p">,</span> <span class="n">html</span><span class="o">=</span><span class="s1">&#39;jshtml&#39;</span><span class="p">)</span>

<span class="c1"># For bokeh plotting</span>
<span class="kn">from</span> <span class="nn">bokeh</span> <span class="kn">import</span> <span class="n">plotting</span>
<span class="kn">from</span> <span class="nn">bokeh.models</span> <span class="kn">import</span> <span class="n">Span</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">output_notebook</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
        .bk-notebook-logo {
            display: block;
            width: 20px;
            height: 20px;
            background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNui8sowAAAOkSURBVDiNjZRtaJVlGMd/1/08zzln5zjP1LWcU9N0NkN8m2CYjpgQYQXqSs0I84OLIC0hkEKoPtiH3gmKoiJDU7QpLgoLjLIQCpEsNJ1vqUOdO7ppbuec5+V+rj4ctwzd8IIbbi6u+8f1539dt3A78eXC7QizUF7gyV1fD1Yqg4JWz84yffhm0qkFqBogB9rM8tZdtwVsPUhWhGcFJngGeWrPzHm5oaMmkfEg1usvLFyc8jLRqDOMru7AyC8saQr7GG7f5fvDeH7Ej8CM66nIF+8yngt6HWaKh7k49Soy9nXurCi1o3qUbS3zWfrYeQDTB/Qj6kX6Ybhw4B+bOYoLKCC9H3Nu/leUTZ1JdRWkkn2ldcCamzrcf47KKXdAJllSlxAOkRgyHsGC/zRday5Qld9DyoM4/q/rUoy/CXh3jzOu3bHUVZeU+DEn8FInkPBFlu3+nW3Nw0mk6vCDiWg8CeJaxEwuHS3+z5RgY+YBR6V1Z1nxSOfoaPa4LASWxxdNp+VWTk7+4vzaou8v8PN+xo+KY2xsw6une2frhw05CTYOmQvsEhjhWjn0bmXPjpE1+kplmmkP3suftwTubK9Vq22qKmrBhpY4jvd5afdRA3wGjFAgcnTK2s4hY0/GPNIb0nErGMCRxWOOX64Z8RAC4oCXdklmEvcL8o0BfkNK4lUg9HTl+oPlQxdNo3Mg4Nv175e/1LDGzZen30MEjRUtmXSfiTVu1kK8W4txyV6BMKlbgk3lMwYCiusNy9fVfvvwMxv8Ynl6vxoByANLTWplvuj/nF9m2+PDtt1eiHPBr1oIfhCChQMBw6Aw0UulqTKZdfVvfG7VcfIqLG9bcldL/+pdWTLxLUy8Qq38heUIjh4XlzZxzQm19lLFlr8vdQ97rjZVOLf8nclzckbcD4wxXMidpX30sFd37Fv/GtwwhzhxGVAprjbg0gCAEeIgwCZyTV2Z1REEW8O4py0wsjeloKoMr6iCY6dP92H6Vw/oTyICIthibxjm/DfN9lVz8IqtqKYLUXfoKVMVQVVJOElGjrnnUt9T9wbgp8AyYKaGlqingHZU/uG2NTZSVqwHQTWkx9hxjkpWDaCg6Ckj5qebgBVbT3V3NNXMSiWSDdGV3hrtzla7J+duwPOToIg42ChPQOQjspnSlp1V+Gjdged7+8UN5CRAV7a5EdFNwCjEaBR27b3W890TE7g24NAP/mMDXRWrGoFPQI9ls/MWO2dWFAar/xcOIImbbpA3zgAAAABJRU5ErkJggg==);
        }
    </style>
    <div>
        <a href="https://bokeh.org" target="_blank" class="bk-notebook-logo"></a>
        <span id="p1001">Loading BokehJS ...</span>
    </div>
</div><script type="application/javascript">(function(root) {
  function now() {
    return new Date();
  }

  const force = true;

  if (typeof root._bokeh_onload_callbacks === "undefined" || force === true) {
    root._bokeh_onload_callbacks = [];
    root._bokeh_is_loading = undefined;
  }

const JS_MIME_TYPE = 'application/javascript';
  const HTML_MIME_TYPE = 'text/html';
  const EXEC_MIME_TYPE = 'application/vnd.bokehjs_exec.v0+json';
  const CLASS_NAME = 'output_bokeh rendered_html';

  /**
   * Render data to the DOM node
   */
  function render(props, node) {
    const script = document.createElement("script");
    node.appendChild(script);
  }

  /**
   * Handle when an output is cleared or removed
   */
  function handleClearOutput(event, handle) {
    const cell = handle.cell;

    const id = cell.output_area._bokeh_element_id;
    const server_id = cell.output_area._bokeh_server_id;
    // Clean up Bokeh references
    if (id != null && id in Bokeh.index) {
      Bokeh.index[id].model.document.clear();
      delete Bokeh.index[id];
    }

    if (server_id !== undefined) {
      // Clean up Bokeh references
      const cmd_clean = "from bokeh.io.state import curstate; print(curstate().uuid_to_server['" + server_id + "'].get_sessions()[0].document.roots[0]._id)";
      cell.notebook.kernel.execute(cmd_clean, {
        iopub: {
          output: function(msg) {
            const id = msg.content.text.trim();
            if (id in Bokeh.index) {
              Bokeh.index[id].model.document.clear();
              delete Bokeh.index[id];
            }
          }
        }
      });
      // Destroy server and session
      const cmd_destroy = "import bokeh.io.notebook as ion; ion.destroy_server('" + server_id + "')";
      cell.notebook.kernel.execute(cmd_destroy);
    }
  }

  /**
   * Handle when a new output is added
   */
  function handleAddOutput(event, handle) {
    const output_area = handle.output_area;
    const output = handle.output;

    // limit handleAddOutput to display_data with EXEC_MIME_TYPE content only
    if ((output.output_type != "display_data") || (!Object.prototype.hasOwnProperty.call(output.data, EXEC_MIME_TYPE))) {
      return
    }

    const toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);

    if (output.metadata[EXEC_MIME_TYPE]["id"] !== undefined) {
      toinsert[toinsert.length - 1].firstChild.textContent = output.data[JS_MIME_TYPE];
      // store reference to embed id on output_area
      output_area._bokeh_element_id = output.metadata[EXEC_MIME_TYPE]["id"];
    }
    if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
      const bk_div = document.createElement("div");
      bk_div.innerHTML = output.data[HTML_MIME_TYPE];
      const script_attrs = bk_div.children[0].attributes;
      for (let i = 0; i < script_attrs.length; i++) {
        toinsert[toinsert.length - 1].firstChild.setAttribute(script_attrs[i].name, script_attrs[i].value);
        toinsert[toinsert.length - 1].firstChild.textContent = bk_div.children[0].textContent
      }
      // store reference to server id on output_area
      output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
    }
  }

  function register_renderer(events, OutputArea) {

    function append_mime(data, metadata, element) {
      // create a DOM node to render to
      const toinsert = this.create_output_subarea(
        metadata,
        CLASS_NAME,
        EXEC_MIME_TYPE
      );
      this.keyboard_manager.register_events(toinsert);
      // Render to node
      const props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
      render(props, toinsert[toinsert.length - 1]);
      element.append(toinsert);
      return toinsert
    }

    /* Handle when an output is cleared or removed */
    events.on('clear_output.CodeCell', handleClearOutput);
    events.on('delete.Cell', handleClearOutput);

    /* Handle when a new output is added */
    events.on('output_added.OutputArea', handleAddOutput);

    /**
     * Register the mime type and append_mime function with output_area
     */
    OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
      /* Is output safe? */
      safe: true,
      /* Index of renderer in `output_area.display_order` */
      index: 0
    });
  }

  // register the mime type if in Jupyter Notebook environment and previously unregistered
  if (root.Jupyter !== undefined) {
    const events = require('base/js/events');
    const OutputArea = require('notebook/js/outputarea').OutputArea;

    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  }
  if (typeof (root._bokeh_timeout) === "undefined" || force === true) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  const NB_LOAD_WARNING = {'data': {'text/html':
     "<div style='background-color: #fdd'>\n"+
     "<p>\n"+
     "BokehJS does not appear to have successfully loaded. If loading BokehJS from CDN, this \n"+
     "may be due to a slow or bad network connection. Possible fixes:\n"+
     "</p>\n"+
     "<ul>\n"+
     "<li>re-rerun `output_notebook()` to attempt to load from CDN again, or</li>\n"+
     "<li>use INLINE resources instead, as so:</li>\n"+
     "</ul>\n"+
     "<code>\n"+
     "from bokeh.resources import INLINE\n"+
     "output_notebook(resources=INLINE)\n"+
     "</code>\n"+
     "</div>"}};

  function display_loaded() {
    const el = document.getElementById("p1001");
    if (el != null) {
      el.textContent = "BokehJS is loading...";
    }
    if (root.Bokeh !== undefined) {
      if (el != null) {
        el.textContent = "BokehJS " + root.Bokeh.version + " successfully loaded.";
      }
    } else if (Date.now() < root._bokeh_timeout) {
      setTimeout(display_loaded, 100)
    }
  }

  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];

    root._bokeh_onload_callbacks.push(callback);
    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls == null || js_urls.length === 0) {
      run_callbacks();
      return null;
    }
    console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    root._bokeh_is_loading = css_urls.length + js_urls.length;

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }

    function on_error(url) {
      console.error("failed to load " + url);
    }

    for (let i = 0; i < css_urls.length; i++) {
      const url = css_urls[i];
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error.bind(null, url);
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }

    for (let i = 0; i < js_urls.length; i++) {
      const url = js_urls[i];
      const element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error.bind(null, url);
      element.async = false;
      element.src = url;
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  const js_urls = ["https://cdn.bokeh.org/bokeh/release/bokeh-3.0.3.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-gl-3.0.3.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.0.3.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-tables-3.0.3.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-mathjax-3.0.3.min.js"];
  const css_urls = [];

  const inline_js = [    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
function(Bokeh) {
    }
  ];

  function run_inline_js() {
    if (root.Bokeh !== undefined || force === true) {
          for (let i = 0; i < inline_js.length; i++) {
      inline_js[i].call(root, root.Bokeh);
    }
if (force === true) {
        display_loaded();
      }} else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    } else if (force !== true) {
      const cell = $(document.getElementById("p1001")).parents('.cell').data().cell;
      cell.output_area.append_execute_result(NB_LOAD_WARNING)
    }
  }

  if (root._bokeh_is_loading === 0) {
    console.debug("Bokeh: BokehJS loaded, going straight to plotting");
    run_inline_js();
  } else {
    load_libs(css_urls, js_urls, function() {
      console.debug("Bokeh: BokehJS plotting callback run at", now());
      run_inline_js();
    });
  }
}(window));</script></div>
</div>
</section>
<hr class="docutils" />
<section id="exploring-a-stellar-flare">
<h2>Exploring a stellar flare<a class="headerlink" href="#exploring-a-stellar-flare" title="Permalink to this headline">#</a></h2>
<section id="selecting-the-flare">
<h3>Selecting the flare<a class="headerlink" href="#selecting-the-flare" title="Permalink to this headline">#</a></h3>
<p>We will start with a known flare from the literature, in this case from <a class="reference external" href="https://arxiv.org/abs/1901.00443">Günther, M. N., Zhan, Z., Seager, S.,
et al. 2019, arXiv e-prints, arXiv:1901.00443</a>. We picked a particularly long flare to give us the best chance of finding it in the 30 minute cadence data as well as the 2 minute cadence data.</p>
<p>We’ve made note of the TIC ID and sector for our flare of interest, as well as its peak time in BJD format:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tic_id</span> <span class="o">=</span> <span class="mi">141914082</span>
<span class="n">sector</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">tpeak</span> <span class="o">=</span> <span class="mf">2458341.89227</span> <span class="c1"># Julian Day</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="querying-mast">
<h3>Querying MAST<a class="headerlink" href="#querying-mast" title="Permalink to this headline">#</a></h3>
<section id="mission-light-curves">
<h4>Mission light curves<a class="headerlink" href="#mission-light-curves" title="Permalink to this headline">#</a></h4>
<p>Using the <code class="docutils literal notranslate"><span class="pre">query_criteria</span></code> function in the <code class="docutils literal notranslate"><span class="pre">astroquery.mast.Observations</span></code> class, we will specify that we are looking for TESS mission data using the <code class="docutils literal notranslate"><span class="pre">obs_collection</span></code> argument, that we want a specific TIC ID using the <code class="docutils literal notranslate"><span class="pre">target_name</span></code> argument, and that we want observations from a particular sector using the <code class="docutils literal notranslate"><span class="pre">sequence_number</span></code> argument.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mission_res</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">obs_collection</span><span class="o">=</span><span class="s2">&quot;TESS&quot;</span><span class="p">,</span> 
                                          <span class="n">target_name</span><span class="o">=</span><span class="n">tic_id</span><span class="p">,</span> 
                                          <span class="n">sequence_number</span><span class="o">=</span><span class="n">sector</span><span class="p">)</span>
<span class="n">mission_res</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table masked=True length=1</i>
<table id="table140552467931264" class="table-striped table-bordered table-condensed">
<thead><tr><th>dataproduct_type</th><th>calib_level</th><th>obs_collection</th><th>obs_id</th><th>target_name</th><th>s_ra</th><th>s_dec</th><th>t_min</th><th>t_max</th><th>t_exptime</th><th>wavelength_region</th><th>filters</th><th>em_min</th><th>em_max</th><th>target_classification</th><th>obs_title</th><th>t_obs_release</th><th>instrument_name</th><th>proposal_pi</th><th>proposal_id</th><th>proposal_type</th><th>project</th><th>sequence_number</th><th>provenance_name</th><th>s_region</th><th>jpegURL</th><th>dataURL</th><th>dataRights</th><th>mtFlag</th><th>srcDen</th><th>intentType</th><th>obsid</th><th>objID</th></tr></thead>
<thead><tr><th>str10</th><th>int64</th><th>str4</th><th>str47</th><th>str9</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>str7</th><th>str4</th><th>float64</th><th>float64</th><th>str1</th><th>str1</th><th>float64</th><th>str10</th><th>str14</th><th>str23</th><th>str1</th><th>str4</th><th>int64</th><th>str4</th><th>str41</th><th>str1</th><th>str73</th><th>str6</th><th>bool</th><th>float64</th><th>str7</th><th>str8</th><th>str9</th></tr></thead>
<tr><td>timeseries</td><td>3</td><td>TESS</td><td>tess2018206045859-s0001-0000000141914082-0120-s</td><td>141914082</td><td>94.6175354047675</td><td>-72.0448462219924</td><td>58324.79323696759</td><td>58352.67632608796</td><td>120.0</td><td>Optical</td><td>TESS</td><td>600.0</td><td>1000.0</td><td>--</td><td>--</td><td>58458.5833333</td><td>Photometer</td><td>Ricker, George</td><td>G011175_G011180_G011176</td><td>--</td><td>TESS</td><td>1</td><td>SPOC</td><td>CIRCLE 94.6175354 -72.04484622 0.00138889</td><td>--</td><td>mast:TESS/product/tess2018206045859-s0001-0000000141914082-0120-s_lc.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>science</td><td>60829534</td><td>110344410</td></tr>
</table></div></div></div>
</div>
</section>
<section id="tasoc-light-curves">
<h4>TASOC light curves<a class="headerlink" href="#tasoc-light-curves" title="Permalink to this headline">#</a></h4>
<p>In addition to mission pipeline data, MAST also hosts a variety of community contributed High Level Science Products (HLSPs), all of which are given the mission (<code class="docutils literal notranslate"><span class="pre">obs_collection</span></code>) “HLSP”. In this case we will specifically search for HLSPs in the TESS project, which will return the light curves provided by the TASOC (note the <code class="docutils literal notranslate"><span class="pre">provenance_name</span></code> of “TASOC”). All other arguments remain the same.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tasoc_res</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">target_name</span><span class="o">=</span><span class="n">tic_id</span><span class="p">,</span> 
                                        <span class="n">obs_collection</span><span class="o">=</span><span class="s2">&quot;HLSP&quot;</span><span class="p">,</span> 
                                        <span class="n">project</span><span class="o">=</span><span class="s2">&quot;TESS&quot;</span><span class="p">,</span>
                                        <span class="n">sequence_number</span><span class="o">=</span><span class="n">sector</span><span class="p">)</span>
<span class="n">tasoc_res</span><span class="p">[</span><span class="s1">&#39;dataproduct_type&#39;</span><span class="p">,</span><span class="s2">&quot;obs_collection&quot;</span><span class="p">,</span><span class="s2">&quot;target_name&quot;</span><span class="p">,</span><span class="s2">&quot;t_exptime&quot;</span><span class="p">,</span><span class="s2">&quot;filters&quot;</span><span class="p">,</span>
          <span class="s2">&quot;provenance_name&quot;</span><span class="p">,</span><span class="s2">&quot;project&quot;</span><span class="p">,</span><span class="s2">&quot;sequence_number&quot;</span><span class="p">,</span><span class="s2">&quot;instrument_name&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table length=6</i>
<table id="table140552467721968" class="table-striped table-bordered table-condensed">
<thead><tr><th>dataproduct_type</th><th>obs_collection</th><th>target_name</th><th>t_exptime</th><th>filters</th><th>provenance_name</th><th>project</th><th>sequence_number</th><th>instrument_name</th></tr></thead>
<thead><tr><th>str10</th><th>str4</th><th>str9</th><th>float64</th><th>str4</th><th>str17</th><th>str4</th><th>int64</th><th>str10</th></tr></thead>
<tr><td>timeseries</td><td>HLSP</td><td>141914082</td><td>1800.0</td><td>TESS</td><td>GSFC-ELEANOR-LITE</td><td>TESS</td><td>1</td><td>Photometer</td></tr>
<tr><td>timeseries</td><td>HLSP</td><td>141914082</td><td>1800.0</td><td>TESS</td><td>QLP</td><td>TESS</td><td>1</td><td>Photometer</td></tr>
<tr><td>timeseries</td><td>HLSP</td><td>141914082</td><td>120.0</td><td>TESS</td><td>TASOC</td><td>TESS</td><td>1</td><td>Photometer</td></tr>
<tr><td>timeseries</td><td>HLSP</td><td>141914082</td><td>1800.0</td><td>TESS</td><td>TASOC</td><td>TESS</td><td>1</td><td>Photometer</td></tr>
<tr><td>timeseries</td><td>HLSP</td><td>141914082</td><td>1800.0</td><td>TESS</td><td>TESS-SPOC</td><td>TESS</td><td>1</td><td>Photometer</td></tr>
<tr><td>timeseries</td><td>HLSP</td><td>141914082</td><td>1800.0</td><td>TESS</td><td>TGLC</td><td>TESS</td><td>1</td><td>Photometer</td></tr>
</table></div></div></div>
</div>
<p>This query returns two light curves. To understand the difference between the two light curves we look at the <code class="docutils literal notranslate"><span class="pre">t_exptime</span></code> column, and note the different values. These exposure times correspond to 2 minutes (short cadence) and 30 minutes (long cadence). We will explore both light curves.</p>
</section>
</section>
<section id="downloading-the-light-curves">
<h3>Downloading the light curves<a class="headerlink" href="#downloading-the-light-curves" title="Permalink to this headline">#</a></h3>
<p>For the rest of this notebook we will work with the TASOC light curves only, although we could do the same analysis on the mission light curves.</p>
<section id="querying-for-the-list-of-associated-data-products">
<h4>Querying for the list of associated data products<a class="headerlink" href="#querying-for-the-list-of-associated-data-products" title="Permalink to this headline">#</a></h4>
<p>Each observation may have one or more associated data products. In the case of the TASOC light curves, there is simply a single light curve file for each observation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tasoc_prod</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">tasoc_res</span><span class="p">)</span>
<span class="n">tasoc_prod</span><span class="p">[</span><span class="s2">&quot;dataproduct_type&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="s2">&quot;dataURI&quot;</span><span class="p">,</span> <span class="s2">&quot;size&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table length=9</i>
<table id="table140552467931168" class="table-striped table-bordered table-condensed">
<thead><tr><th>dataproduct_type</th><th>description</th><th>dataURI</th><th>size</th></tr></thead>
<thead><tr><th>str10</th><th>str4</th><th>str129</th><th>int64</th></tr></thead>
<tr><td>timeseries</td><td>FITS</td><td>mast:HLSP/gsfc-eleanor-lite/s0001/0000/0001/4191/4082/hlsp_gsfc-eleanor-lite_tess_ffi_s0001-0000000141914082_tess_v1.0_lc.fits</td><td>106560</td></tr>
<tr><td>timeseries</td><td>FITS</td><td>mast:HLSP/qlp/s0001/0000/0001/4191/4082/hlsp_qlp_tess_ffi_s0001-0000000141914082_tess_v01_llc.fits</td><td>80640</td></tr>
<tr><td>timeseries</td><td>Text</td><td>mast:HLSP/qlp/s0001/0000/0001/4191/4082/hlsp_qlp_tess_ffi_s0001-0000000141914082_tess_v01_llc.txt</td><td>57710</td></tr>
<tr><td>timeseries</td><td>FITS</td><td>mast:HLSP/tasoc/s0001/c1800/0000/0001/4191/4082/hlsp_tasoc_tess_ffi_tic00141914082-s0001-cam4-ccd2-c1800_tess_v05_cbv-lc.fits</td><td>164160</td></tr>
<tr><td>timeseries</td><td>FITS</td><td>mast:HLSP/tasoc/s0001/c1800/0000/0001/4191/4082/hlsp_tasoc_tess_ffi_tic00141914082-s0001-cam4-ccd2-c1800_tess_v05_ens-lc.fits</td><td>167040</td></tr>
<tr><td>timeseries</td><td>FITS</td><td>mast:HLSP/tasoc/s0001/c0120/0000/0001/4191/4082/hlsp_tasoc_tess_tpf_tic00141914082-s0001-cam4-ccd2-c0120_tess_v05_cbv-lc.fits</td><td>1880640</td></tr>
<tr><td>timeseries</td><td>FITS</td><td>mast:HLSP/tess-spoc/s0001/target/0000/0001/4191/4082/hlsp_tess-spoc_tess_phot_0000000141914082-s0001_tess_v1_lc.fits</td><td>164160</td></tr>
<tr><td>timeseries</td><td>FITS</td><td>mast:HLSP/tess-spoc/s0001/target/0000/0001/4191/4082/hlsp_tess-spoc_tess_phot_0000000141914082-s0001_tess_v1_tp.fits</td><td>3925440</td></tr>
<tr><td>timeseries</td><td>FITS</td><td>mast:HLSP/tglc/s0001/cam4-ccd2/0052/6627/0443/4424/hlsp_tglc_tess_ffi_gaiaid-5266270443442455040-s0001-cam4-ccd2_tess_v1_llc.fits</td><td>57600</td></tr>
</table></div></div></div>
</div>
</section>
<section id="downloading-files">
<h4>Downloading files<a class="headerlink" href="#downloading-files" title="Permalink to this headline">#</a></h4>
<p>We can choose to download some or all of the associated data files, in this case since we just have the two light curves, we will download all of the products.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tasoc_manifest</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">tasoc_prod</span><span class="p">)</span>
<span class="n">tasoc_manifest</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HLSP/gsfc-eleanor-lite/s0001/0000/0001/4191/4082/hlsp_gsfc-eleanor-lite_tess_ffi_s0001-0000000141914082_tess_v1.0_lc.fits to ./mastDownload/HLSP/hlsp_gsfc-eleanor-lite_tess_ffi_s0001-0000000141914082_tess_v1.0_lc/hlsp_gsfc-eleanor-lite_tess_ffi_s0001-0000000141914082_tess_v1.0_lc.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HLSP/qlp/s0001/0000/0001/4191/4082/hlsp_qlp_tess_ffi_s0001-0000000141914082_tess_v01_llc.fits to ./mastDownload/HLSP/hlsp_qlp_tess_ffi_s0001-0000000141914082_tess_v01_llc/hlsp_qlp_tess_ffi_s0001-0000000141914082_tess_v01_llc.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HLSP/qlp/s0001/0000/0001/4191/4082/hlsp_qlp_tess_ffi_s0001-0000000141914082_tess_v01_llc.txt to ./mastDownload/HLSP/hlsp_qlp_tess_ffi_s0001-0000000141914082_tess_v01_llc/hlsp_qlp_tess_ffi_s0001-0000000141914082_tess_v01_llc.txt ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HLSP/tasoc/s0001/c1800/0000/0001/4191/4082/hlsp_tasoc_tess_ffi_tic00141914082-s0001-cam4-ccd2-c1800_tess_v05_cbv-lc.fits to ./mastDownload/HLSP/hlsp_tasoc_tess_ffi_tic00141914082-s0001-cam4-ccd2-c1800_tess_v05/hlsp_tasoc_tess_ffi_tic00141914082-s0001-cam4-ccd2-c1800_tess_v05_cbv-lc.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HLSP/tasoc/s0001/c1800/0000/0001/4191/4082/hlsp_tasoc_tess_ffi_tic00141914082-s0001-cam4-ccd2-c1800_tess_v05_ens-lc.fits to ./mastDownload/HLSP/hlsp_tasoc_tess_ffi_tic00141914082-s0001-cam4-ccd2-c1800_tess_v05/hlsp_tasoc_tess_ffi_tic00141914082-s0001-cam4-ccd2-c1800_tess_v05_ens-lc.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HLSP/tasoc/s0001/c0120/0000/0001/4191/4082/hlsp_tasoc_tess_tpf_tic00141914082-s0001-cam4-ccd2-c0120_tess_v05_cbv-lc.fits to ./mastDownload/HLSP/hlsp_tasoc_tess_tpf_tic00141914082-s0001-cam4-ccd2-c0120_tess_v05/hlsp_tasoc_tess_tpf_tic00141914082-s0001-cam4-ccd2-c0120_tess_v05_cbv-lc.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HLSP/tess-spoc/s0001/target/0000/0001/4191/4082/hlsp_tess-spoc_tess_phot_0000000141914082-s0001_tess_v1_lc.fits to ./mastDownload/HLSP/hlsp_tess-spoc_tess_phot_0000000141914082-s0001_tess_v1_tp/hlsp_tess-spoc_tess_phot_0000000141914082-s0001_tess_v1_lc.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HLSP/tess-spoc/s0001/target/0000/0001/4191/4082/hlsp_tess-spoc_tess_phot_0000000141914082-s0001_tess_v1_tp.fits to ./mastDownload/HLSP/hlsp_tess-spoc_tess_phot_0000000141914082-s0001_tess_v1_tp/hlsp_tess-spoc_tess_phot_0000000141914082-s0001_tess_v1_tp.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HLSP/tglc/s0001/cam4-ccd2/0052/6627/0443/4424/hlsp_tglc_tess_ffi_gaiaid-5266270443442455040-s0001-cam4-ccd2_tess_v1_llc.fits to ./mastDownload/HLSP/hlsp_tglc_tess_ffi_gaiaid-5266270443442455040-s0001-cam4-ccd2_tess_v1_llc/hlsp_tglc_tess_ffi_gaiaid-5266270443442455040-s0001-cam4-ccd2_tess_v1_llc.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=9</i>
<table id="table140552467934000" class="table-striped table-bordered table-condensed">
<thead><tr><th>Local Path</th><th>Status</th><th>Message</th><th>URL</th></tr></thead>
<thead><tr><th>str172</th><th>str8</th><th>object</th><th>object</th></tr></thead>
<tr><td>./mastDownload/HLSP/hlsp_gsfc-eleanor-lite_tess_ffi_s0001-0000000141914082_tess_v1.0_lc/hlsp_gsfc-eleanor-lite_tess_ffi_s0001-0000000141914082_tess_v1.0_lc.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./mastDownload/HLSP/hlsp_qlp_tess_ffi_s0001-0000000141914082_tess_v01_llc/hlsp_qlp_tess_ffi_s0001-0000000141914082_tess_v01_llc.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./mastDownload/HLSP/hlsp_qlp_tess_ffi_s0001-0000000141914082_tess_v01_llc/hlsp_qlp_tess_ffi_s0001-0000000141914082_tess_v01_llc.txt</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./mastDownload/HLSP/hlsp_tasoc_tess_ffi_tic00141914082-s0001-cam4-ccd2-c1800_tess_v05/hlsp_tasoc_tess_ffi_tic00141914082-s0001-cam4-ccd2-c1800_tess_v05_cbv-lc.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./mastDownload/HLSP/hlsp_tasoc_tess_ffi_tic00141914082-s0001-cam4-ccd2-c1800_tess_v05/hlsp_tasoc_tess_ffi_tic00141914082-s0001-cam4-ccd2-c1800_tess_v05_ens-lc.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./mastDownload/HLSP/hlsp_tasoc_tess_tpf_tic00141914082-s0001-cam4-ccd2-c0120_tess_v05/hlsp_tasoc_tess_tpf_tic00141914082-s0001-cam4-ccd2-c0120_tess_v05_cbv-lc.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./mastDownload/HLSP/hlsp_tess-spoc_tess_phot_0000000141914082-s0001_tess_v1_tp/hlsp_tess-spoc_tess_phot_0000000141914082-s0001_tess_v1_lc.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./mastDownload/HLSP/hlsp_tess-spoc_tess_phot_0000000141914082-s0001_tess_v1_tp/hlsp_tess-spoc_tess_phot_0000000141914082-s0001_tess_v1_tp.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./mastDownload/HLSP/hlsp_tglc_tess_ffi_gaiaid-5266270443442455040-s0001-cam4-ccd2_tess_v1_llc/hlsp_tglc_tess_ffi_gaiaid-5266270443442455040-s0001-cam4-ccd2_tess_v1_llc.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
</table></div></div></div>
</div>
</section>
</section>
<section id="plotting-the-light-curves">
<h3>Plotting the light curves<a class="headerlink" href="#plotting-the-light-curves" title="Permalink to this headline">#</a></h3>
<p>We will use the <code class="docutils literal notranslate"><span class="pre">bokeh</span></code> plotting library so that we can have interactivity, and will plot both the 2 minute and 30 minute cadence data together.</p>
<p>We can tell which file corresponds to which cadence length by examining the filenames and noting that one contains <code class="docutils literal notranslate"><span class="pre">c0120</span></code> (2 minutes) and the other <code class="docutils literal notranslate"><span class="pre">c1800</span></code> (30 minutes).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Loading the short cadence light curve</span>
<span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">tasoc_manifest</span><span class="p">[</span><span class="s2">&quot;Local Path&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">short_cad_lc</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">hdu</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># Loading the long cadence light curve</span>
<span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">tasoc_manifest</span><span class="p">[</span><span class="s2">&quot;Local Path&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
<span class="n">long_cad_lc</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">hdu</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">long_cad_lc</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table length=1281</i>
<table id="table140551563263376" class="table-striped table-bordered table-condensed">
<thead><tr><th>TIME</th><th>CADENCENO</th><th>SAP_FLUX</th><th>KSPSAP_FLUX</th><th>KSPSAP_FLUX_ERR</th><th>QUALITY</th><th>ORBITID</th><th>SAP_X</th><th>SAP_Y</th><th>SAP_BKG</th><th>SAP_BKG_ERR</th><th>KSPSAP_FLUX_SML</th><th>KSPSAP_FLUX_LAG</th></tr></thead>
<thead><tr><th>float64</th><th>int32</th><th>float32</th><th>float32</th><th>float32</th><th>int32</th><th>int32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th></tr></thead>
<tr><td>1325.3239205802092</td><td>4697</td><td>0.9907516</td><td>0.99937916</td><td>0.0004727787</td><td>4096</td><td>9</td><td>833.876</td><td>1609.046</td><td>323.96</td><td>545.07</td><td>0.9994108</td><td>0.99934494</td></tr>
<tr><td>1325.3447537297802</td><td>4698</td><td>0.99065953</td><td>0.99991655</td><td>0.0004727787</td><td>4096</td><td>9</td><td>833.877</td><td>1609.046</td><td>292.76</td><td>430.71</td><td>0.99993587</td><td>0.99988496</td></tr>
<tr><td>1325.3655868809078</td><td>4699</td><td>0.9909295</td><td>1.0005782</td><td>0.0004727787</td><td>4096</td><td>9</td><td>833.877</td><td>1609.046</td><td>180.94</td><td>480.8</td><td>1.0005702</td><td>1.0005482</td></tr>
<tr><td>1325.386420033564</td><td>4700</td><td>0.9906624</td><td>1.0004753</td><td>0.0004727787</td><td>4096</td><td>9</td><td>833.877</td><td>1609.045</td><td>18.43</td><td>442.45</td><td>1.0004779</td><td>1.0004911</td></tr>
<tr><td>1325.4072531877214</td><td>4701</td><td>0.99046475</td><td>1.0002398</td><td>0.0004727787</td><td>4096</td><td>9</td><td>833.878</td><td>1609.046</td><td>28.41</td><td>461.86</td><td>1.0002539</td><td>1.0002934</td></tr>
<tr><td>1325.4280863433216</td><td>4702</td><td>0.9909264</td><td>1.0004859</td><td>0.0004727787</td><td>4096</td><td>9</td><td>833.878</td><td>1609.044</td><td>-89.99</td><td>462.61</td><td>1.0004859</td><td>1.0006546</td></tr>
<tr><td>1325.4489195003468</td><td>4703</td><td>0.99120694</td><td>1.000383</td><td>0.0004727787</td><td>4096</td><td>9</td><td>833.878</td><td>1609.044</td><td>-118.24</td><td>472.78</td><td>1.0004015</td><td>1.0002135</td></tr>
<tr><td>1325.4697526587393</td><td>4704</td><td>0.9914977</td><td>1.000145</td><td>0.0004727787</td><td>4096</td><td>9</td><td>833.879</td><td>1609.044</td><td>-307.69</td><td>311.05</td><td>1.000151</td><td>1.0001317</td></tr>
<tr><td>1325.4905858184716</td><td>4705</td><td>0.99213433</td><td>1.0001283</td><td>0.0004727787</td><td>4096</td><td>9</td><td>833.879</td><td>1609.044</td><td>-228.2</td><td>359.26</td><td>1.0001414</td><td>1.0002065</td></tr>
<tr><td>1325.5114189795172</td><td>4706</td><td>0.992497</td><td>0.9997269</td><td>0.0004727787</td><td>4096</td><td>9</td><td>833.879</td><td>1609.043</td><td>-80.02</td><td>372.23</td><td>0.99974793</td><td>0.99954337</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>1352.9695117277513</td><td>6024</td><td>1.0127677</td><td>0.9998823</td><td>0.0004727787</td><td>0</td><td>10</td><td>833.884</td><td>1609.154</td><td>200.05</td><td>784.49</td><td>0.99989283</td><td>1.0001168</td></tr>
<tr><td>1352.990344774581</td><td>6025</td><td>1.0124162</td><td>0.9999271</td><td>0.0004727787</td><td>0</td><td>10</td><td>833.884</td><td>1609.155</td><td>181.46</td><td>665.6</td><td>0.9999403</td><td>1.0000422</td></tr>
<tr><td>1353.0111778210035</td><td>6026</td><td>1.0118057</td><td>0.999762</td><td>0.0004727787</td><td>0</td><td>10</td><td>833.882</td><td>1609.153</td><td>193.32</td><td>571.46</td><td>0.9997629</td><td>0.9999271</td></tr>
<tr><td>1353.0320108670521</td><td>6027</td><td>1.011702</td><td>1.000145</td><td>0.0004727787</td><td>0</td><td>10</td><td>833.884</td><td>1609.157</td><td>258.93</td><td>701.06</td><td>1.0001379</td><td>1.0001836</td></tr>
<tr><td>1353.0528439127938</td><td>6028</td><td>1.0111037</td><td>1.0000861</td><td>0.0004727787</td><td>0</td><td>10</td><td>833.883</td><td>1609.153</td><td>226.06</td><td>637.77</td><td>1.0001204</td><td>1.0000738</td></tr>
<tr><td>1353.0736769582584</td><td>6029</td><td>1.0105393</td><td>1.0001072</td><td>0.0004727787</td><td>0</td><td>10</td><td>833.883</td><td>1609.156</td><td>267.1</td><td>719.3</td><td>1.0000957</td><td>1.0001739</td></tr>
<tr><td>1353.0945100035185</td><td>6030</td><td>1.011731</td><td>1.0019132</td><td>0.0004727787</td><td>0</td><td>10</td><td>833.883</td><td>1609.156</td><td>237.25</td><td>576.67</td><td>1.00187</td><td>1.0020751</td></tr>
<tr><td>1353.1153430486104</td><td>6031</td><td>1.0092119</td><td>1.0000905</td><td>0.0004727787</td><td>0</td><td>10</td><td>833.882</td><td>1609.156</td><td>220.36</td><td>776.46</td><td>1.0000939</td><td>1.0001388</td></tr>
<tr><td>1353.136176093613</td><td>6032</td><td>1.0085595</td><td>1.0001625</td><td>0.0004727787</td><td>4096</td><td>10</td><td>833.883</td><td>1609.156</td><td>229.04</td><td>772.09</td><td>1.0001705</td><td>1.0002179</td></tr>
<tr><td>1353.1570091385684</td><td>6033</td><td>1.0075595</td><td>0.99993503</td><td>0.0004727787</td><td>4096</td><td>10</td><td>833.882</td><td>1609.157</td><td>417.53</td><td>742.14</td><td>0.99995434</td><td>0.99971807</td></tr>
</table></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">long_cad_lc</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;TableColumns names=(&#39;TIME&#39;,&#39;CADENCENO&#39;,&#39;SAP_FLUX&#39;,&#39;KSPSAP_FLUX&#39;,&#39;KSPSAP_FLUX_ERR&#39;,&#39;QUALITY&#39;,&#39;ORBITID&#39;,&#39;SAP_X&#39;,&#39;SAP_Y&#39;,&#39;SAP_BKG&#39;,&#39;SAP_BKG_ERR&#39;,&#39;KSPSAP_FLUX_SML&#39;,&#39;KSPSAP_FLUX_LAG&#39;)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bfig</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">plot_width</span><span class="o">=</span><span class="mi">850</span><span class="p">,</span> <span class="n">plot_height</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Detrended Lightcurve (TIC</span><span class="si">{</span><span class="n">tic_id</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="c1"># Short cadence</span>
<span class="n">bfig</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">short_cad_lc</span><span class="p">[</span><span class="s2">&quot;TIME&quot;</span><span class="p">],</span> <span class="n">short_cad_lc</span><span class="p">[</span><span class="s2">&quot;RAW_FLUX&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">short_cad_lc</span><span class="p">[</span><span class="s2">&quot;RAW_FLUX&quot;</span><span class="p">]),</span> <span class="n">fill_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">bfig</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">short_cad_lc</span><span class="p">[</span><span class="s2">&quot;TIME&quot;</span><span class="p">],</span> <span class="n">short_cad_lc</span><span class="p">[</span><span class="s2">&quot;RAW_FLUX&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">short_cad_lc</span><span class="p">[</span><span class="s2">&quot;RAW_FLUX&quot;</span><span class="p">]),</span> <span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="c1"># Long cadence</span>
<span class="n">bfig</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">long_cad_lc</span><span class="p">[</span><span class="s2">&quot;TIME&quot;</span><span class="p">],</span><span class="n">long_cad_lc</span><span class="p">[</span><span class="s2">&quot;SAP_FLUX&quot;</span><span class="p">],</span> <span class="n">fill_color</span><span class="o">=</span><span class="s2">&quot;#0384f7&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">bfig</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">long_cad_lc</span><span class="p">[</span><span class="s2">&quot;TIME&quot;</span><span class="p">],</span><span class="n">long_cad_lc</span><span class="p">[</span><span class="s2">&quot;SAP_FLUX&quot;</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;#0384f7&#39;</span><span class="p">)</span>

<span class="c1"># Marking the flare (tpeak is in BJD, while the time column in the light curve is BTJD, so we must convert)</span>
<span class="n">vline</span> <span class="o">=</span> <span class="n">Span</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="p">(</span><span class="n">tpeak</span> <span class="o">-</span> <span class="mi">2457000</span><span class="p">),</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;#bf006e&#39;</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">bfig</span><span class="o">.</span><span class="n">renderers</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">vline</span><span class="p">])</span>

<span class="c1"># Labeling the axes</span>
<span class="n">bfig</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">axis_label</span> <span class="o">=</span> <span class="s2">&quot;Time (BTJD)&quot;</span>
<span class="n">bfig</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">axis_label</span> <span class="o">=</span> <span class="s2">&quot;Flux&quot;</span>

<span class="n">plotting</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">bfig</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">AttributeError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">bfig</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">plot_width</span><span class="o">=</span><span class="mi">850</span><span class="p">,</span> <span class="n">plot_height</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Detrended Lightcurve (TIC</span><span class="si">{</span><span class="n">tic_id</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="c1"># Short cadence</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">bfig</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">short_cad_lc</span><span class="p">[</span><span class="s2">&quot;TIME&quot;</span><span class="p">],</span> <span class="n">short_cad_lc</span><span class="p">[</span><span class="s2">&quot;RAW_FLUX&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">short_cad_lc</span><span class="p">[</span><span class="s2">&quot;RAW_FLUX&quot;</span><span class="p">]),</span> <span class="n">fill_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="nn">File /usr/share/miniconda/lib/python3.10/site-packages/bokeh/plotting/_figure.py:190,</span> in <span class="ni">figure.__init__</span><span class="nt">(self, *arg, **kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">188</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">kw</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="g g-Whitespace">    </span><span class="mi">189</span>     <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">190</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_raise_attribute_error_with_matches</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">names</span> <span class="o">|</span> <span class="n">opts</span><span class="o">.</span><span class="n">properties</span><span class="p">())</span>
<span class="g g-Whitespace">    </span><span class="mi">192</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">arg</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">194</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_range</span> <span class="o">=</span> <span class="n">get_range</span><span class="p">(</span><span class="n">opts</span><span class="o">.</span><span class="n">x_range</span><span class="p">)</span>

<span class="nn">File /usr/share/miniconda/lib/python3.10/site-packages/bokeh/core/has_props.py:368,</span> in <span class="ni">HasProps._raise_attribute_error_with_matches</span><span class="nt">(self, name, properties)</span>
<span class="g g-Whitespace">    </span><span class="mi">365</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">matches</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">366</span>     <span class="n">matches</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">properties</span><span class="p">),</span> <span class="s2">&quot;possible&quot;</span>
<span class="ne">--&gt; </span><span class="mi">368</span> <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unexpected attribute </span><span class="si">{</span><span class="n">name</span><span class="si">!r}</span><span class="s2"> to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2"> attributes are </span><span class="si">{</span><span class="n">nice_join</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="ne">AttributeError</span>: unexpected attribute &#39;plot_width&#39; to figure, similar attributes are outer_width, width or min_width
</pre></div>
</div>
</div>
</div>
<p>Experiment with the controls on the right to zoom in and and pan around on this light curve to look at the marked flare and other features (some sort of periodic feature maybe?)</p>
</section>
<section id="making-an-animation">
<h3>Making an animation<a class="headerlink" href="#making-an-animation" title="Permalink to this headline">#</a></h3>
<p>Looking at the above plot we can see the flare event in both the long and short cadence light curves. Since we can see it even in the 30 minute data, we should be able to make an animation of the area around the flaring star and see the flare happen.</p>
<p>We will use TESScut, the MAST cutout tool for full-frame images to cutout the area around the flaring star across the entire sector, and then make a movie that shows how it changes over time.</p>
<p>We will use the <code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code> <strong><a class="reference external" href="https://astroquery.readthedocs.io/en/latest/mast/mast.html#tesscut">Tesscut</a></strong> class to make this cutout.<br />
We will use two functions:</p>
<ul class="simple">
<li><p>Find the sky coordinate of our flare star: <code class="docutils literal notranslate"><span class="pre">Observations._resolve_object</span></code>*</p></li>
<li><p>Query for cutouts and get the result as a list of HDUList objects: <code class="docutils literal notranslate"><span class="pre">Tesscut.get_cutouts</span></code> **</p></li>
</ul>
<p>* <code class="docutils literal notranslate"><span class="pre">Observations._resolve_object</span></code> is a private (not documented) function which is being removed in favor of the public function <code class="docutils literal notranslate"><span class="pre">Observations.resolve_object</span></code> in the next Astroquery release.</p>
<p>** We must start by finding the sky coordinate of our star, however starting with the next Astroquery release, <code class="docutils literal notranslate"><span class="pre">Tesscut</span></code> functions will be able to take an object name such as a TIC ID as well.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coord</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">resolve_object</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;TIC </span><span class="si">{</span><span class="n">tic_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>**Requesting a cutout target pixel file. **</p>
<p>This query will return a list of <code class="docutils literal notranslate"><span class="pre">HDUList</span></code> objects, each of which is the cutout target pixel file (TPF) for a single sector. In this case, because we specified a single sector we know that the resulting list will only have one element and can pull it out directly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cutout_hdu</span> <span class="o">=</span> <span class="n">Tesscut</span><span class="o">.</span><span class="n">get_cutouts</span><span class="p">(</span><span class="n">coordinates</span><span class="o">=</span><span class="n">coord</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">sector</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cutout_hdu</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>A TESScut TPF has three extensions:</p>
<ul class="simple">
<li><p>No. 0 (Primary): This HDU contains meta-data related to the entire file.</p></li>
<li><p>No. 1 (Pixels): This HDU contains a binary table that holds data like cutout image arrays and times. We will extract information from here to get our set of cutout images.</p></li>
<li><p>No. 2 (Aperture): This HDU contains the image extension with data collected from the aperture. We will use this extension to get the WCS associated with out cutout.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cutout_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">cutout_hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">cutout_table</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
</div>
<p>The Pixels extension contains the cutout data table, which has a number of columns. For our puposes we care about the “TIME” column which has the observation times in BTJD, and the “FLUX” column which contains the cutout images (they  are calibrated, but not background subtracted).</p>
<section id="exploring-the-cutout-time-series">
<h4>Exploring the cutout time series<a class="headerlink" href="#exploring-the-cutout-time-series" title="Permalink to this headline">#</a></h4>
<p>We want to explore what is happening within our cutout area over the time that the flare occurs, so we will make an animated plot of the cutout frames.</p>
<p>We can’t make a movie of the whole sector (it would take too long), so we will choose only the time range around the flare.</p>
<p>Use the light curve plot to figure out what time range you want to animate, or use our selections.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_btjd</span> <span class="o">=</span> <span class="mf">1341.5</span>
<span class="n">end_btjd</span> <span class="o">=</span> <span class="mf">1342.5</span>

<span class="n">start_index</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">cutout_table</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">start_btjd</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>
<span class="n">end_index</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">cutout_table</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">end_btjd</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Frames </span><span class="si">{</span><span class="n">start_index</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">end_index</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">end_index</span><span class="o">-</span><span class="n">start_index</span><span class="si">}</span><span class="s2"> frames)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="looking-at-the-animated-cutout">
<h4>Looking at the animated cutout<a class="headerlink" href="#looking-at-the-animated-cutout" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_animation</span><span class="p">(</span><span class="n">data_array</span><span class="p">,</span> <span class="n">start_frame</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end_frame</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function that takes an array where each frame is a 2D image array and make an animated plot</span>
<span class="sd">    that runs through the frames.</span>
<span class="sd">    </span>
<span class="sd">    Note: This can take a long time to run if you have a lot of frames.    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data_array : array</span>
<span class="sd">        Array of 2D images.</span>
<span class="sd">    start_frame : int</span>
<span class="sd">        The index of the initial frame to show. Default is the first frame.</span>
<span class="sd">    end_frame : int</span>
<span class="sd">        The index of the final frame to show. Default is the last frame.</span>
<span class="sd">    vmin : float</span>
<span class="sd">        Data range min for the colormap. Defaults to data minimum value.</span>
<span class="sd">    vmax : float</span>
<span class="sd">        Data range max for the colormap. Defaults to data maximum value.</span>
<span class="sd">    delay: </span>
<span class="sd">        Delay before the next frame is shown in milliseconds.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    response : `animation.FuncAnimation`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">vmin</span><span class="p">:</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data_array</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">vmax</span><span class="p">:</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data_array</span><span class="p">)</span>
        
    <span class="k">if</span> <span class="ow">not</span> <span class="n">end_frame</span><span class="p">:</span>
        <span class="n">end_frame</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_array</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="c1"># set to the end of the array</span>
        
    <span class="n">num_frames</span> <span class="o">=</span> <span class="n">end_frame</span> <span class="o">-</span> <span class="n">start_frame</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1"># include the end frame</span>
        
    <span class="k">def</span> <span class="nf">animate</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">binarytab</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function used to update the animation&quot;&quot;&quot;</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Epoch #&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">start</span><span class="p">))</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">binarytab</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">start</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">YlGnBu_r</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">im</span><span class="p">,</span>
    
    <span class="c1"># Create initial plot.</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data_array</span><span class="p">[</span><span class="n">start_frame</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">YlGnBu_r</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>

    <span class="n">ani</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">animate</span><span class="p">,</span> <span class="n">fargs</span><span class="o">=</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">data_array</span><span class="p">,</span> <span class="n">start_frame</span><span class="p">),</span> <span class="n">frames</span><span class="o">=</span><span class="n">num_frames</span><span class="p">,</span> 
                                  <span class="n">interval</span><span class="o">=</span><span class="n">delay</span><span class="p">,</span> <span class="n">repeat_delay</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">ani</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">make_animation</span><span class="p">(</span><span class="n">cutout_table</span><span class="p">[</span><span class="s1">&#39;FLUX&#39;</span><span class="p">],</span> <span class="n">start_index</span><span class="p">,</span> <span class="n">end_index</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can see three things in this plot:</p>
<ul class="simple">
<li><p>The flare that occures in frames 740-743</p></li>
<li><p>An aberration that appears in frame 754</p></li>
<li><p>A variable star pulsing in the lower right corner</p></li>
</ul>
</section>
</section>
</section>
<hr class="docutils" />
<section id="exploring-a-variable-star">
<h2>Exploring a variable star<a class="headerlink" href="#exploring-a-variable-star" title="Permalink to this headline">#</a></h2>
<p>Now we will look more closely at the variable star we can see in the animation. We will use the TESS Input Catalog (TIC) to figure out the TESS ID of the variable star, and then using that ID pull down and explore the star’s light curve from MAST.</p>
<section id="overlaying-tic-sources">
<h3>Overlaying TIC sources<a class="headerlink" href="#overlaying-tic-sources" title="Permalink to this headline">#</a></h3>
<p>First we will use the <code class="docutils literal notranslate"><span class="pre">astroquery.mast.Catalog</span></code> class to query the TESS Input Catalog (TIC) and get a list of sources that appear in our cutout.</p>
<p>Here we do a simple cone search and the apply a magnitude limit. Play around with the magnitude limit to see how it changes the number of sources.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sources</span> <span class="o">=</span> <span class="n">Catalogs</span><span class="o">.</span><span class="n">query_object</span><span class="p">(</span><span class="n">catalog</span><span class="o">=</span><span class="s2">&quot;TIC&quot;</span><span class="p">,</span> <span class="n">objectname</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;TIC </span><span class="si">{</span><span class="n">tic_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">arcmin</span><span class="p">)</span>
<span class="n">sources</span> <span class="o">=</span> <span class="n">sources</span><span class="p">[</span><span class="n">sources</span><span class="p">[</span><span class="s2">&quot;Tmag&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">12</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of sources: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="plotting-sources-on-an-individual-cutout">
<h4>Plotting sources on an individual cutout<a class="headerlink" href="#plotting-sources-on-an-individual-cutout" title="Permalink to this headline">#</a></h4>
<p>We will get the WCS infomation associated with our cutout from the Aperture extension, and use it to make a WCS-aware plot of a single cutout image. Then we display the image and sources together, and label the sources with their row number in the catalog table.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cutout_wcs</span> <span class="o">=</span> <span class="n">WCS</span><span class="p">(</span><span class="n">cutout_hdu</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>
<span class="n">cutout_img</span> <span class="o">=</span> <span class="n">cutout_table</span><span class="p">[</span><span class="s2">&quot;FLUX&quot;</span><span class="p">][</span><span class="n">start_index</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span><span class="n">cutout_wcs</span><span class="p">})</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">)</span>
    
<span class="c1"># Setup WCS axes.</span>
<span class="n">xcoords</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ycoords</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">xcoords</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="s1">&#39;d.ddd&#39;</span><span class="p">)</span>
<span class="n">ycoords</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="s1">&#39;d.ddd&#39;</span><span class="p">)</span>
<span class="n">xcoords</span><span class="o">.</span><span class="n">set_axislabel</span><span class="p">(</span><span class="s2">&quot;RA (deg)&quot;</span><span class="p">)</span>
<span class="n">ycoords</span><span class="o">.</span><span class="n">set_axislabel</span><span class="p">(</span><span class="s2">&quot;Dec (deg)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cutout_img</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">YlGnBu_r</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">700</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">],</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">],</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="s1">&#39;icrs&#39;</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

<span class="c1"># Annotating the sources with their row nnumber in the sources table</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">star</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sources</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">star</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">]</span><span class="o">+</span><span class="mf">0.01</span><span class="p">,</span><span class="n">star</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">],</span><span class="n">i</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="s1">&#39;icrs&#39;</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">cutout_img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">cutout_img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The variable star is row 4 in the catalog sources table (note that if you changed the magnitude threshold the variale star may be in a different row).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sources</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">,</span><span class="s2">&quot;ra&quot;</span><span class="p">,</span><span class="s2">&quot;dec&quot;</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="getting-the-variable-star-light-curve">
<h3>Getting the variable star light curve<a class="headerlink" href="#getting-the-variable-star-light-curve" title="Permalink to this headline">#</a></h3>
<p>Again, we will look specifically for the TASOC light curve(s) associated with this star, rather than the mission pipeline ones. Below we go through the same process as in the <a class="reference external" href="#Downloading-the-light-curves">Downloading the light curves</a> section to search for the observation, then find the associated data products, and download them.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variable_tic_id</span> <span class="o">=</span> <span class="n">sources</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span>

<span class="n">variable_res</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">target_name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">variable_tic_id</span><span class="p">),</span> 
                                           <span class="n">obs_collection</span><span class="o">=</span><span class="s2">&quot;HLSP&quot;</span><span class="p">,</span> 
                                           <span class="n">filters</span><span class="o">=</span><span class="s2">&quot;TESS&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of tasoc light curves for </span><span class="si">{</span><span class="n">variable_tic_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">variable_res</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        
<span class="n">variable_prod</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">variable_res</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">variable_manifest</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">variable_prod</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Note that this time there is only one (30 minute cadence) TASOC light curve. This is because this star was not one od the targets that TESS observed at the shorter cadence.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">variable_manifest</span><span class="p">[</span><span class="s2">&quot;Local Path&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">variable_lc</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">hdu</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plotting-the-variable-star-light-curve">
<h3>Plotting the variable star light curve<a class="headerlink" href="#plotting-the-variable-star-light-curve" title="Permalink to this headline">#</a></h3>
<p>We will again plot the light curve using bokeh so that we have interactivity.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variable_lc</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bfig</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">plot_width</span><span class="o">=</span><span class="mi">850</span><span class="p">,</span> <span class="n">plot_height</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Detrended Lightcurve (TIC</span><span class="si">{</span><span class="n">variable_tic_id</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="n">bfig</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">variable_lc</span><span class="p">[</span><span class="s2">&quot;TIME&quot;</span><span class="p">],</span><span class="n">variable_lc</span><span class="p">[</span><span class="s2">&quot;SAP_FLUX&quot;</span><span class="p">],</span> <span class="n">fill_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">bfig</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">variable_lc</span><span class="p">[</span><span class="s2">&quot;TIME&quot;</span><span class="p">],</span><span class="n">variable_lc</span><span class="p">[</span><span class="s2">&quot;SAP_FLUX&quot;</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="c1"># Labeling the axes</span>
<span class="n">bfig</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">axis_label</span> <span class="o">=</span> <span class="s2">&quot;Time (BTJD)&quot;</span>
<span class="n">bfig</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">axis_label</span> <span class="o">=</span> <span class="s2">&quot;SAP Flux&quot;</span>

<span class="n">plotting</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">bfig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>That looks variable all right!</p>
</section>
<section id="finding-the-period">
<h3>Finding the period<a class="headerlink" href="#finding-the-period" title="Permalink to this headline">#</a></h3>
<p>We’ll run a Lomb Scargle priodogram on this light curve to see if we can quantify the periodic behavior. To do this we will use the <code class="docutils literal notranslate"><span class="pre">astropy.timeseries</span></code> class <a class="reference external" href="https://docs.astropy.org/en/stable/timeseries/lombscargle.html">LombScargle</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lomb</span> <span class="o">=</span> <span class="n">LombScargle</span><span class="p">(</span><span class="n">variable_lc</span><span class="p">[</span><span class="s2">&quot;TIME&quot;</span><span class="p">],</span> <span class="n">variable_lc</span><span class="p">[</span><span class="s2">&quot;SAP_FLUX&quot;</span><span class="p">])</span>
<span class="n">frequency</span><span class="p">,</span> <span class="n">power</span> <span class="o">=</span> <span class="n">lomb</span><span class="o">.</span><span class="n">autopower</span><span class="p">(</span><span class="n">maximum_frequency</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="plotting-the-periodogram">
<h4>Plotting the periodogram<a class="headerlink" href="#plotting-the-periodogram" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bfig</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">plot_width</span><span class="o">=</span><span class="mi">850</span><span class="p">,</span> <span class="n">plot_height</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">x_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">25</span><span class="p">),</span>
                       <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Periodogram (TIC</span><span class="si">{</span><span class="n">variable_tic_id</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="n">bfig</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">frequency</span><span class="p">,</span> <span class="n">power</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="c1"># Labeling the axes</span>
<span class="n">bfig</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">axis_label</span> <span class="o">=</span> <span class="s2">&quot;Frequency (1/day)&quot;</span>
<span class="n">bfig</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">axis_label</span> <span class="o">=</span> <span class="s2">&quot;Power&quot;</span>

<span class="n">plotting</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">bfig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="phasing-on-the-highest-power-period-frequency">
<h4>Phasing on the highest power period/frequency<a class="headerlink" href="#phasing-on-the-highest-power-period-frequency" title="Permalink to this headline">#</a></h4>
<p>There is a clear dominant frequency in the above plot, with a small harmonic also visible. We will phase the stellar light curve on the period corresponding to the dominant frequency and plot both it and the corresponding sinusoidal fit.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dominant_freq</span> <span class="o">=</span> <span class="n">frequency</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">power</span><span class="p">)]</span><span class="o">.</span><span class="n">value</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The dominant priod: </span><span class="si">{</span><span class="mi">1</span><span class="o">/</span><span class="n">dominant_freq</span><span class="o">*</span><span class="mi">24</span><span class="si">:</span><span class="s2">.3</span><span class="si">}</span><span class="s2"> hours&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bfig</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">plot_width</span><span class="o">=</span><span class="mi">850</span><span class="p">,</span> <span class="n">plot_height</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Phased Lightcurve (TIC</span><span class="si">{</span><span class="n">variable_tic_id</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="c1"># Plotting the phased light curve</span>
<span class="n">bfig</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">variable_lc</span><span class="p">[</span><span class="s2">&quot;TIME&quot;</span><span class="p">]</span><span class="o">%</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">dominant_freq</span><span class="p">),</span><span class="n">variable_lc</span><span class="p">[</span><span class="s2">&quot;SAP_FLUX&quot;</span><span class="p">],</span> <span class="n">fill_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># Plotting the periodic fit</span>
<span class="n">t_fit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="n">dominant_freq</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">bfig</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">t_fit</span><span class="p">,</span> <span class="n">lomb</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">t_fit</span><span class="p">,</span> <span class="n">dominant_freq</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#1b9f00&#39;</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Labeling the axes</span>
<span class="n">bfig</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">axis_label</span> <span class="o">=</span> <span class="s2">&quot;Phase (days)&quot;</span>
<span class="n">bfig</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">axis_label</span> <span class="o">=</span> <span class="s2">&quot;Flux&quot;</span>

<span class="n">plotting</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">bfig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="additional-resources">
<h2>Additional Resources<a class="headerlink" href="#additional-resources" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://archive.stsci.edu/tess">Main TESS page at MAST</a></p></li>
<li><p><a class="reference external" href="https://astroquery.readthedocs.io/en/latest/mast/mast.html">MAST Astroquery documentation</a></p></li>
</ul>
</section>
<section id="about-this-notebook">
<h2>About this Notebook<a class="headerlink" href="#about-this-notebook" title="Permalink to this headline">#</a></h2>
<p><strong>Author:</strong> C. E. Brasseur, STScI Software Engineer
<br><strong>Updated On:</strong> 2019-08-02</p>
<p><a class="reference external" href="#title_ID">Top of Page</a>
<a class="reference internal" href="https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png"><img alt="STScI logo" src="https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png" style="width: 200px;" /></a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks/MAST/TESS/interm_tasc_lc"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../interm_gi_query/interm_gi_query.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Intermediate:  Search and Download GI Program Light Curves</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../interm_tess_prf_retrieve/interm_tess_prf_retrieve.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Intermediate: Retrieve TESS Pixel Response Function Images</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By STScI<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>