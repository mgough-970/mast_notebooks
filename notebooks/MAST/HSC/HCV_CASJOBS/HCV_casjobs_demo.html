
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Hubble Catalog of Variables Notebook (CasJobs version) &#8212; MAST Notebook Repository</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/main.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/table.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Hubble Source Catalog API Notebook" href="../HSCV3_API/hscv3_api.html" />
    <link rel="prev" title="Hubble Catalog of Variables Notebook (API version)" href="../HCV_API/HCV_API_demo.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../../_static/mastlogo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">MAST Notebook Repository</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../../intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Astroquery
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../astroquery/beginner_search_astroquery/beginner_search_astroquery.html">
   Beginner: Searching MAST using astroquery.mast
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../astroquery/large_downloads/large_downloads.html">
   Large Downloads in
   <code class="docutils literal notranslate">
    <span class="pre">
     astroquery.mast
    </span>
   </code>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  HSC
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../HCV_API/HCV_API_demo.html">
   Hubble Catalog of Variables Notebook (API version)
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Hubble Catalog of Variables Notebook (CasJobs version)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../HSCV3_API/hscv3_api.html">
   Hubble Source Catalog API Notebook
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../HSCV3_SMC_API/hscv3_smc_api.html">
   Hubble Source Catalog API Notebook: SMC Color-Magnitude Diagram
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../HSC_TAP/HSC_TAP.html">
   MAST Table Access Protocol Hubble Source Catalog Demo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../SWEEPS_HSCV3P1/sweeps_hscv3p1.html">
   Hubble Source Catalog SWEEPS Proper Motion Notebook
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../SWEEPS_HSCV3P1_API/sweeps_hscv3p1_api.html">
   Hubble Source Catalog SWEEPS Proper Motion Notebook
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  JWST
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../JWST/download_by_program_id/download_by_program_id.html">
   Accessing JWST Proposal Data in astroquery.mast
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../JWST/Engineering_Database_Retreival/EDB_Retrieval.html">
   JWST Engineering Data Retrieval
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Kepler K2
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../K2/K2_Lightcurve/K2_Lightcurve.html">
   Beginner: Read and Plot A K2 Light Curve File
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../K2/K2_TPF/K2_TPF.html">
   Beginner: Read and Display A K2 Target Pixel File
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../K2/beginner_how_to_use_ffi/beginner_how_to_use_ffi.html">
   Beginner: Read and Display a K2 Full Frame Image
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../K2/k2_removing_instrumental_noise_using_pld/k2_removing_instrumental_noise_using_pld.html">
   Removing Instrumental Noise from
   <em>
    K2
   </em>
   and
   <em>
    TESS
   </em>
   Light Curves Using Pixel Level Decorrelation (PLD)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Kepler
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/Kepler_DVT/Kepler_DVT.html">
   Read and Plot A Kepler Data Validation Timeseries File
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/Kepler_FFI/kepler_ffi.html">
   Plotting a Catalog over a Kepler Full Frame Image File
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/Kepler_Lightcurve/kepler_lightcurve.html">
   Using Kepler Data to Plot a Light Curve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/Kepler_TPF/kepler_tpf.html">
   Plotting Images from Kepler Target Pixel Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_combining_multiple_quarters/kepler_combining_multiple_quarters.html">
   Combining Multiple Quarters of
   <em>
    Kepler
   </em>
   Data with Lightkurve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_creating_periodograms/kepler_creating_periodograms.html">
   Creating Periodograms and Identifying Significant Peaks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_creating_your_own_light_curves/kepler_creating_your_own_light_curves.html">
   Creating Your Own Light Curves using Custom Aperture Photometry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_how_to_estimate_a_stars_mass_and_radius_using_asteroseismology/kepler_how_to_estimate_a_stars_mass_and_radius_using_asteroseismology.html">
   How to Estimate a Star’s Mass and Radius Using Asteroseismology
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_how_to_understand_and_manipulate_the_periodogram_of_an_oscillating_star/kepler_how_to_understand_and_manipulate_the_periodogram_of_an_oscillating_star.html">
   How to Understand and Manipulate the Periodogram of an Oscillating Star
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_identifying_transiting_planet_signals/kepler_identifying_transiting_planet_signals.html">
   Identifying Transiting Planet Signals in a
   <em>
    Kepler
   </em>
   Light Curve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_instrumental_noise_1_data_gaps_and_quality_flags/kepler_instrumental_noise_1_data_gaps_and_quality_flags.html">
   Instrumental Noise in
   <em>
    Kepler
   </em>
   and
   <em>
    K2
   </em>
   #1: Data Gaps and Quality Flags
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_instrumental_noise_2_spurious_signals_and_time_sampling_effects/kepler_instrumental_noise_2_spurious_signals_and_time_sampling_effects.html">
   Instrumental Noise in
   <em>
    Kepler
   </em>
   and
   <em>
    K2
   </em>
   #2: Spurious Signals and Time Sampling Effects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_instrumental_noise_3_seasonal_and_detector_effects/kepler_instrumental_noise_3_seasonal_and_detector_effects.html">
   Instrumental Noise in
   <em>
    Kepler
   </em>
   and
   <em>
    K2
   </em>
   #3: Seasonal and Detector Effects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_instrumental_noise_4_electronic_noise/kepler_instrumental_noise_4_electronic_noise.html">
   Instrumental Noise in
   <em>
    Kepler
   </em>
   and
   <em>
    K2
   </em>
   #4: Electronic Noise
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_interactively_inspecting_target_pixel_files_and_light_curves/kepler_interactively_inspecting_target_pixel_files_and_light_curves.html">
   Interactively Inspecting Target Pixel Files and Light Curves
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_measuring_a_rotation_period/kepler_measuring_a_rotation_period.html">
   Measuring and Removing a Rotation Period Signal from a
   <em>
    Kepler
   </em>
   Light Curve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_plotting_target_pixel_files/kepler_plotting_target_pixel_files.html">
   Plotting
   <em>
    Kepler
   </em>
   Target Pixel File Products with Lightkurve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_searching_for_data_products/kepler_searching_for_data_products.html">
   Searching for
   <em>
    Kepler
   </em>
   /
   <em>
    K2
   </em>
   and
   <em>
    TESS
   </em>
   Data Products Using Lightkurve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_using_light_curve_products_with_lightkurve/kepler_using_light_curve_products_with_lightkurve.html">
   Using
   <em>
    Kepler
   </em>
   Light Curve Products with Lightkurve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_using_target_pixel_file_products_with_lightkurve/kepler_using_target_pixel_file_products_with_lightkurve.html">
   Using
   <em>
    Kepler
   </em>
   Target Pixel File Products with Lightkurve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_verifying_the_location_of_a_signal/kepler_verifying_the_location_of_a_signal.html">
   Verifying the Location of a Signal in
   <em>
    Kepler
   </em>
   Pixel Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Kepler/kepler_visualizing_periodic_signals_using_a_river_plot/kepler_visualizing_periodic_signals_using_a_river_plot.html">
   Visualizing Periodic Signals Using a River Plot
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  PanSTARRS
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../PanSTARRS/PS1_DR2_TAP/PS1_DR2_TAP.html">
   MAST Table Access Protocol PanSTARRS 1 DR2 Demo
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  TESS
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../TESS/beginner_astroquery_dv/beginner_astroquery_dv.html">
   Beginner: Retrieve TESS Data Validation Products with Astroquery
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../TESS/beginner_how_to_use_dvt/beginner_how_to_use_dvt.html">
   Beginner: Read and Plot A TESS Data Validation Timeseries File
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../TESS/beginner_how_to_use_ffi/beginner_how_to_use_ffi.html">
   Beginner: Read and Display a TESS Full Frame Image
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../TESS/beginner_how_to_use_lc/beginner_how_to_use_lc.html">
   Beginner: Read and Plot A TESS Light Curve File
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../TESS/beginner_how_to_use_tp/beginner_how_to_use_tp.html">
   Beginner: Read and Display A TESS Target Pixel File
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../TESS/beginner_tess_exomast/beginner_tess_exomast.html">
   Exoplanet Data and TESS Light Curves Using Python Requests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../TESS/beginner_tess_tap_search/beginner_tess_tap_search.html">
   Download MAST TESS Light Curves Within an FFI Footprint Using TAP
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../TESS/beginner_tic_search_hd209458/beginner_tic_search_hd209458.html">
   Beginner: Search The TESS Input Catalog Centered On HD 209458.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../TESS/beginner_tour_lc_tp/beginner_tour_lc_tp.html">
   Beginnner: A Tour of the Contents of the TESS 2-minute Cadence Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../TESS/interm_gi_query/interm_gi_query.html">
   Intermediate:  Search and Download GI Program Light Curves
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../TESS/interm_tasc_lc/interm_tasc_lc.html">
   Intermediate: Finding Flares and Variable Stars in TASC Light Curves
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../TESS/interm_tess_prf_retrieve/interm_tess_prf_retrieve.html">
   Intermediate: Retrieve TESS Pixel Response Function Images
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../TESS/interm_tesscut_astroquery/interm_tesscut_astroquery.html">
   Beginner: Cutout of the TESS FFIs using Astrocut and Astroquery
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../TESS/interm_tesscut_dss_overlay/interm_tesscut_dss_overlay.html">
   Intermediate: Overlay a Cutout of the TESS FFIs with DSS imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../TESS/interm_tesscut_requests/interm_tesscut_requests.html">
   Intermediate: Create TESS FFI Cutout using Python Requests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../TESS/tess_removing_scattered_light_using_regression/tess_removing_scattered_light_using_regression.html">
   Removing Scattered Light from
   <em>
    TESS
   </em>
   Data Using the Lightkurve
   <code class="docutils literal notranslate">
    <span class="pre">
     RegressionCorrector
    </span>
   </code>
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/TheRealZoidberg/mast/main?urlpath=tree/notebooks/MAST/HSC/HCV_CASJOBS/HCV_casjobs_demo.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/TheRealZoidberg/mast/blob/main/notebooks/MAST/HSC/HCV_CASJOBS/HCV_casjobs_demo.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../../../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/TheRealZoidberg/mast/"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/TheRealZoidberg/mast//issues/new?title=Issue%20on%20page%20%2Fnotebooks/MAST/HSC/HCV_CASJOBS/HCV_casjobs_demo.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../../_sources/notebooks/MAST/HSC/HCV_CASJOBS/HCV_casjobs_demo.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Hubble Catalog of Variables Notebook (CasJobs version)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rick-white-steve-lubow-trenton-mckinney">
     2019 - 2022, Rick White, Steve Lubow, Trenton McKinney
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#instructions">
   Instructions:
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#table-of-contents">
   Table of Contents
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#initialization-a-name-initialization-a">
   Initialization
   <a name="initialization">
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#install-python-modules">
     Install Python modules
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-up-your-casjobs-account-information">
     Set up your CasJobs account information
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#variable-objects-near-ic-1613-a-name-ic1613-a">
     Variable objects near IC 1613
     <a name="ic1613">
     </a>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#use-astropy-name-resolver-to-get-position-of-ic-1613-a-name-resolver-a">
       Use
       <code class="docutils literal notranslate">
        <span class="pre">
         astropy
        </span>
       </code>
       name resolver to get position of IC 1613
       <a name="resolver">
       </a>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#select-objects-near-ic-1613-with-acs-f475w-and-f814w-measurements-from-hcv-a-name-summary-a">
       Select objects near IC 1613 with ACS F475W and F814W measurements from HCV
       <a name="summary">
       </a>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#description-of-the-variable-classification-columns-a-name-classification-a">
       Description of the variable classification columns
       <a name="classification">
       </a>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#find-objects-with-measurements-in-both-f475w-and-f814w">
       Find objects with measurements in both F475W and F814W
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-object-positions-on-the-sky-a-name-positions-a">
       Plot object positions on the sky
       <a name="positions">
       </a>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-hcv-mad-variability-index-versus-magnitude-in-f475w-a-name-variability-a">
       Plot HCV MAD variability index versus magnitude in F475W
       <a name="variability">
       </a>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-variables-in-color-magnitude-diagram-a-name-cmd-a">
       Plot variables in color-magnitude diagram
       <a name="cmd">
       </a>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-a-light-curve-for-a-nova-in-m87-a-name-m87-a">
     Get a light curve for a nova in M87
     <a name="m87">
     </a>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#extract-light-curve-for-a-given-matchid-a-name-lightcurve-a">
       Extract light curve for a given MatchID
       <a name="lightcurve">
       </a>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#get-hla-image-cutouts-for-the-nova-a-name-cutouts-a">
       Get HLA image cutouts for the nova
       <a name="cutouts">
       </a>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compare-the-hcv-automatic-classification-to-expert-validations-a-name-expert-a">
     Compare the HCV automatic classification to expert validations
     <a name="expert">
     </a>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-the-mad-variability-index-distribution-with-expert-classifications-a-name-mad-expert-a">
       Plot the MAD variability index distribution with expert classifications
       <a name="mad_expert">
       </a>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#data-bins">
         Data &amp; Bins
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#plots">
         Plots
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-the-fraction-of-artifacts-as-a-function-of-mad-variability-index-a-name-artifacts-a">
       Plot the fraction of artifacts as a function of MAD variability index
       <a name="artifacts">
       </a>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-light-curve-for-the-most-variable-high-quality-candidate-in-the-hcv-a-name-most-variable-a">
       Plot light curve for the most variable high quality candidate in the HCV
       <a name="most_variable">
       </a>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Hubble Catalog of Variables Notebook (CasJobs version)</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Hubble Catalog of Variables Notebook (CasJobs version)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rick-white-steve-lubow-trenton-mckinney">
     2019 - 2022, Rick White, Steve Lubow, Trenton McKinney
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#instructions">
   Instructions:
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#table-of-contents">
   Table of Contents
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#initialization-a-name-initialization-a">
   Initialization
   <a name="initialization">
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#install-python-modules">
     Install Python modules
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-up-your-casjobs-account-information">
     Set up your CasJobs account information
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#variable-objects-near-ic-1613-a-name-ic1613-a">
     Variable objects near IC 1613
     <a name="ic1613">
     </a>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#use-astropy-name-resolver-to-get-position-of-ic-1613-a-name-resolver-a">
       Use
       <code class="docutils literal notranslate">
        <span class="pre">
         astropy
        </span>
       </code>
       name resolver to get position of IC 1613
       <a name="resolver">
       </a>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#select-objects-near-ic-1613-with-acs-f475w-and-f814w-measurements-from-hcv-a-name-summary-a">
       Select objects near IC 1613 with ACS F475W and F814W measurements from HCV
       <a name="summary">
       </a>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#description-of-the-variable-classification-columns-a-name-classification-a">
       Description of the variable classification columns
       <a name="classification">
       </a>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#find-objects-with-measurements-in-both-f475w-and-f814w">
       Find objects with measurements in both F475W and F814W
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-object-positions-on-the-sky-a-name-positions-a">
       Plot object positions on the sky
       <a name="positions">
       </a>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-hcv-mad-variability-index-versus-magnitude-in-f475w-a-name-variability-a">
       Plot HCV MAD variability index versus magnitude in F475W
       <a name="variability">
       </a>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-variables-in-color-magnitude-diagram-a-name-cmd-a">
       Plot variables in color-magnitude diagram
       <a name="cmd">
       </a>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-a-light-curve-for-a-nova-in-m87-a-name-m87-a">
     Get a light curve for a nova in M87
     <a name="m87">
     </a>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#extract-light-curve-for-a-given-matchid-a-name-lightcurve-a">
       Extract light curve for a given MatchID
       <a name="lightcurve">
       </a>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#get-hla-image-cutouts-for-the-nova-a-name-cutouts-a">
       Get HLA image cutouts for the nova
       <a name="cutouts">
       </a>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compare-the-hcv-automatic-classification-to-expert-validations-a-name-expert-a">
     Compare the HCV automatic classification to expert validations
     <a name="expert">
     </a>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-the-mad-variability-index-distribution-with-expert-classifications-a-name-mad-expert-a">
       Plot the MAD variability index distribution with expert classifications
       <a name="mad_expert">
       </a>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#data-bins">
         Data &amp; Bins
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#plots">
         Plots
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-the-fraction-of-artifacts-as-a-function-of-mad-variability-index-a-name-artifacts-a">
       Plot the fraction of artifacts as a function of MAD variability index
       <a name="artifacts">
       </a>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-light-curve-for-the-most-variable-high-quality-candidate-in-the-hcv-a-name-most-variable-a">
       Plot light curve for the most variable high quality candidate in the HCV
       <a name="most_variable">
       </a>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="hubble-catalog-of-variables-notebook-casjobs-version">
<h1>Hubble Catalog of Variables Notebook (CasJobs version)<a class="headerlink" href="#hubble-catalog-of-variables-notebook-casjobs-version" title="Permalink to this headline">#</a></h1>
<section id="rick-white-steve-lubow-trenton-mckinney">
<h2>2019 - 2022, Rick White, Steve Lubow, Trenton McKinney<a class="headerlink" href="#rick-white-steve-lubow-trenton-mckinney" title="Permalink to this headline">#</a></h2>
<p>This notebook shows how to access the <a class="reference external" href="http://archive.stsci.edu/hlsp/hcv/">Hubble Catalogs of Variables (HCV)</a>. The HCV is a large catalog of faint variable objects extracted from version 3 of the <a class="reference external" href="https://archive.stsci.edu/hst/hsc">Hubble Source Catalog</a>.  The HCV project at the National Observatory of Athens was funded by the European Space Agency (PI: Alceste Bonanos). The data products for the HCV are available both at the <a class="reference external" href="http://archives.esac.esa.int/ehst">ESA Hubble Archive</a> at <a class="reference external" href="https://www.cosmos.esa.int/web/esdc">ESAC</a> through the <a class="reference external" href="http://archives.esac.esa.int/hcv-explorer">HCV Explorer</a> interface and at STScI.
See <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2019A%26A...630A..92B/abstract">Bonanos et al. (2019)</a> for more details.</p>
<p>Data tables in <a class="reference external" href="https://mastweb.stsci.edu/hcasjobs">MAST CasJobs</a> are queried from Python using the <a class="reference external" href="https://github.com/rlwastro/mastcasjobs">mastcasjobs</a> module. For similar examples using the <a class="reference external" href="https://catalogs.mast.stsci.edu/docs/hsc.html">MAST API</a>, which is easier to use but less powerful than CasJobs, see <a class="reference internal" href="../HCV_API/HCV_API_demo.html"><span class="doc std std-doc">HCV_API_demo</span></a>.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="instructions">
<h1>Instructions:<a class="headerlink" href="#instructions" title="Permalink to this headline">#</a></h1>
<ul class="simple">
<li><p>Complete the initialization steps <a class="reference external" href="#initialization">described below</a>.</p></li>
<li><p>Run the notebook to completion.</p></li>
<li><p>Modify and rerun any sections of the Table of Contents below.</p></li>
</ul>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="table-of-contents">
<h1>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this headline">#</a></h1>
<ul class="simple">
<li><p><a class="reference external" href="#initialization">Intialization</a></p></li>
<li><p><a class="reference external" href="#ic1613">Variable objects in IC 1613</a></p>
<ul>
<li><p><a class="reference external" href="#resolver">Name resolver</a></p></li>
<li><p><a class="reference external" href="#summary">Select objects from HCV</a></p></li>
<li><p><a class="reference external" href="#classification">Information on HCV variable classification</a></p></li>
<li><p><a class="reference external" href="#positions">Sky coverage</a></p></li>
<li><p><a class="reference external" href="#variability">Properties of variable objects</a></p></li>
<li><p><a class="reference external" href="#cmd">Color magnitude diagram</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="#m87">Light curve for a nova in M87</a></p>
<ul>
<li><p><a class="reference external" href="#lightcurve">Extract and plot light curve for the nova</a></p></li>
<li><p><a class="reference external" href="#cutouts">HLA cutout images for selected measurements</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="#expert">Compare the HCV automatic classification to expert validations</a></p>
<ul>
<li><p><a class="reference external" href="#mad_expert">Plot MAD variability index distribution</a></p></li>
<li><p><a class="reference external" href="#artifacts">Plot fraction of artifacts vs. MAD</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="#most_variable">Plot light curve for most variable high-quality candidate in the HCV</a></p></li>
</ul>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="initialization-a-name-initialization-a">
<h1>Initialization <a name="initialization"></a><a class="headerlink" href="#initialization-a-name-initialization-a" title="Permalink to this headline">#</a></h1>
<section id="install-python-modules">
<h2>Install Python modules<a class="headerlink" href="#install-python-modules" title="Permalink to this headline">#</a></h2>
<ol class="simple">
<li><p><em>This notebook requires the use of <strong>Python 3</strong>.</em></p></li>
<li><p>Modules can be installed with <code class="docutils literal notranslate"><span class="pre">conda</span></code>, if using the <a class="reference external" href="http://archive.stsci.edu/hlsp/hcv/">Anaconda distribution</a> of python, or with <code class="docutils literal notranslate"><span class="pre">pip</span></code>.</p>
<ul class="simple">
<li><p>If you are using <code class="docutils literal notranslate"><span class="pre">conda</span></code>, do not install / update / remove a module with <code class="docutils literal notranslate"><span class="pre">pip</span></code>, that exists in a <code class="docutils literal notranslate"><span class="pre">conda</span></code> <a class="reference external" href="http://archive.stsci.edu/hlsp/hcv/">channel</a>.</p></li>
<li><p>If a module is not available with <code class="docutils literal notranslate"><span class="pre">conda</span></code>, then it’s okay to install it with <code class="docutils literal notranslate"><span class="pre">pip</span></code></p></li>
</ul>
</li>
<li><p>Install <code class="docutils literal notranslate"><span class="pre">mastcasjobs</span></code> and <code class="docutils literal notranslate"><span class="pre">casjobs</span></code> with <code class="docutils literal notranslate"><span class="pre">pip</span></code>:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">mastcasjobs</span>
</pre></div>
</div>
</section>
<section id="set-up-your-casjobs-account-information">
<h2>Set up your CasJobs account information<a class="headerlink" href="#set-up-your-casjobs-account-information" title="Permalink to this headline">#</a></h2>
<p>You must have a <a class="reference external" href="http://archives.esac.esa.int/ehst">MAST Casjobs</a> account. Note that MAST Casjobs accounts are independent of SDSS Casjobs accounts.</p>
<p>For easy startup, you can optionally set the environment variables <code class="docutils literal notranslate"><span class="pre">CASJOBS_USERID</span></code> and/or <code class="docutils literal notranslate"><span class="pre">CASJOBS_PW</span></code> with your Casjobs account information.  The Casjobs user ID and password are what you enter when logging into Casjobs.</p>
<p>This script prompts for your Casjobs user ID and password during initialization if the environment variables are not defined.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">astropy</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">SkyCoord</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>

<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">Table</span><span class="p">,</span> <span class="n">join</span>

<span class="c1"># check that version of mastcasjobs is new enough</span>
<span class="c1"># we are using some features not in version 0.0.1</span>
<span class="kn">from</span> <span class="nn">pkg_resources</span> <span class="kn">import</span> <span class="n">get_distribution</span>
<span class="kn">from</span> <span class="nn">packaging.version</span> <span class="kn">import</span> <span class="n">Version</span> <span class="k">as</span> <span class="n">V</span>

<span class="k">assert</span> <span class="n">V</span><span class="p">(</span><span class="n">get_distribution</span><span class="p">(</span><span class="s2">&quot;mastcasjobs&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">version</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">V</span><span class="p">(</span><span class="s1">&#39;0.0.2&#39;</span><span class="p">),</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">A newer version of mastcasjobs is required.</span>
<span class="s2">Update mastcasjobs to current version using this command:</span>
<span class="s2">pip install --upgrade git+git://github.com/rlwastro/mastcasjobs@master</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">mastcasjobs</span>

<span class="c1"># set width for pprint</span>
<span class="n">astropy</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">max_width</span> <span class="o">=</span> <span class="mi">150</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set universal matplotlib parameters</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HSCContext</span> <span class="o">=</span> <span class="s2">&quot;HSCv3&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>Set up Casjobs environment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">getpass</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CASJOBS_USERID&#39;</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CASJOBS_USERID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Enter Casjobs UserID:&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CASJOBS_PW&#39;</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CASJOBS_PW&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getpass</span><span class="p">(</span><span class="s1">&#39;Enter Casjobs password:&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">StdinNotImplementedError</span><span class="g g-Whitespace">                  </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">getpass</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CASJOBS_USERID&#39;</span><span class="p">):</span>
<span class="ne">----&gt; </span><span class="mi">3</span>     <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CASJOBS_USERID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Enter Casjobs UserID:&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CASJOBS_PW&#39;</span><span class="p">):</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>     <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CASJOBS_PW&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getpass</span><span class="p">(</span><span class="s1">&#39;Enter Casjobs password:&#39;</span><span class="p">)</span>

<span class="nn">File /usr/share/miniconda/lib/python3.10/site-packages/ipykernel/kernelbase.py:1186,</span> in <span class="ni">Kernel.raw_input</span><span class="nt">(self, prompt)</span>
<span class="g g-Whitespace">   </span><span class="mi">1184</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allow_stdin</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1185</span>     <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;raw_input was called, but this frontend does not support input requests.&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1186</span>     <span class="k">raise</span> <span class="n">StdinNotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1187</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_request</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1188</span>     <span class="nb">str</span><span class="p">(</span><span class="n">prompt</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1189</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_parent_ident</span><span class="p">[</span><span class="s2">&quot;shell&quot;</span><span class="p">],</span>
<span class="g g-Whitespace">   </span><span class="mi">1190</span>     <span class="bp">self</span><span class="o">.</span><span class="n">get_parent</span><span class="p">(</span><span class="s2">&quot;shell&quot;</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1191</span>     <span class="n">password</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1192</span> <span class="p">)</span>

<span class="ne">StdinNotImplementedError</span>: raw_input was called, but this frontend does not support input requests.
</pre></div>
</div>
</div>
</div>
</section>
<section id="variable-objects-near-ic-1613-a-name-ic1613-a">
<h2>Variable objects near IC 1613 <a name="ic1613"></a><a class="headerlink" href="#variable-objects-near-ic-1613-a-name-ic1613-a" title="Permalink to this headline">#</a></h2>
<section id="use-astropy-name-resolver-to-get-position-of-ic-1613-a-name-resolver-a">
<h3>Use <code class="docutils literal notranslate"><span class="pre">astropy</span></code> name resolver to get position of IC 1613 <a name="resolver"></a><a class="headerlink" href="#use-astropy-name-resolver-to-get-position-of-ic-1613-a-name-resolver-a" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target</span> <span class="o">=</span> <span class="s1">&#39;IC 1613&#39;</span>
<span class="n">coord_ic1613</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="o">.</span><span class="n">from_name</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>

<span class="n">ra_ic1613</span> <span class="o">=</span> <span class="n">coord_ic1613</span><span class="o">.</span><span class="n">ra</span><span class="o">.</span><span class="n">degree</span>
<span class="n">dec_ic1613</span> <span class="o">=</span> <span class="n">coord_ic1613</span><span class="o">.</span><span class="n">dec</span><span class="o">.</span><span class="n">degree</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ra: </span><span class="si">{</span><span class="n">ra_ic1613</span><span class="si">}</span><span class="se">\n</span><span class="s1">dec: </span><span class="si">{</span><span class="n">dec_ic1613</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ra: 16.22583
dec: 2.13333
</pre></div>
</div>
</div>
</div>
</section>
<section id="select-objects-near-ic-1613-with-acs-f475w-and-f814w-measurements-from-hcv-a-name-summary-a">
<h3>Select objects near IC 1613 with ACS F475W and F814W measurements from HCV <a name="summary"></a><a class="headerlink" href="#select-objects-near-ic-1613-with-acs-f475w-and-f814w-measurements-from-hcv-a-name-summary-a" title="Permalink to this headline">#</a></h3>
<p>This searches the HCV summary table for objects within 0.5 degrees of the galaxy center.  Note that this returns both variable and non-variable objects.  We restrict the sample to objects with measurements in the two filters of interest.  This uses the <code class="docutils literal notranslate"><span class="pre">SearchHCVMatchID</span></code> function to do the cone search.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DBtable</span> <span class="o">=</span> <span class="s2">&quot;HCV_demo&quot;</span>
<span class="n">jobs</span> <span class="o">=</span> <span class="n">mastcasjobs</span><span class="o">.</span><span class="n">MastCasJobs</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="s2">&quot;MyDB&quot;</span><span class="p">)</span>

<span class="c1"># drop table if it already exists</span>
<span class="n">jobs</span><span class="o">.</span><span class="n">drop_table_if_exists</span><span class="p">(</span><span class="n">DBtable</span><span class="p">)</span>

<span class="c1"># get main information</span>
<span class="n">radius</span> <span class="o">=</span> <span class="mf">1800.0</span> <span class="c1"># arcsec</span>
<span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">select m.MatchID, m.GroupID, m.SubGroupID, m.RA, m.Dec,</span>
<span class="s2">   m.AutoClass, m.ExpertClass, m.NumFilters,</span>
<span class="s2">   f.Filter, f.FilterDetFlag, f.VarQualFlag, f.NumLC, </span>
<span class="s2">   f.MeanMag, f.MeanCorrMag, f.MAD, f.Chi2</span>
<span class="s2">into mydb.</span><span class="si">{</span><span class="n">DBtable</span><span class="si">}</span>
<span class="s2">from SearchHCVMatchID(</span><span class="si">{</span><span class="n">ra_ic1613</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">dec_ic1613</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">radius</span><span class="si">}</span><span class="s2">) s</span>
<span class="s2">join HCVmatch m on m.MatchID=s.MatchID</span>
<span class="s2">join HCVfilter f on f.MatchID=s.MatchID and (f.Filter=&#39;ACS_F475W&#39; or f.Filter=&#39;ACS_F814W&#39;)</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">jobs</span><span class="o">.</span><span class="n">quick</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;HCV demo&quot;</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">HSCContext</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Completed in </span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> sec&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

<span class="c1"># fast retrieval using special MAST Casjobs service</span>
<span class="n">tab</span> <span class="o">=</span> <span class="n">jobs</span><span class="o">.</span><span class="n">fast_table</span><span class="p">(</span><span class="n">DBtable</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># clean up the output format</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MeanMag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MeanCorrMag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MAD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Chi2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;RA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.6f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Dec&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.6f}</span><span class="s2">&quot;</span>

<span class="c1"># show some of the variable sources</span>
<span class="n">tab</span><span class="p">[</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;AutoClass&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="nn">Input In [6],</span> in <span class="ni">&lt;cell line: 2&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">DBtable</span> <span class="o">=</span> <span class="s2">&quot;HCV_demo&quot;</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">jobs</span> <span class="o">=</span> <span class="n">mastcasjobs</span><span class="o">.</span><span class="n">MastCasJobs</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="s2">&quot;MyDB&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="c1"># drop table if it already exists</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">jobs</span><span class="o">.</span><span class="n">drop_table_if_exists</span><span class="p">(</span><span class="n">DBtable</span><span class="p">)</span>

<span class="nn">File ~/opt/miniconda3/envs/py3810/lib/python3.8/site-packages/mastcasjobs/__init__.py:96,</span> in <span class="ni">MastCasJobs.__init__</span><span class="nt">(self, username, password, userid, request_type, context, base_url, wsid_url, fast_url)</span>
<span class="g g-Whitespace">     </span><span class="mi">94</span> <span class="bp">self</span><span class="o">.</span><span class="n">fast_url</span> <span class="o">=</span> <span class="n">fast_url</span>
<span class="g g-Whitespace">     </span><span class="mi">95</span> <span class="k">if</span> <span class="n">username</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">96</span>     <span class="n">userid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_wsid</span><span class="p">()</span>
<span class="g g-Whitespace">     </span><span class="mi">98</span> <span class="nb">super</span><span class="p">(</span><span class="n">MastCasJobs</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">userid</span><span class="o">=</span><span class="n">userid</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">99</span>         <span class="n">base_url</span><span class="o">=</span><span class="n">base_url</span><span class="p">,</span> <span class="n">request_type</span><span class="o">=</span><span class="n">request_type</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>

<span class="nn">File ~/opt/miniconda3/envs/py3810/lib/python3.8/site-packages/mastcasjobs/__init__.py:176,</span> in <span class="ni">MastCasJobs.get_wsid</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">174</span> <span class="n">root</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">175</span> <span class="k">if</span> <span class="n">root</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="ow">or</span> <span class="n">root</span><span class="o">.</span><span class="n">text</span> <span class="o">==</span> <span class="s2">&quot;-1&quot;</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">176</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Incorrect MAST CasJobs username/password&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">177</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">178</span>     <span class="k">return</span> <span class="n">root</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

<span class="ne">ValueError</span>: Incorrect MAST CasJobs username/password
</pre></div>
</div>
</div>
</div>
</section>
<section id="description-of-the-variable-classification-columns-a-name-classification-a">
<h3>Description of the variable classification columns <a name="classification"></a><a class="headerlink" href="#description-of-the-variable-classification-columns-a-name-classification-a" title="Permalink to this headline">#</a></h3>
<p>Several of the table columns have information on the variability.</p>
<ul class="simple">
<li><p>The columns <code class="docutils literal notranslate"><span class="pre">AutoClass</span></code> and <code class="docutils literal notranslate"><span class="pre">ExpertClass</span></code> have summary information on the variability for a given <code class="docutils literal notranslate"><span class="pre">MatchID</span></code> object.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">AutoClass</span></code>: Classification as provided by the system: 0=constant 1=single filter variable candidate (SFVC) 2=multi-filter variable candidate (MFVC)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ExpertClass</span></code>: Classification as provided by expert: 0=not classified by expert, 1=high confidence variable, 2=probable variable, 4=possible artifact</p></li>
</ul>
</li>
<li><p>The columns <code class="docutils literal notranslate"><span class="pre">MAD</span></code> and <code class="docutils literal notranslate"><span class="pre">Chi2</span></code> are variability indices using the median absolute deviation and the $\chi^2$ parameter for the given filter.</p></li>
<li><p>The column <code class="docutils literal notranslate"><span class="pre">VarQualFlag</span></code> is a variability quality flag (see Section 5 of the paper). The five letters correspond to CI, D, MagerrAper2, MagAper2-MagAuto, p2p; AAAAA corresponds to the highest quality flag.</p></li>
<li><p>The column <code class="docutils literal notranslate"><span class="pre">FilterDetFlag</span></code> is the filter detection flag: 1=source is variable in this filter, 0=source is not variable in this filter.</p></li>
</ul>
<p>See the HCV paper by <a class="reference external" href="https://www.aanda.org/component/article?access=doi&amp;doi=10.1051/0004-6361/201936026">Bonanos et al. (2019, AAp)</a> for more details on the computation and meaning of these quantities.</p>
</section>
<section id="find-objects-with-measurements-in-both-f475w-and-f814w">
<h3>Find objects with measurements in both F475W and F814W<a class="headerlink" href="#find-objects-with-measurements-in-both-f475w-and-f814w" title="Permalink to this headline">#</a></h3>
<p>This could also be done in the SQL query.  Here we use the <code class="docutils literal notranslate"><span class="pre">Astropy.table.join</span></code> function instead.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># the only key needed to do the join is MatchID, but we include other common columns</span>
<span class="c1"># so that join includes only one copy of them</span>
<span class="n">jtab</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Filter&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ACS_F475W&#39;</span><span class="p">],</span> <span class="n">tab</span><span class="p">[</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Filter&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ACS_F814W&#39;</span><span class="p">],</span>
            <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MatchID&#39;</span><span class="p">,</span> <span class="s1">&#39;GroupID&#39;</span><span class="p">,</span> <span class="s1">&#39;SubGroupID&#39;</span><span class="p">,</span> <span class="s1">&#39;RA&#39;</span><span class="p">,</span> <span class="s1">&#39;Dec&#39;</span><span class="p">,</span> <span class="s1">&#39;AutoClass&#39;</span><span class="p">,</span> <span class="s1">&#39;ExpertClass&#39;</span><span class="p">],</span>
            <span class="n">table_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;f475&#39;</span><span class="p">,</span> <span class="s1">&#39;f814&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">jtab</span><span class="p">),</span> <span class="s2">&quot;matched F475W+F814W objects&quot;</span><span class="p">)</span>
<span class="n">jtab</span><span class="p">[</span><span class="n">jtab</span><span class="p">[</span><span class="s1">&#39;AutoClass&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-object-positions-on-the-sky-a-name-positions-a">
<h3>Plot object positions on the sky <a name="positions"></a><a class="headerlink" href="#plot-object-positions-on-the-sky-a-name-positions-a" title="Permalink to this headline">#</a></h3>
<p>We mark the galaxy center as well.  Note that this field is in the outskirts of IC 1613.  The 0.5 degree search radius (which is the maximum allowed in the API) allows finding these objects.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;RA&#39;</span><span class="p">,</span> <span class="s1">&#39;Dec&#39;</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tab</span><span class="p">)</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="s1"> HCV measurements&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">jtab</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ra_ic1613</span><span class="p">,</span> <span class="n">dec_ic1613</span><span class="p">,</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">target</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;RA [deg]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Dec [deg]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-hcv-mad-variability-index-versus-magnitude-in-f475w-a-name-variability-a">
<h3>Plot HCV MAD variability index versus magnitude in F475W <a name="variability"></a><a class="headerlink" href="#plot-hcv-mad-variability-index-versus-magnitude-in-f475w-a-name-variability-a" title="Permalink to this headline">#</a></h3>
<p>The median absolute deviation variability index is used by the HCV to identify variables.  It measures the scatter among the multi-epoch measurements.  Some scatter is expected from noise (which increases for fainter objects).   Objects with MAD values that are high are likely to be variable.</p>
<p>This plots single-filter and multi-filter variable candidates (SFVC and MFVC) in different colors.  Note that variable objects with low F475W MAD values are variable in a different filter (typically F814W in this field).</p>
<p>This plot is similar to the upper panel of Figure 4 in <a class="reference external" href="https://www.aanda.org/component/article?access=doi&amp;doi=10.1051/0004-6361/201936026">Bonanos et al. (2019, AAp)</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define plot parameter lists</span>
<span class="n">auto_class</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">jtab</span><span class="p">[</span><span class="s1">&#39;AutoClass&#39;</span><span class="p">])</span>
<span class="n">markers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;silver&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;tab:cyan&#39;</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;non-&#39;</span><span class="p">,</span> <span class="s1">&#39;single-filter &#39;</span><span class="p">,</span> <span class="s1">&#39;multi-filter &#39;</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">ac</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">auto_class</span><span class="p">,</span> <span class="n">markers</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">jtab</span><span class="p">[</span><span class="n">jtab</span><span class="p">[</span><span class="s1">&#39;AutoClass&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">ac</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;MeanCorrMag_f475&#39;</span><span class="p">,</span> <span class="s1">&#39;MAD_f475&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">variable candidates&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;ACS_F475W [mag]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;ACS_F475W MAD [mag]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">jtab</span><span class="p">)</span><span class="si">}</span><span class="s1"> HSC measurements near </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-variables-in-color-magnitude-diagram-a-name-cmd-a">
<h3>Plot variables in color-magnitude diagram <a name="cmd"></a><a class="headerlink" href="#plot-variables-in-color-magnitude-diagram-a-name-cmd-a" title="Permalink to this headline">#</a></h3>
<p>Many of the candidate variables lie on the instability strip.</p>
<p>This plot is similar to the lower panel of Figure 4 in <a class="reference external" href="https://www.aanda.org/component/article?access=doi&amp;doi=10.1051/0004-6361/201936026">Bonanos et al. (2019, AAp)</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># add a new column to jtab</span>
<span class="n">jtab</span><span class="p">[</span><span class="s1">&#39;MCMf475-MCMf814&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">jtab</span><span class="p">[</span><span class="s1">&#39;MeanCorrMag_f475&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">jtab</span><span class="p">[</span><span class="s1">&#39;MeanCorrMag_f814&#39;</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="c1"># uses same plot parameters defined in the previous plot</span>
<span class="k">for</span> <span class="n">ac</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">auto_class</span><span class="p">,</span> <span class="n">markers</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">jtab</span><span class="p">[</span><span class="n">jtab</span><span class="p">[</span><span class="s1">&#39;AutoClass&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">ac</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;MCMf475-MCMf814&#39;</span><span class="p">,</span> <span class="s1">&#39;MeanCorrMag_f475&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">variable candidates&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
    
<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;ACS F475W - F814W [mag]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;ACS F475W [mag]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">jtab</span><span class="p">)</span><span class="si">}</span><span class="s1"> HSC measurements near </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="get-a-light-curve-for-a-nova-in-m87-a-name-m87-a">
<h2>Get a light curve for a nova in M87 <a name="m87"></a><a class="headerlink" href="#get-a-light-curve-for-a-nova-in-m87-a-name-m87-a" title="Permalink to this headline">#</a></h2>
<section id="extract-light-curve-for-a-given-matchid-a-name-lightcurve-a">
<h3>Extract light curve for a given MatchID <a name="lightcurve"></a><a class="headerlink" href="#extract-light-curve-for-a-given-matchid-a-name-lightcurve-a" title="Permalink to this headline">#</a></h3>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">MatchID</span></code> could be determined by positional searches, filtering the catalog, etc.  This object comes from the top left panel of Figure 9 in <a class="reference external" href="https://www.aanda.org/component/article?access=doi&amp;doi=10.1051/0004-6361/201936026">Bonanos et al. (2019, AAp)</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">matchid</span> <span class="o">=</span> <span class="mi">1905457</span>

<span class="n">jobs</span> <span class="o">=</span> <span class="n">mastcasjobs</span><span class="o">.</span><span class="n">MastCasJobs</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">HSCContext</span><span class="p">)</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># get light curves for F606W and F814W</span>
<span class="n">nova_606</span> <span class="o">=</span> <span class="n">jobs</span><span class="o">.</span><span class="n">quick</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;select * from HCVdetailed</span>
<span class="s2">where MatchID=</span><span class="si">{</span><span class="n">matchid</span><span class="si">}</span><span class="s2"> and Filter=&#39;ACS_F606W&#39;&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;HCV demo&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> sec: retrieved </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">nova_606</span><span class="p">)</span><span class="si">}</span><span class="s2"> F606W measurements&quot;</span><span class="p">)</span>

<span class="n">nova_814</span> <span class="o">=</span> <span class="n">jobs</span><span class="o">.</span><span class="n">quick</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;select * from HCVdetailed</span>
<span class="s2">where MatchID=</span><span class="si">{}</span><span class="s2"> and Filter=&#39;ACS_F814W&#39;</span>
<span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">matchid</span><span class="p">),</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;HCV demo&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> sec: retrieved </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">nova_814</span><span class="p">)</span><span class="si">}</span><span class="s2"> F814W measurements&quot;</span><span class="p">)</span>

<span class="c1"># get the object RA and Dec as well</span>
<span class="n">nova_tab</span> <span class="o">=</span> <span class="n">jobs</span><span class="o">.</span><span class="n">quick</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;select MatchID, RA, Dec from HCVmatch</span>
<span class="s2">where MatchID=</span><span class="si">{</span><span class="n">matchid</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;HCV demo&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> sec: retrieved object info&quot;</span><span class="p">)</span>

<span class="n">nova_606</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;MJD&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;CorrMag&#39;</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="s1">&#39;MagErr&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;ob&#39;</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ACS F606W&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">nova_606</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;MJD&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;CorrMag&#39;</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="s1">&#39;MagErr&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;or&#39;</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ACS F814W&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">nova_814</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;MJD [days]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;magnitude&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Nova in M87 (MatchID: </span><span class="si">{</span><span class="n">matchid</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="get-hla-image-cutouts-for-the-nova-a-name-cutouts-a">
<h3>Get HLA image cutouts for the nova <a name="cutouts"></a><a class="headerlink" href="#get-hla-image-cutouts-for-the-nova-a-name-cutouts-a" title="Permalink to this headline">#</a></h3>
<p>The <a class="reference external" href="https://hla.stsci.edu">Hubble Legacy Archive (HLA)</a> images were the source of the measurements in the HSC and HCV, and it can be useful to look at the images.  Examination of the images can be useful to identified cosmic-ray contamination and other possible image artifacts.  In this case, no issues are seen, so the light curve is reliable.</p>
<p>Note that the ACS F606W images of M87 have only a single exposure, so they do have cosmic ray contamination.  The accompanying F814W images have multiple exposures, allowing CRs to be removed.  In this case the F814W combined image is used to find objects, while the F606W exposure is used only for photometry.  That reduces the effects of F606W CRs on the catalog but it is still a good idea to confirm the quality of the images.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">get_hla_cutout</span></code> function reads a single cutout image (as a JPEG grayscale image) and returns a PIL image object.  See the documentation on the <a class="reference external" href="http://hla.stsci.edu/fitscutcgi_interface.html">fitscut image cutout service</a> for more information on the web service being used.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_hla_cutout</span><span class="p">(</span><span class="n">imagename</span><span class="p">,</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">33</span><span class="p">,</span> <span class="n">autoscale</span><span class="o">=</span><span class="mf">99.5</span><span class="p">,</span> <span class="n">asinh</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get JPEG cutout for an image&quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://hla.stsci.edu/cgi-bin/fitscut.cgi&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="o">=</span><span class="n">dec</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;jpeg&quot;</span><span class="p">,</span>
                                      <span class="n">red</span><span class="o">=</span><span class="n">imagename</span><span class="p">,</span> <span class="n">autoscale</span><span class="o">=</span><span class="n">autoscale</span><span class="p">,</span> <span class="n">asinh</span><span class="o">=</span><span class="n">asinh</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="n">zoom</span><span class="p">))</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">im</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sort images by magnitude from brightest to faintest</span>
<span class="n">phot</span> <span class="o">=</span> <span class="n">nova_606</span>
<span class="n">isort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">phot</span><span class="p">[</span><span class="s1">&#39;CorrMag&#39;</span><span class="p">])</span>
<span class="c1"># select the brightest, median and faintest magnitudes</span>
<span class="n">ind</span> <span class="o">=</span> <span class="p">[</span><span class="n">isort</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">isort</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">isort</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span> <span class="n">isort</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>

<span class="c1"># we plot zoomed-in and zoomed-out views side-by-side for each selected image</span>
<span class="n">nim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># images per row</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="p">(</span><span class="n">nim</span><span class="o">+</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="n">ncols</span>

<span class="n">imsize1</span> <span class="o">=</span> <span class="mi">19</span>
<span class="n">imsize2</span> <span class="o">=</span> <span class="mi">101</span>
<span class="n">mra</span> <span class="o">=</span> <span class="n">nova_tab</span><span class="p">[</span><span class="s1">&#39;RA&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">mdec</span> <span class="o">=</span> <span class="n">nova_tab</span><span class="p">[</span><span class="s1">&#39;Dec&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># define figure and axes</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="o">/</span><span class="n">ncols</span><span class="p">)</span><span class="o">*</span><span class="n">nrows</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># iterate through each set of two subplots in axes</span>
<span class="k">for</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">),</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">ind</span><span class="p">):</span>
    
    <span class="c1"># get the images</span>
    <span class="n">im1</span> <span class="o">=</span> <span class="n">get_hla_cutout</span><span class="p">(</span><span class="n">phot</span><span class="p">[</span><span class="s1">&#39;ImageName&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">mra</span><span class="p">,</span> <span class="n">mdec</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">imsize1</span><span class="p">)</span>
    <span class="n">im2</span> <span class="o">=</span> <span class="n">get_hla_cutout</span><span class="p">(</span><span class="n">phot</span><span class="p">[</span><span class="s1">&#39;ImageName&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">mra</span><span class="p">,</span> <span class="n">mdec</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">imsize2</span><span class="p">)</span>
    
    <span class="c1"># plot left column   </span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im1</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">phot</span><span class="p">[</span><span class="s1">&#39;ImageName&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2"> m=</span><span class="si">{</span><span class="n">phot</span><span class="p">[</span><span class="s1">&#39;CorrMag&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    
    <span class="c1"># plot right column</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im2</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">xbox</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">imsize1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">imsize2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xbox</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">xbox</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">phot</span><span class="p">[</span><span class="s1">&#39;ImageName&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2"> m=</span><span class="si">{</span><span class="n">phot</span><span class="p">[</span><span class="s1">&#39;CorrMag&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>    
    
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> s: got </span><span class="si">{</span><span class="n">nrows</span><span class="o">*</span><span class="n">ncols</span><span class="si">}</span><span class="s2"> cutouts&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="compare-the-hcv-automatic-classification-to-expert-validations-a-name-expert-a">
<h2>Compare the HCV automatic classification to expert validations <a name="expert"></a><a class="headerlink" href="#compare-the-hcv-automatic-classification-to-expert-validations-a-name-expert-a" title="Permalink to this headline">#</a></h2>
<p>The HCV includes an automatic classification <code class="docutils literal notranslate"><span class="pre">AutoClass</span></code> for candidate variables as well as an expert validation for some fields that were selected for visual examination.  See the <a class="reference external" href="#classification">description of the classification columns</a> and the HCV paper by <a class="reference external" href="https://www.aanda.org/component/article?access=doi&amp;doi=10.1051/0004-6361/201936026">Bonanos et al. (2019, AAp)</a> for more details on the computation and meaning of these quantities.</p>
<p>For this example, we select all the objects in the HCV that have expert classification information.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DBtable</span> <span class="o">=</span> <span class="s2">&quot;HCV_demo2&quot;</span>
<span class="n">jobs</span> <span class="o">=</span> <span class="n">mastcasjobs</span><span class="o">.</span><span class="n">MastCasJobs</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="s2">&quot;MyDB&quot;</span><span class="p">)</span>

<span class="c1"># drop table if it already exists</span>
<span class="n">jobs</span><span class="o">.</span><span class="n">drop_table_if_exists</span><span class="p">(</span><span class="n">DBtable</span><span class="p">)</span>

<span class="c1"># get data for objects with an expert validation</span>
<span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">select m.MatchID, m.GroupID, m.SubGroupID, m.RA, m.Dec,</span>
<span class="s2">   m.AutoClass, m.ExpertClass, m.NumFilters,</span>
<span class="s2">   f.Filter, f.FilterDetFlag, f.VarQualFlag, f.NumLC, </span>
<span class="s2">   f.MeanMag, f.MeanCorrMag, f.MAD, f.Chi2</span>
<span class="s2">into mydb.</span><span class="si">{</span><span class="n">DBtable</span><span class="si">}</span>
<span class="s2">from HCVmatch m</span>
<span class="s2">join HCVfilter f on m.MatchID=f.MatchID</span>
<span class="s2">where m.ExpertClass&gt;0</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">jobs</span><span class="o">.</span><span class="n">quick</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;HCV demo&quot;</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">HSCContext</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Completed in </span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> sec&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

<span class="c1"># fast retrieval using special MAST Casjobs service</span>
<span class="n">tab</span> <span class="o">=</span> <span class="n">jobs</span><span class="o">.</span><span class="n">fast_table</span><span class="p">(</span><span class="n">DBtable</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># clean up the output format</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MeanMag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MeanCorrMag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MAD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Chi2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;RA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.6f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Dec&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.6f}</span><span class="s2">&quot;</span>

<span class="c1"># tab includes 1 row for each filter (so multiple rows for objects with multiple filters)</span>
<span class="c1"># get an array that has only one row per object</span>
<span class="n">mval</span><span class="p">,</span> <span class="n">uindex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MatchID&#39;</span><span class="p">],</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">utab</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="n">uindex</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">utab</span><span class="p">)</span><span class="si">}</span><span class="s2"> unique MatchIDs in table&quot;</span><span class="p">)</span>

<span class="n">tab</span>
</pre></div>
</div>
</div>
</div>
<p>An <code class="docutils literal notranslate"><span class="pre">ExpertClass</span></code> value of 1 indicates that the object is confidently confirmed to be a variable; 2 means that the measurements do not have apparent problems and so the object is likely to be variable (usually the variability is too small to be obvious in the image); 4 means that the variability is likely to be the result of artifacts in the image (e.g., residual cosmic rays or diffraction spikes from nearby bright stars).</p>
<p>Compare the distributions for single-filter variable candidates (SFVC, <code class="docutils literal notranslate"><span class="pre">AutoClass</span></code>=1) and multi-filter variable candidates (MFVC, <code class="docutils literal notranslate"><span class="pre">AutoClass</span></code>=2).  The fraction of artifacts is lower in the MFVC sample.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sfcount</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">utab</span><span class="p">[</span><span class="s1">&#39;ExpertClass&#39;</span><span class="p">][</span><span class="n">utab</span><span class="p">[</span><span class="s1">&#39;AutoClass&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">mfcount</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">utab</span><span class="p">[</span><span class="s1">&#39;ExpertClass&#39;</span><span class="p">][</span><span class="n">utab</span><span class="p">[</span><span class="s1">&#39;AutoClass&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">sfrat</span> <span class="o">=</span> <span class="n">sfcount</span><span class="o">/</span><span class="n">sfcount</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">mfrat</span> <span class="o">=</span> <span class="n">mfcount</span><span class="o">/</span><span class="n">mfcount</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Type Variable Likely Artifact Total&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SFVC </span><span class="si">{:8d}</span><span class="s2"> </span><span class="si">{:6d}</span><span class="s2"> </span><span class="si">{:8d}</span><span class="s2"> </span><span class="si">{:5d}</span><span class="s2"> counts&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sfcount</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sfcount</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">sfcount</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">sfcount</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MFVC </span><span class="si">{:8d}</span><span class="s2"> </span><span class="si">{:6d}</span><span class="s2"> </span><span class="si">{:8d}</span><span class="s2"> </span><span class="si">{:5d}</span><span class="s2"> counts&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mfcount</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">mfcount</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">mfcount</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">mfcount</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SFVC </span><span class="si">{:8.3f}</span><span class="s2"> </span><span class="si">{:6.3f}</span><span class="s2"> </span><span class="si">{:8.3f}</span><span class="s2"> </span><span class="si">{:5.3f}</span><span class="s2"> fraction&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sfrat</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sfrat</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">sfrat</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">sfrat</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MFVC </span><span class="si">{:8.3f}</span><span class="s2"> </span><span class="si">{:6.3f}</span><span class="s2"> </span><span class="si">{:8.3f}</span><span class="s2"> </span><span class="si">{:5.3f}</span><span class="s2"> fraction&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mfrat</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">mfrat</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">mfrat</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">mfrat</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
</pre></div>
</div>
</div>
</div>
<section id="plot-the-mad-variability-index-distribution-with-expert-classifications-a-name-mad-expert-a">
<h3>Plot the MAD variability index distribution with expert classifications <a name="mad_expert"></a><a class="headerlink" href="#plot-the-mad-variability-index-distribution-with-expert-classifications-a-name-mad-expert-a" title="Permalink to this headline">#</a></h3>
<p>Note that only the filters identified as variable (<code class="docutils literal notranslate"><span class="pre">FilterDetFlag</span></code> &gt; 0) are included here.</p>
<p>This version of the plot shows the distributions for the various <code class="docutils literal notranslate"><span class="pre">ExpertClass</span></code> values along with, for comparison, the distribution for all objects in gray (which is identical in each panel).  Most objects are classified as confident or likely variables.  Objects with lower MAD values (indicating a lower amplitude of variability) are less likely to be identified as confident variables because low-level variability is more difficult to confirm via visual examination.</p>
<section id="data-bins">
<h4>Data &amp; Bins<a class="headerlink" href="#data-bins" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;FilterDetFlag&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">mad</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MAD&#39;</span><span class="p">][</span><span class="n">w</span><span class="p">]</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;ExpertClass&#39;</span><span class="p">][</span><span class="n">w</span><span class="p">]</span>

<span class="n">xrange</span> <span class="o">=</span> <span class="p">[</span><span class="mf">7.e-3</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">xrange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">xrange</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">xrange</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plots">
<h4>Plots<a class="headerlink" href="#plots" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Confident&#39;</span><span class="p">,</span> <span class="s1">&#39;Likely&#39;</span><span class="p">,</span> <span class="s1">&#39;Artifact&#39;</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C0&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">labels</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mad</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;All&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mad</span><span class="p">[</span><span class="n">e</span> <span class="o">==</span> <span class="n">v</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
    
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;HCV Expert Validation&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;MAD Variability Index [mag]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The plot below shows the same distributions, but plotted as stacked histograms.  The top panel uses a linear scale on the y-axis and the bottom panel uses a log y scale.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="n">ylogs</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">ylog</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">ylogs</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mad</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="n">ylog</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Artifact&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mad</span><span class="p">[</span><span class="n">e</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="n">ylog</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Likely Variable&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mad</span><span class="p">[</span><span class="n">e</span> <span class="o">==</span> <span class="mi">1</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="n">ylog</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Confident Variable&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;MAD Variability Index [mag]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;HCV Expert Validation&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="plot-the-fraction-of-artifacts-as-a-function-of-mad-variability-index-a-name-artifacts-a">
<h3>Plot the fraction of artifacts as a function of MAD variability index <a name="artifacts"></a><a class="headerlink" href="#plot-the-fraction-of-artifacts-as-a-function-of-mad-variability-index-a-name-artifacts-a" title="Permalink to this headline">#</a></h3>
<p>This shows how the fraction of artifacts varies with the MAD value.  For larger MAD values the fraction decreases sharply, presumably because such large values are less likely to result from the usual artifacts.  Interestingly, the artifact fraction also declines for smaller MAD values (MAD &lt; 0.1 mag).  Probably that happens because typical artifacts are more likely to produce strong signals than the weaker signals indicated by a low MAD value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;FilterDetFlag&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">mad</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MAD&#39;</span><span class="p">][</span><span class="n">w</span><span class="p">]</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;ExpertClass&#39;</span><span class="p">][</span><span class="n">w</span><span class="p">]</span>

<span class="n">xrange</span> <span class="o">=</span> <span class="p">[</span><span class="mf">7.e-3</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">xrange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">xrange</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">xrange</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="n">all_count</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">mad</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
<span class="n">artifact_count</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">mad</span><span class="p">[</span><span class="n">e</span> <span class="o">==</span> <span class="mi">4</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
<span class="n">wnz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">all_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">nnz</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wnz</span><span class="p">)</span>

<span class="n">artifact_count</span> <span class="o">=</span> <span class="n">artifact_count</span><span class="p">[</span><span class="n">wnz</span><span class="p">]</span>
<span class="n">all_count</span> <span class="o">=</span> <span class="n">all_count</span><span class="p">[</span><span class="n">wnz</span><span class="p">]</span>
<span class="n">xerr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">nnz</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">xerr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">bin_edges</span><span class="p">[</span><span class="n">wnz</span><span class="p">]</span>
<span class="n">xerr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">bin_edges</span><span class="p">[</span><span class="n">wnz</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># combine bins at edge into one big bin to improve the statistics there</span>
<span class="n">iz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">all_count</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="k">if</span> <span class="n">iz</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">all_count</span><span class="p">[</span><span class="n">iz</span><span class="p">]</span> <span class="o">+=</span> <span class="n">all_count</span><span class="p">[:</span><span class="n">iz</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">artifact_count</span><span class="p">[</span><span class="n">iz</span><span class="p">]</span> <span class="o">+=</span> <span class="n">artifact_count</span><span class="p">[:</span><span class="n">iz</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">xerr</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">iz</span><span class="p">]</span> <span class="o">=</span> <span class="n">xerr</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">all_count</span> <span class="o">=</span> <span class="n">all_count</span><span class="p">[</span><span class="n">iz</span><span class="p">:]</span>
    <span class="n">artifact_count</span> <span class="o">=</span> <span class="n">artifact_count</span><span class="p">[</span><span class="n">iz</span><span class="p">:]</span>
    <span class="n">xerr</span> <span class="o">=</span> <span class="n">xerr</span><span class="p">[:,</span> <span class="n">iz</span><span class="p">:]</span>
    
<span class="n">iz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">all_count</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">40</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="k">if</span> <span class="n">iz</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">all_count</span><span class="p">[</span><span class="o">-</span><span class="n">iz</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">all_count</span><span class="p">[</span><span class="o">-</span><span class="n">iz</span><span class="p">:]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">artifact_count</span><span class="p">[</span><span class="o">-</span><span class="n">iz</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">artifact_count</span><span class="p">[</span><span class="o">-</span><span class="n">iz</span><span class="p">:]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">xerr</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">iz</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">xerr</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">all_count</span> <span class="o">=</span> <span class="n">all_count</span><span class="p">[:</span><span class="o">-</span><span class="n">iz</span><span class="p">]</span>
    <span class="n">artifact_count</span> <span class="o">=</span> <span class="n">artifact_count</span><span class="p">[:</span><span class="o">-</span><span class="n">iz</span><span class="p">]</span>
    <span class="n">xerr</span> <span class="o">=</span> <span class="n">xerr</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="n">iz</span><span class="p">]</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">xerr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">xerr</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">xerr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">xerr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">xerr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">xerr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span>

<span class="n">frac</span> <span class="o">=</span> <span class="n">artifact_count</span><span class="o">/</span><span class="n">all_count</span>
<span class="c1"># error on fraction using binomial distribution (approximate)</span>
<span class="n">ferr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">frac</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">frac</span><span class="p">)</span><span class="o">/</span><span class="n">all_count</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Create the plot</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">frac</span><span class="p">,</span> <span class="n">xerr</span><span class="o">=</span><span class="n">xerr</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">ferr</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;ob&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Artifact fraction&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;MAD Variability Index [mag]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Artifact Fraction&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;HCV Expert Validation&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-light-curve-for-the-most-variable-high-quality-candidate-in-the-hcv-a-name-most-variable-a">
<h3>Plot light curve for the most variable high quality candidate in the HCV <a name="most_variable"></a><a class="headerlink" href="#plot-light-curve-for-the-most-variable-high-quality-candidate-in-the-hcv-a-name-most-variable-a" title="Permalink to this headline">#</a></h3>
<p>Select the candidate variable with the largest MAD value and <code class="docutils literal notranslate"><span class="pre">VarQualFlag</span></code> = ‘AAAAA’.  To find the highest MAD value, we sort by MAD in descending order and select the first result.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jobs</span> <span class="o">=</span> <span class="n">mastcasjobs</span><span class="o">.</span><span class="n">MastCasJobs</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">HSCContext</span><span class="p">)</span>

<span class="c1"># join to the Groups table as well to get the target name</span>

<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">select top 1 m.MatchID, m.GroupID, m.SubGroupID, g.TargetName, m.RA, m.Dec,</span>
<span class="s2">   m.AutoClass, m.ExpertClass, m.NumFilters,</span>
<span class="s2">   f.Filter, f.FilterDetFlag, f.VarQualFlag, f.NumLC, </span>
<span class="s2">   f.MeanMag, f.MeanCorrMag, f.MAD, f.Chi2</span>
<span class="s2">from HCVmatch m</span>
<span class="s2">join HCVfilter f on m.MatchID=f.MatchID</span>
<span class="s2">join Groups g on m.GroupID=g.GroupID</span>
<span class="s2">where f.VarQualFlag=&#39;AAAAA&#39;</span>
<span class="s2">order by f.MAD desc</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">tab</span> <span class="o">=</span> <span class="n">jobs</span><span class="o">.</span><span class="n">quick</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;HCV demo&quot;</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">HSCContext</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Completed in </span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> sec&quot;</span><span class="p">)</span>

<span class="c1"># clean up the output format</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MeanMag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MeanCorrMag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MAD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Chi2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;RA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.6f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Dec&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.6f}</span><span class="s2">&quot;</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MatchID </span><span class="si">{</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MatchID&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> in group &#39;</span><span class="si">{</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;TargetName&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; has largest MAD value = </span><span class="si">{</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MAD&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">tab</span>
</pre></div>
</div>
</div>
</div>
<p>Get the light curve.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">matchid</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MatchID&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">mfilter</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Filter&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="n">jobs</span> <span class="o">=</span> <span class="n">mastcasjobs</span><span class="o">.</span><span class="n">MastCasJobs</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">HSCContext</span><span class="p">)</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># get light curves for F606W and F814W</span>
<span class="n">lc</span> <span class="o">=</span> <span class="n">jobs</span><span class="o">.</span><span class="n">quick</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;select * from HCVdetailed</span>
<span class="s2">where MatchID=</span><span class="si">{}</span><span class="s2"> and Filter=&#39;</span><span class="si">{}</span><span class="s2">&#39;</span>
<span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">matchid</span><span class="p">,</span> <span class="n">mfilter</span><span class="p">),</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;HCV demo&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> sec: retrieved </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lc</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">mfilter</span><span class="si">}</span><span class="s2"> measurements&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Plot the light curve.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;MJD&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;CorrMag&#39;</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="s1">&#39;MagErr&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;ob&#39;</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">mfilter</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">lc</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;MJD [days]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;magnitude&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;MatchID: </span><span class="si">{</span><span class="n">matchid</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;TargetName&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> MAD=</span><span class="si">{</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MAD&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Extract cutout images for the entire light curve (since it does not have many points).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sort images in MJD order</span>
<span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">lc</span><span class="p">[</span><span class="s1">&#39;MJD&#39;</span><span class="p">])</span>

<span class="c1"># we plot zoomed-in and zoomed-out views side-by-side for each selected image</span>
<span class="n">nim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># images per row</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="p">(</span><span class="n">nim</span><span class="o">+</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="n">ncols</span>

<span class="n">imsize1</span> <span class="o">=</span> <span class="mi">19</span>
<span class="n">imsize2</span> <span class="o">=</span> <span class="mi">101</span>
<span class="n">mra</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;RA&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">mdec</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Dec&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># define figure and axes</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="o">/</span><span class="n">ncols</span><span class="p">)</span><span class="o">*</span><span class="n">nrows</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># iterate through each set of two subplots in axes</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">((</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">),</span> <span class="n">k</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">ind</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span>
    
    <span class="c1"># get the images</span>
    <span class="n">im1</span> <span class="o">=</span> <span class="n">get_hla_cutout</span><span class="p">(</span><span class="n">lc</span><span class="p">[</span><span class="s1">&#39;ImageName&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">mra</span><span class="p">,</span> <span class="n">mdec</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">imsize1</span><span class="p">)</span>
    <span class="n">im2</span> <span class="o">=</span> <span class="n">get_hla_cutout</span><span class="p">(</span><span class="n">lc</span><span class="p">[</span><span class="s1">&#39;ImageName&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">mra</span><span class="p">,</span> <span class="n">mdec</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">imsize2</span><span class="p">)</span>
    
    <span class="c1"># plot left column    </span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im1</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">lc</span><span class="p">[</span><span class="s1">&#39;ImageName&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    
    <span class="c1"># plot right column</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im2</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">xbox</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">imsize1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">imsize2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xbox</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">xbox</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;m=</span><span class="si">{</span><span class="n">lc</span><span class="p">[</span><span class="s1">&#39;CorrMag&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> MJD=</span><span class="si">{</span><span class="n">lc</span><span class="p">[</span><span class="s1">&#39;MJD&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> s: finished </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span><span class="si">}</span><span class="s2"> epochs&quot;</span><span class="p">)</span>
    
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> s: got </span><span class="si">{</span><span class="n">nrows</span><span class="o">*</span><span class="n">ncols</span><span class="si">}</span><span class="s2"> cutouts&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "TheRealZoidberg/mast",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks/MAST/HSC/HCV_CASJOBS"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../HCV_API/HCV_API_demo.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Hubble Catalog of Variables Notebook (API version)</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../HSCV3_API/hscv3_api.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Hubble Source Catalog API Notebook</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By STScI<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>