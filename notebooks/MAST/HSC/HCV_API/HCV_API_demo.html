
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Hubble Catalog of Variables Notebook (API version) &#8212; MAST Notebook Repository</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../../../../_static/styles/bootstrap.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">

  
  <link href="../../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=796348d33e8b1d947c94" rel="stylesheet">
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../../_static/styles/sphinx-book-theme.css?digest=4ec06e9971c5264fbd345897d5258098f11cc577" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/table.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/main.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94">
<link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94">

    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/scripts/sphinx-book-theme.js?digest=8bf782fb4ee92b3d3646425e50f299c4e1fd152d"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/MAST/HSC/HCV_API/HCV_API_demo';</script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Hubble Source Catalog API Notebook" href="../HSCV3_API/hscv3_api.html" />
    <link rel="prev" title="Large Downloads in astroquery.mast" href="../../astroquery/large_downloads/large_downloads.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="../../../../search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../../../intro.html">

  
  
  
  
  
  
  

  
    <img src="../../../../_static/mastlogo.png" class="logo__image only-light" alt="Logo image">
    <img src="../../../../_static/mastlogo.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../astroquery/beginner_search_astroquery/beginner_search_astroquery.html">
                        Beginner: Searching MAST using astroquery.mast
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../astroquery/large_downloads/large_downloads.html">
                        Large Downloads in astroquery.mast
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="#">
                        Hubble Catalog of Variables Notebook (API version)
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../HSCV3_API/hscv3_api.html">
                        Hubble Source Catalog API Notebook
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../HSCV3_SMC_API/hscv3_smc_api.html">
                        Hubble Source Catalog API Notebook: SMC Color-Magnitude Diagram
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../HSC_TAP/HSC_TAP.html">
                        MAST Table Access Protocol Hubble Source Catalog Demo
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../SWEEPS_HSCV3P1/sweeps_hscv3p1.html">
                        Hubble Source Catalog SWEEPS Proper Motion Notebook
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../JWST/download_by_program_id/download_by_program_id.html">
                        Accessing JWST Proposal Data in astroquery.mast
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../JWST/Engineering_Database_Retreival/EDB_Retrieval.html">
                        JWST Engineering Data Retrieval
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../K2/K2_Lightcurve/K2_Lightcurve.html">
                        Beginner: Read and Plot A K2 Light Curve File
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../K2/K2_TPF/K2_TPF.html">
                        Beginner: Read and Display A K2 Target Pixel File
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../K2/beginner_how_to_use_ffi/beginner_how_to_use_ffi.html">
                        Beginner: Read and Display a K2 Full Frame Image
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../K2/k2_removing_instrumental_noise_using_pld/k2_removing_instrumental_noise_using_pld.html">
                        Removing Instrumental Noise from K2 and TESS Light Curves Using Pixel Level Decorrelation (PLD)
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/Kepler_DVT/Kepler_DVT.html">
                        Read and Plot A Kepler Data Validation Timeseries File
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/Kepler_FFI/kepler_ffi.html">
                        Plotting a Catalog over a Kepler Full Frame Image File
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/Kepler_Lightcurve/kepler_lightcurve.html">
                        Using Kepler Data to Plot a Light Curve
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/Kepler_TPF/kepler_tpf.html">
                        Plotting Images from Kepler Target Pixel Files
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_combining_multiple_quarters/kepler_combining_multiple_quarters.html">
                        Combining Multiple Quarters of Kepler Data with Lightkurve
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_creating_periodograms/kepler_creating_periodograms.html">
                        Creating Periodograms and Identifying Significant Peaks
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_creating_your_own_light_curves/kepler_creating_your_own_light_curves.html">
                        Creating Your Own Light Curves using Custom Aperture Photometry
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_how_to_estimate_a_stars_mass_and_radius_using_asteroseismology/kepler_how_to_estimate_a_stars_mass_and_radius_using_asteroseismology.html">
                        How to Estimate a Star’s Mass and Radius Using Asteroseismology
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_how_to_understand_and_manipulate_the_periodogram_of_an_oscillating_star/kepler_how_to_understand_and_manipulate_the_periodogram_of_an_oscillating_star.html">
                        How to Understand and Manipulate the Periodogram of an Oscillating Star
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_identifying_transiting_planet_signals/kepler_identifying_transiting_planet_signals.html">
                        Identifying Transiting Planet Signals in a Kepler Light Curve
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_instrumental_noise_1_data_gaps_and_quality_flags/kepler_instrumental_noise_1_data_gaps_and_quality_flags.html">
                        Instrumental Noise in Kepler and K2 #1: Data Gaps and Quality Flags
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_instrumental_noise_2_spurious_signals_and_time_sampling_effects/kepler_instrumental_noise_2_spurious_signals_and_time_sampling_effects.html">
                        Instrumental Noise in Kepler and K2 #2: Spurious Signals and Time Sampling Effects
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_instrumental_noise_3_seasonal_and_detector_effects/kepler_instrumental_noise_3_seasonal_and_detector_effects.html">
                        Instrumental Noise in Kepler and K2 #3: Seasonal and Detector Effects
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_instrumental_noise_4_electronic_noise/kepler_instrumental_noise_4_electronic_noise.html">
                        Instrumental Noise in Kepler and K2 #4: Electronic Noise
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_interactively_inspecting_target_pixel_files_and_light_curves/kepler_interactively_inspecting_target_pixel_files_and_light_curves.html">
                        Interactively Inspecting Target Pixel Files and Light Curves
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_measuring_a_rotation_period/kepler_measuring_a_rotation_period.html">
                        Measuring and Removing a Rotation Period Signal from a Kepler Light Curve
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_plotting_target_pixel_files/kepler_plotting_target_pixel_files.html">
                        Plotting Kepler Target Pixel File Products with Lightkurve
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_searching_for_data_products/kepler_searching_for_data_products.html">
                        Searching for Kepler/K2 and TESS Data Products Using Lightkurve
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_using_light_curve_products_with_lightkurve/kepler_using_light_curve_products_with_lightkurve.html">
                        Using Kepler Light Curve Products with Lightkurve
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_using_target_pixel_file_products_with_lightkurve/kepler_using_target_pixel_file_products_with_lightkurve.html">
                        Using Kepler Target Pixel File Products with Lightkurve
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_verifying_the_location_of_a_signal/kepler_verifying_the_location_of_a_signal.html">
                        Verifying the Location of a Signal in Kepler Pixel Data
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_visualizing_periodic_signals_using_a_river_plot/kepler_visualizing_periodic_signals_using_a_river_plot.html">
                        Visualizing Periodic Signals Using a River Plot
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../PanSTARRS/PS1_DR2_TAP/PS1_DR2_TAP.html">
                        MAST Table Access Protocol PanSTARRS 1 DR2 Demo
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/beginner_astroquery_dv/beginner_astroquery_dv.html">
                        Beginner: Retrieve TESS Data Validation Products with Astroquery
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/beginner_how_to_use_dvt/beginner_how_to_use_dvt.html">
                        Beginner: Read and Plot A TESS Data Validation Timeseries File
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/beginner_how_to_use_ffi/beginner_how_to_use_ffi.html">
                        Beginner: Read and Display a TESS Full Frame Image
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/beginner_how_to_use_lc/beginner_how_to_use_lc.html">
                        Beginner: Read and Plot A TESS Light Curve File
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/beginner_how_to_use_tp/beginner_how_to_use_tp.html">
                        Beginner: Read and Display A TESS Target Pixel File
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/beginner_tess_exomast/beginner_tess_exomast.html">
                        Exoplanet Data and TESS Light Curves Using Python Requests
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/beginner_tess_tap_search/beginner_tess_tap_search.html">
                        Download MAST TESS Light Curves Within an FFI Footprint Using TAP
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/beginner_tic_search_hd209458/beginner_tic_search_hd209458.html">
                        Beginner: Search The TESS Input Catalog Centered On HD 209458.
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/beginner_tour_lc_tp/beginner_tour_lc_tp.html">
                        Beginnner: A Tour of the Contents of the TESS 2-minute Cadence Data
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/interm_gi_query/interm_gi_query.html">
                        Intermediate:  Search and Download GI Program Light Curves
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/interm_tasc_lc/interm_tasc_lc.html">
                        Intermediate: Finding Flares and Variable Stars in TASC Light Curves
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/interm_tess_prf_retrieve/interm_tess_prf_retrieve.html">
                        Intermediate: Retrieve TESS Pixel Response Function Images
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/interm_tesscut_astroquery/interm_tesscut_astroquery.html">
                        Beginner: Cutout of the TESS FFIs using Astrocut and Astroquery
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/interm_tesscut_dss_overlay/interm_tesscut_dss_overlay.html">
                        Intermediate: Overlay a Cutout of the TESS FFIs with DSS imaging
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/interm_tesscut_requests/interm_tesscut_requests.html">
                        Intermediate: Create TESS FFI Cutout using Python Requests
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/tess_removing_scattered_light_using_regression/tess_removing_scattered_light_using_regression.html">
                        Removing Scattered Light from TESS Data Using the Lightkurve RegressionCorrector
                      </a>
                    </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      
        <div class="navbar-end-item navbar-persistent--container">
          
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
        </div>
      
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>


  
  
    <div class="navbar-persistent--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
    </div>
  

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../astroquery/beginner_search_astroquery/beginner_search_astroquery.html">
                        Beginner: Searching MAST using astroquery.mast
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../astroquery/large_downloads/large_downloads.html">
                        Large Downloads in astroquery.mast
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="#">
                        Hubble Catalog of Variables Notebook (API version)
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../HSCV3_API/hscv3_api.html">
                        Hubble Source Catalog API Notebook
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../HSCV3_SMC_API/hscv3_smc_api.html">
                        Hubble Source Catalog API Notebook: SMC Color-Magnitude Diagram
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../HSC_TAP/HSC_TAP.html">
                        MAST Table Access Protocol Hubble Source Catalog Demo
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../SWEEPS_HSCV3P1/sweeps_hscv3p1.html">
                        Hubble Source Catalog SWEEPS Proper Motion Notebook
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../JWST/download_by_program_id/download_by_program_id.html">
                        Accessing JWST Proposal Data in astroquery.mast
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../JWST/Engineering_Database_Retreival/EDB_Retrieval.html">
                        JWST Engineering Data Retrieval
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../K2/K2_Lightcurve/K2_Lightcurve.html">
                        Beginner: Read and Plot A K2 Light Curve File
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../K2/K2_TPF/K2_TPF.html">
                        Beginner: Read and Display A K2 Target Pixel File
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../K2/beginner_how_to_use_ffi/beginner_how_to_use_ffi.html">
                        Beginner: Read and Display a K2 Full Frame Image
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../K2/k2_removing_instrumental_noise_using_pld/k2_removing_instrumental_noise_using_pld.html">
                        Removing Instrumental Noise from K2 and TESS Light Curves Using Pixel Level Decorrelation (PLD)
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/Kepler_DVT/Kepler_DVT.html">
                        Read and Plot A Kepler Data Validation Timeseries File
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/Kepler_FFI/kepler_ffi.html">
                        Plotting a Catalog over a Kepler Full Frame Image File
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/Kepler_Lightcurve/kepler_lightcurve.html">
                        Using Kepler Data to Plot a Light Curve
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/Kepler_TPF/kepler_tpf.html">
                        Plotting Images from Kepler Target Pixel Files
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_combining_multiple_quarters/kepler_combining_multiple_quarters.html">
                        Combining Multiple Quarters of Kepler Data with Lightkurve
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_creating_periodograms/kepler_creating_periodograms.html">
                        Creating Periodograms and Identifying Significant Peaks
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_creating_your_own_light_curves/kepler_creating_your_own_light_curves.html">
                        Creating Your Own Light Curves using Custom Aperture Photometry
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_how_to_estimate_a_stars_mass_and_radius_using_asteroseismology/kepler_how_to_estimate_a_stars_mass_and_radius_using_asteroseismology.html">
                        How to Estimate a Star’s Mass and Radius Using Asteroseismology
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_how_to_understand_and_manipulate_the_periodogram_of_an_oscillating_star/kepler_how_to_understand_and_manipulate_the_periodogram_of_an_oscillating_star.html">
                        How to Understand and Manipulate the Periodogram of an Oscillating Star
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_identifying_transiting_planet_signals/kepler_identifying_transiting_planet_signals.html">
                        Identifying Transiting Planet Signals in a Kepler Light Curve
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_instrumental_noise_1_data_gaps_and_quality_flags/kepler_instrumental_noise_1_data_gaps_and_quality_flags.html">
                        Instrumental Noise in Kepler and K2 #1: Data Gaps and Quality Flags
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_instrumental_noise_2_spurious_signals_and_time_sampling_effects/kepler_instrumental_noise_2_spurious_signals_and_time_sampling_effects.html">
                        Instrumental Noise in Kepler and K2 #2: Spurious Signals and Time Sampling Effects
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_instrumental_noise_3_seasonal_and_detector_effects/kepler_instrumental_noise_3_seasonal_and_detector_effects.html">
                        Instrumental Noise in Kepler and K2 #3: Seasonal and Detector Effects
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_instrumental_noise_4_electronic_noise/kepler_instrumental_noise_4_electronic_noise.html">
                        Instrumental Noise in Kepler and K2 #4: Electronic Noise
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_interactively_inspecting_target_pixel_files_and_light_curves/kepler_interactively_inspecting_target_pixel_files_and_light_curves.html">
                        Interactively Inspecting Target Pixel Files and Light Curves
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_measuring_a_rotation_period/kepler_measuring_a_rotation_period.html">
                        Measuring and Removing a Rotation Period Signal from a Kepler Light Curve
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_plotting_target_pixel_files/kepler_plotting_target_pixel_files.html">
                        Plotting Kepler Target Pixel File Products with Lightkurve
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_searching_for_data_products/kepler_searching_for_data_products.html">
                        Searching for Kepler/K2 and TESS Data Products Using Lightkurve
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_using_light_curve_products_with_lightkurve/kepler_using_light_curve_products_with_lightkurve.html">
                        Using Kepler Light Curve Products with Lightkurve
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_using_target_pixel_file_products_with_lightkurve/kepler_using_target_pixel_file_products_with_lightkurve.html">
                        Using Kepler Target Pixel File Products with Lightkurve
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_verifying_the_location_of_a_signal/kepler_verifying_the_location_of_a_signal.html">
                        Verifying the Location of a Signal in Kepler Pixel Data
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Kepler/kepler_visualizing_periodic_signals_using_a_river_plot/kepler_visualizing_periodic_signals_using_a_river_plot.html">
                        Visualizing Periodic Signals Using a River Plot
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../PanSTARRS/PS1_DR2_TAP/PS1_DR2_TAP.html">
                        MAST Table Access Protocol PanSTARRS 1 DR2 Demo
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/beginner_astroquery_dv/beginner_astroquery_dv.html">
                        Beginner: Retrieve TESS Data Validation Products with Astroquery
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/beginner_how_to_use_dvt/beginner_how_to_use_dvt.html">
                        Beginner: Read and Plot A TESS Data Validation Timeseries File
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/beginner_how_to_use_ffi/beginner_how_to_use_ffi.html">
                        Beginner: Read and Display a TESS Full Frame Image
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/beginner_how_to_use_lc/beginner_how_to_use_lc.html">
                        Beginner: Read and Plot A TESS Light Curve File
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/beginner_how_to_use_tp/beginner_how_to_use_tp.html">
                        Beginner: Read and Display A TESS Target Pixel File
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/beginner_tess_exomast/beginner_tess_exomast.html">
                        Exoplanet Data and TESS Light Curves Using Python Requests
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/beginner_tess_tap_search/beginner_tess_tap_search.html">
                        Download MAST TESS Light Curves Within an FFI Footprint Using TAP
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/beginner_tic_search_hd209458/beginner_tic_search_hd209458.html">
                        Beginner: Search The TESS Input Catalog Centered On HD 209458.
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/beginner_tour_lc_tp/beginner_tour_lc_tp.html">
                        Beginnner: A Tour of the Contents of the TESS 2-minute Cadence Data
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/interm_gi_query/interm_gi_query.html">
                        Intermediate:  Search and Download GI Program Light Curves
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/interm_tasc_lc/interm_tasc_lc.html">
                        Intermediate: Finding Flares and Variable Stars in TASC Light Curves
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/interm_tess_prf_retrieve/interm_tess_prf_retrieve.html">
                        Intermediate: Retrieve TESS Pixel Response Function Images
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/interm_tesscut_astroquery/interm_tesscut_astroquery.html">
                        Beginner: Cutout of the TESS FFIs using Astrocut and Astroquery
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/interm_tesscut_dss_overlay/interm_tesscut_dss_overlay.html">
                        Intermediate: Overlay a Cutout of the TESS FFIs with DSS imaging
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/interm_tesscut_requests/interm_tesscut_requests.html">
                        Intermediate: Create TESS FFI Cutout using Python Requests
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../TESS/tess_removing_scattered_light_using_regression/tess_removing_scattered_light_using_regression.html">
                        Removing Scattered Light from TESS Data Using the Lightkurve RegressionCorrector
                      </a>
                    </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item">
  


<a class="navbar-brand logo" href="../../../../intro.html">

  
  
  
  
  
  
  

  
    <img src="../../../../_static/mastlogo.png" class="logo__image only-light" alt="Logo image">
    <img src="../../../../_static/mastlogo.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    </div>
    <div class="sidebar-start-items__item">
<form class="bd-search d-flex align-items-center" action="../../../../search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
    <div class="sidebar-start-items__item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../../intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Astroquery</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../astroquery/beginner_search_astroquery/beginner_search_astroquery.html">Beginner: Searching MAST using astroquery.mast</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../astroquery/large_downloads/large_downloads.html">Large Downloads in <code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code></a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">HSC</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Hubble Catalog of Variables Notebook (API version)</a></li>



<li class="toctree-l1"><a class="reference internal" href="../HSCV3_API/hscv3_api.html">Hubble Source Catalog API Notebook</a></li>



<li class="toctree-l1"><a class="reference internal" href="../HSCV3_SMC_API/hscv3_smc_api.html">Hubble Source Catalog API Notebook: SMC Color-Magnitude Diagram</a></li>



<li class="toctree-l1"><a class="reference internal" href="../HSC_TAP/HSC_TAP.html">MAST Table Access Protocol Hubble Source Catalog Demo</a></li>

<li class="toctree-l1"><a class="reference internal" href="../SWEEPS_HSCV3P1/sweeps_hscv3p1.html">Hubble Source Catalog SWEEPS Proper Motion Notebook</a></li>






















</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">JWST</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../JWST/download_by_program_id/download_by_program_id.html">Accessing JWST Proposal Data in astroquery.mast</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../JWST/Engineering_Database_Retreival/EDB_Retrieval.html">JWST Engineering Data Retrieval</a></li>




</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Kepler K2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../K2/K2_Lightcurve/K2_Lightcurve.html">Beginner: Read and Plot A K2 Light Curve File</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../K2/K2_TPF/K2_TPF.html">Beginner: Read and Display A K2 Target Pixel File</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../K2/beginner_how_to_use_ffi/beginner_how_to_use_ffi.html">Beginner: Read and Display a K2 Full Frame Image</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../K2/k2_removing_instrumental_noise_using_pld/k2_removing_instrumental_noise_using_pld.html">Removing Instrumental Noise from <em>K2</em> and <em>TESS</em> Light Curves Using Pixel Level Decorrelation (PLD)</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Kepler</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Kepler/Kepler_DVT/Kepler_DVT.html">Read and Plot A Kepler Data Validation Timeseries File</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Kepler/Kepler_FFI/kepler_ffi.html">Plotting a Catalog over a Kepler Full Frame Image File</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Kepler/Kepler_Lightcurve/kepler_lightcurve.html">Using Kepler Data to Plot a Light Curve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Kepler/Kepler_TPF/kepler_tpf.html">Plotting Images from Kepler Target Pixel Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Kepler/kepler_combining_multiple_quarters/kepler_combining_multiple_quarters.html">Combining Multiple Quarters of <em>Kepler</em> Data with Lightkurve</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../Kepler/kepler_creating_periodograms/kepler_creating_periodograms.html">Creating Periodograms and Identifying Significant Peaks</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../Kepler/kepler_creating_your_own_light_curves/kepler_creating_your_own_light_curves.html">Creating Your Own Light Curves using Custom Aperture Photometry</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../Kepler/kepler_how_to_estimate_a_stars_mass_and_radius_using_asteroseismology/kepler_how_to_estimate_a_stars_mass_and_radius_using_asteroseismology.html">How to Estimate a Star’s Mass and Radius Using Asteroseismology</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../Kepler/kepler_how_to_understand_and_manipulate_the_periodogram_of_an_oscillating_star/kepler_how_to_understand_and_manipulate_the_periodogram_of_an_oscillating_star.html">How to Understand and Manipulate the Periodogram of an Oscillating Star</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../Kepler/kepler_identifying_transiting_planet_signals/kepler_identifying_transiting_planet_signals.html">Identifying Transiting Planet Signals in a <em>Kepler</em> Light Curve</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../Kepler/kepler_instrumental_noise_1_data_gaps_and_quality_flags/kepler_instrumental_noise_1_data_gaps_and_quality_flags.html">Instrumental Noise in <em>Kepler</em> and <em>K2</em> #1: Data Gaps and Quality Flags</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../Kepler/kepler_instrumental_noise_2_spurious_signals_and_time_sampling_effects/kepler_instrumental_noise_2_spurious_signals_and_time_sampling_effects.html">Instrumental Noise in <em>Kepler</em> and <em>K2</em> #2: Spurious Signals and Time Sampling Effects</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../Kepler/kepler_instrumental_noise_3_seasonal_and_detector_effects/kepler_instrumental_noise_3_seasonal_and_detector_effects.html">Instrumental Noise in <em>Kepler</em> and <em>K2</em> #3: Seasonal and Detector Effects</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../Kepler/kepler_instrumental_noise_4_electronic_noise/kepler_instrumental_noise_4_electronic_noise.html">Instrumental Noise in <em>Kepler</em> and <em>K2</em> #4: Electronic Noise</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../Kepler/kepler_interactively_inspecting_target_pixel_files_and_light_curves/kepler_interactively_inspecting_target_pixel_files_and_light_curves.html">Interactively Inspecting Target Pixel Files and Light Curves</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../Kepler/kepler_measuring_a_rotation_period/kepler_measuring_a_rotation_period.html">Measuring and Removing a Rotation Period Signal from a <em>Kepler</em> Light Curve</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../Kepler/kepler_plotting_target_pixel_files/kepler_plotting_target_pixel_files.html">Plotting <em>Kepler</em> Target Pixel File Products with Lightkurve</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../Kepler/kepler_searching_for_data_products/kepler_searching_for_data_products.html">Searching for <em>Kepler</em>/<em>K2</em> and <em>TESS</em> Data Products Using Lightkurve</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../Kepler/kepler_using_light_curve_products_with_lightkurve/kepler_using_light_curve_products_with_lightkurve.html">Using <em>Kepler</em> Light Curve Products with Lightkurve</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../Kepler/kepler_using_target_pixel_file_products_with_lightkurve/kepler_using_target_pixel_file_products_with_lightkurve.html">Using <em>Kepler</em> Target Pixel File Products with Lightkurve</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../Kepler/kepler_verifying_the_location_of_a_signal/kepler_verifying_the_location_of_a_signal.html">Verifying the Location of a Signal in <em>Kepler</em> Pixel Data</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../Kepler/kepler_visualizing_periodic_signals_using_a_river_plot/kepler_visualizing_periodic_signals_using_a_river_plot.html">Visualizing Periodic Signals Using a River Plot</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PanSTARRS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../PanSTARRS/PS1_DR2_TAP/PS1_DR2_TAP.html">MAST Table Access Protocol PanSTARRS 1 DR2 Demo</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">TESS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../TESS/beginner_astroquery_dv/beginner_astroquery_dv.html">Beginner: Retrieve TESS Data Validation Products with Astroquery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../TESS/beginner_how_to_use_dvt/beginner_how_to_use_dvt.html">Beginner: Read and Plot A TESS Data Validation Timeseries File</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../TESS/beginner_how_to_use_ffi/beginner_how_to_use_ffi.html">Beginner: Read and Display a TESS Full Frame Image</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../TESS/beginner_how_to_use_lc/beginner_how_to_use_lc.html">Beginner: Read and Plot A TESS Light Curve File</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../TESS/beginner_how_to_use_tp/beginner_how_to_use_tp.html">Beginner: Read and Display A TESS Target Pixel File</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../TESS/beginner_tess_exomast/beginner_tess_exomast.html">Exoplanet Data and TESS Light Curves Using Python Requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../TESS/beginner_tess_tap_search/beginner_tess_tap_search.html">Download MAST TESS Light Curves Within an FFI Footprint Using TAP</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../TESS/beginner_tic_search_hd209458/beginner_tic_search_hd209458.html">Beginner: Search The TESS Input Catalog Centered On HD 209458.</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../TESS/beginner_tour_lc_tp/beginner_tour_lc_tp.html">Beginnner: A Tour of the Contents of the TESS 2-minute Cadence Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../TESS/interm_gi_query/interm_gi_query.html">Intermediate:  Search and Download GI Program Light Curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../TESS/interm_tasc_lc/interm_tasc_lc.html">Intermediate: Finding Flares and Variable Stars in TASC Light Curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../TESS/interm_tess_prf_retrieve/interm_tess_prf_retrieve.html">Intermediate: Retrieve TESS Pixel Response Function Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../TESS/interm_tesscut_astroquery/interm_tesscut_astroquery.html">Beginner: Cutout of the TESS FFIs using Astrocut and Astroquery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../TESS/interm_tesscut_dss_overlay/interm_tesscut_dss_overlay.html">Intermediate: Overlay a Cutout of the TESS FFIs with DSS imaging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../TESS/interm_tesscut_requests/interm_tesscut_requests.html">Intermediate: Create TESS FFI Cutout using Python Requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../TESS/tess_removing_scattered_light_using_regression/tess_removing_scattered_light_using_regression.html">Removing Scattered Light from <em>TESS</em> Data Using the Lightkurve <code class="docutils literal notranslate"><span class="pre">RegressionCorrector</span></code></a></li>

</ul>

    </div>
</nav>
    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

  
  <div id="rtd-footer-container"></div>

      </div>
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        <label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" data-toggle="tooltip" data-placement="right" title="Toggle primary sidebar">
            <span class="fa-solid fa-bars"></span>
        </label>
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="btn btn-sm"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<div class="dropdown dropdown-repository-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      <li><a href="https://github.com/spacetelescope/mast_notebooks" target="_blank"
   class="btn btn-sm dropdown-item"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">repository</span>
</a>
</a>
      
      <li><a href="https://github.com/spacetelescope/mast_notebooks/issues/new?title=Issue%20on%20page%20%2Fnotebooks/MAST/HSC/HCV_API/HCV_API_demo.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm dropdown-item"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">open issue</span>
</a>
</a>
      
  </ul>
</div>



<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      <li><a href="../../../../_sources/notebooks/MAST/HSC/HCV_API/HCV_API_demo.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</a>
      
      <li>
<button onclick="printPdf(this)"
  class="btn btn-sm dropdown-item"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</a>
      
  </ul>
</div>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary" data-toggle="tooltip" data-placement="left" title="Toggle secondary sidebar">
            <span class="fa-solid fa-list"></span>
        </label>
    </div>
</div>
            </div>
            
            

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Hubble Catalog of Variables Notebook (API version)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Hubble Catalog of Variables Notebook (API version)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rick-white-steve-lubow-trenton-mckinney">
     2019 - 2022, Rick White, Steve Lubow, Trenton McKinney
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#instructions">
   Instructions
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#table-of-contents">
   Table of Contents
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#initialization-a-name-initialization-a">
   Initialization
   <a name="initialization">
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#install-python-modules">
     Install Python modules
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mast-api-functions">
     MAST API functions
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#variable-objects-near-ic-1613-a-name-ic1613-a">
     Variable objects near IC 1613
     <a name="ic1613">
     </a>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#use-mast-name-resolver-to-get-position-of-ic-1613-a-name-resolver-a">
       Use MAST name resolver to get position of IC 1613
       <a name="resolver">
       </a>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#select-objects-near-ic-1613-from-hcv-a-name-summary-a">
       Select objects near IC 1613 from HCV
       <a name="summary">
       </a>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#description-of-the-variable-classification-columns-a-name-classification-a">
       Description of the variable classification columns
       <a name="classification">
       </a>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#find-objects-with-measurements-in-both-f475w-and-f814w">
       Find objects with measurements in both F475W and F814W
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-object-positions-on-the-sky-a-name-positions-a">
       Plot object positions on the sky
       <a name="positions">
       </a>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-hcv-mad-variability-index-versus-magnitude-in-f475w-a-name-variability-a">
       Plot HCV MAD variability index versus magnitude in F475W
       <a name="variability">
       </a>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-variables-in-color-magnitude-diagram-a-name-cmd-a">
       Plot variables in color-magnitude diagram
       <a name="cmd">
       </a>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-a-light-curve-for-a-nova-in-m87-a-name-m87-a">
     Get a light curve for a nova in M87
     <a name="m87">
     </a>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#extract-light-curve-for-a-given-matchid-a-name-lightcurve-a">
       Extract light curve for a given MatchID
       <a name="lightcurve">
       </a>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#get-hla-image-cutouts-for-the-nova-a-name-cutouts-a">
       Get HLA image cutouts for the nova
       <a name="cutouts">
       </a>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compare-the-hcv-automatic-classification-to-expert-validations-a-name-expert-a">
     Compare the HCV automatic classification to expert validations
     <a name="expert">
     </a>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-the-mad-variability-index-distribution-with-expert-classifications-a-name-mad-expert-a">
       Plot the MAD variability index distribution with expert classifications
       <a name="mad_expert">
       </a>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#data-bins">
         Data &amp; Bins
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#plots">
         Plots
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-the-fraction-of-artifacts-as-a-function-of-mad-variability-index-a-name-artifacts-a">
       Plot the fraction of artifacts as a function of MAD variability index
       <a name="artifacts">
       </a>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-light-curve-for-the-most-variable-high-quality-candidate-in-the-hcv-a-name-most-variable-a">
       Plot light curve for the most variable high quality candidate in the HCV
       <a name="most_variable">
       </a>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>

            <article class="bd-article" role="main">
              
  <section id="hubble-catalog-of-variables-notebook-api-version">
<h1>Hubble Catalog of Variables Notebook (API version)<a class="headerlink" href="#hubble-catalog-of-variables-notebook-api-version" title="Permalink to this heading">#</a></h1>
<section id="rick-white-steve-lubow-trenton-mckinney">
<h2>2019 - 2022, Rick White, Steve Lubow, Trenton McKinney<a class="headerlink" href="#rick-white-steve-lubow-trenton-mckinney" title="Permalink to this heading">#</a></h2>
<p>This notebook shows how to access the <a class="reference external" href="http://archive.stsci.edu/hlsp/hcv/">Hubble Catalogs of Variables (HCV)</a>. The HCV is a large catalog of faint variable objects extracted from version 3 of the <a class="reference external" href="https://archive.stsci.edu/hst/hsc">Hubble Source Catalog</a>. The HCV project at the National Observatory of Athens was funded by the European Space Agency (PI: Alceste Bonanos). The data products for the HCV are available both at the <a class="reference external" href="http://archives.esac.esa.int/ehst">ESA Hubble Archive</a> at <a class="reference external" href="https://www.cosmos.esa.int/web/esdc">ESAC</a> through the <a class="reference external" href="http://archives.esac.esa.int/hcv-explorer">HCV Explorer</a> interface and at STScI.</p>
<p>This notebook uses the <a class="reference external" href="https://catalogs.mast.stsci.edu/hsc">MAST HSC catalog interface</a>, which supports queries to the current and previous versions of the <a class="reference external" href="https://archive.stsci.edu/hst/hsc">Hubble Source Catalog</a>. It allows searches of several different tables including the HCV summary and detailed tables. It also has an associated <a class="reference external" href="https://catalogs.mast.stsci.edu/docs/hsc.html">API</a> that is used for data access in this notebook.</p>
<p>For similar examples using the <a class="reference external" href="https://mastweb.stsci.edu/hcasjobs">MAST CasJobs</a> interface, a SQL database query interface that is more complex to use, but more powerful than the API, see <a class="reference internal" href="../HCV_CASJOBS/HCV_casjobs_demo.html"><span class="doc std std-doc">HCV_CasJobs</span></a>.</p>
</section>
</section>
<section id="instructions">
<h1>Instructions<a class="headerlink" href="#instructions" title="Permalink to this heading">#</a></h1>
<ul class="simple">
<li><p>Complete the initialization steps <span class="xref myst">described below</span>.</p></li>
<li><p>Run the initialization steps before running the rest of the notebook.</p></li>
<li><p>Modify and rerun any sections of the Table of Contents below.</p></li>
</ul>
</section>
<section id="table-of-contents">
<h1>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this heading">#</a></h1>
<ul class="simple">
<li><p><span class="xref myst">Intialization</span></p></li>
<li><p><span class="xref myst">Variable objects in IC 1613</span></p>
<ul>
<li><p><span class="xref myst">Name resolver</span></p></li>
<li><p><span class="xref myst">Select objects from HCV</span></p></li>
<li><p><span class="xref myst">Information on HCV variable classification</span></p></li>
<li><p><span class="xref myst">Sky coverage</span></p></li>
<li><p><span class="xref myst">Properties of variable objects</span></p></li>
<li><p><span class="xref myst">Color magnitude diagram</span></p></li>
</ul>
</li>
<li><p><span class="xref myst">Light curve for a nova in M87</span></p>
<ul>
<li><p><span class="xref myst">Extract and plot light curve for the nova</span></p></li>
<li><p><span class="xref myst">HLA cutout images for selected measurements</span></p></li>
</ul>
</li>
<li><p><span class="xref myst">Compare the HCV automatic classification to expert validations</span></p>
<ul>
<li><p><span class="xref myst">Plot MAD variability index distribution</span></p></li>
<li><p><span class="xref myst">Plot fraction of artifacts vs. MAD</span></p></li>
</ul>
</li>
<li><p><span class="xref myst">Plot light curve for most variable high-quality candidate in the HCV</span></p></li>
</ul>
</section>
<section id="initialization-a-name-initialization-a">
<h1>Initialization <a name="initialization"></a><a class="headerlink" href="#initialization-a-name-initialization-a" title="Permalink to this heading">#</a></h1>
<section id="install-python-modules">
<h2>Install Python modules<a class="headerlink" href="#install-python-modules" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><em>This notebook requires the use of <strong>Python 3</strong>.</em></p></li>
<li><p>Modules can be installed with <code class="docutils literal notranslate"><span class="pre">conda</span></code>, if using the <a class="reference external" href="http://archive.stsci.edu/hlsp/hcv/">Anaconda distribution</a> of python, or with <code class="docutils literal notranslate"><span class="pre">pip</span></code>.</p>
<ul class="simple">
<li><p>If you are using <code class="docutils literal notranslate"><span class="pre">conda</span></code>, do not install / update / remove a module with <code class="docutils literal notranslate"><span class="pre">pip</span></code>, that exists in a <code class="docutils literal notranslate"><span class="pre">conda</span></code> <a class="reference external" href="https://archive.stsci.edu/hst/hsc">channel</a>.</p></li>
<li><p>If a module is not available with <code class="docutils literal notranslate"><span class="pre">conda</span></code>, then it’s okay to install it with <code class="docutils literal notranslate"><span class="pre">pip</span></code></p></li>
</ul>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">astropy</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">SkyCoord</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>

<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">Table</span><span class="p">,</span> <span class="n">join</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">ascii</span>

<span class="c1"># set width for pprint</span>
<span class="n">astropy</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">max_width</span> <span class="o">=</span> <span class="mi">150</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set universal matplotlib parameters</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="mast-api-functions">
<h2>MAST API functions<a class="headerlink" href="#mast-api-functions" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Here we define several interrelated functions for retrieving information from the MAST API.</p>
<ul>
<li><p>The <code class="docutils literal notranslate"><span class="pre">hcvcone(ra,</span> <span class="pre">dec,</span> <span class="pre">radius</span> <span class="pre">[,</span> <span class="pre">keywords])</span></code> function searches the HCV catalog near a position.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">hcvsearch()</span></code> function performs general non-positional queries.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">hcvmetadata()</span></code> function gives information about the columns available in a table.</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hscapiurl</span> <span class="o">=</span> <span class="s2">&quot;https://catalogs.mast.stsci.edu/api/v0.1/hsc&quot;</span>


<span class="k">def</span> <span class="nf">hcvcone</span><span class="p">(</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="s2">&quot;hcvsummary&quot;</span><span class="p">,</span> <span class="n">release</span><span class="o">=</span><span class="s2">&quot;v3&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;csv&quot;</span><span class="p">,</span> <span class="n">magtype</span><span class="o">=</span><span class="s2">&quot;magaper2&quot;</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="n">hscapiurl</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Do a cone search of the HSC catalog (including the HCV)</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ra (float): (degrees) J2000 Right Ascension</span>
<span class="sd">    dec (float): (degrees) J2000 Declination</span>
<span class="sd">    radius (float): (degrees) Search radius (&lt;= 0.5 degrees)</span>
<span class="sd">    table (string): hcvsummary, hcv, summary, detailed, propermotions, or sourcepositions</span>
<span class="sd">    release (string): v3 or v2</span>
<span class="sd">    magtype (string): magaper2 or magauto (only applies to summary table)</span>
<span class="sd">    format: csv, votable, json</span>
<span class="sd">    columns: list of column names to include (None means use defaults)</span>
<span class="sd">    baseurl: base URL for the request</span>
<span class="sd">    verbose: print info about request</span>
<span class="sd">    **kw: other parameters (e.g., &#39;numimages.gte&#39;:2)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">data</span> <span class="o">=</span> <span class="n">kw</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ra</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dec</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">radius</span>
    <span class="k">return</span> <span class="n">hcvsearch</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">,</span> <span class="n">release</span><span class="o">=</span><span class="n">release</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">,</span> <span class="n">magtype</span><span class="o">=</span><span class="n">magtype</span><span class="p">,</span>
                     <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="n">baseurl</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">hcvsearch</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="s2">&quot;hcvsummary&quot;</span><span class="p">,</span> <span class="n">release</span><span class="o">=</span><span class="s2">&quot;v3&quot;</span><span class="p">,</span> <span class="n">magtype</span><span class="o">=</span><span class="s2">&quot;magaper2&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;csv&quot;</span><span class="p">,</span>
              <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="n">hscapiurl</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Do a general search of the HSC catalog (possibly without ra/dec/radius)</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    table (string): hcvsummary, hcv, summary, detailed, propermotions, or sourcepositions</span>
<span class="sd">    release (string): v3 or v2</span>
<span class="sd">    magtype (string): magaper2 or magauto (only applies to summary table)</span>
<span class="sd">    format: csv, votable, json</span>
<span class="sd">    columns: list of column names to include (None means use defaults)</span>
<span class="sd">    baseurl: base URL for the request</span>
<span class="sd">    verbose: print info about request</span>
<span class="sd">    **kw: other parameters (e.g., &#39;numimages.gte&#39;:2).  Note this is required!</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">data</span> <span class="o">=</span> <span class="n">kw</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You must specify some parameters for search&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">format</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;csv&quot;</span><span class="p">,</span> <span class="s2">&quot;votable&quot;</span><span class="p">,</span> <span class="s2">&quot;json&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Bad value for format&quot;</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cat2url</span><span class="p">(</span><span class="n">table</span><span class="p">,</span><span class="w"> </span><span class="n">release</span><span class="p">,</span><span class="w"> </span><span class="n">magtype</span><span class="p">,</span><span class="w"> </span><span class="n">baseurl</span><span class="o">=</span><span class="n">baseurl</span><span class="p">)</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="nb">format</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="n">columns</span><span class="p">:</span>
        <span class="c1"># check that column values are legal</span>
        <span class="c1"># create a dictionary to speed this up</span>
        <span class="n">dcols</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">hcvmetadata</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">release</span><span class="p">,</span> <span class="n">magtype</span><span class="p">)[</span><span class="s1">&#39;name&#39;</span><span class="p">]:</span>
            <span class="n">dcols</span><span class="p">[</span><span class="n">col</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">badcols</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dcols</span><span class="p">:</span>
                <span class="n">badcols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">badcols</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Some columns not found in table: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">badcols</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># two different ways to specify a list of column values in the API</span>
        <span class="c1"># data[&#39;columns&#39;] = columns</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;columns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">]&quot;</span>

    <span class="c1"># either get or post works</span>
    <span class="c1"># r = requests.post(url, data=data)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">format</span> <span class="o">==</span> <span class="s2">&quot;json&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span>


<span class="k">def</span> <span class="nf">hcvmetadata</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="s2">&quot;hcvsummary&quot;</span><span class="p">,</span> <span class="n">release</span><span class="o">=</span><span class="s2">&quot;v3&quot;</span><span class="p">,</span> <span class="n">magtype</span><span class="o">=</span><span class="s2">&quot;magaper2&quot;</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="n">hscapiurl</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return metadata for the specified catalog and table</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    table (string): hcvsummary, hcv, summary, detailed, propermotions, or sourcepositions</span>
<span class="sd">    release (string): v3 or v2</span>
<span class="sd">    magtype (string): magaper2 or magauto (only applies to summary table)</span>
<span class="sd">    baseurl: base URL for the request</span>
<span class="sd">    </span>
<span class="sd">    Returns an astropy table with columns name, type, description</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cat2url</span><span class="p">(</span><span class="n">table</span><span class="p">,</span><span class="n">release</span><span class="p">,</span><span class="n">magtype</span><span class="p">,</span><span class="n">baseurl</span><span class="o">=</span><span class="n">baseurl</span><span class="p">)</span><span class="si">}</span><span class="s2">/metadata&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="c1"># convert to astropy table</span>
    <span class="n">tab</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="p">[(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">v</span><span class="p">],</span>
                <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">tab</span>


<span class="k">def</span> <span class="nf">cat2url</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="s2">&quot;hcvsummary&quot;</span><span class="p">,</span> <span class="n">release</span><span class="o">=</span><span class="s2">&quot;v3&quot;</span><span class="p">,</span> <span class="n">magtype</span><span class="o">=</span><span class="s2">&quot;magaper2&quot;</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="n">hscapiurl</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return URL for the specified catalog and table</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    table (string): hcvsummary, hcv, summary, detailed, propermotions, or sourcepositions</span>
<span class="sd">    release (string): v3 or v2</span>
<span class="sd">    magtype (string): magaper2 or magauto (only applies to summary table)</span>
<span class="sd">    baseurl: base URL for the request</span>
<span class="sd">    </span>
<span class="sd">    Returns a string with the base URL for this request</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">checklegal</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">release</span><span class="p">,</span> <span class="n">magtype</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">table</span> <span class="o">==</span> <span class="s2">&quot;summary&quot;</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">baseurl</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">release</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">magtype</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">baseurl</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">release</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="n">url</span>


<span class="k">def</span> <span class="nf">checklegal</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">release</span><span class="p">,</span> <span class="n">magtype</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if this combination of table, release and magtype is acceptable</span>
<span class="sd">    </span>
<span class="sd">    Raises a ValueError exception if there is problem</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">releaselist</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;v2&quot;</span><span class="p">,</span> <span class="s2">&quot;v3&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">release</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">releaselist</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bad value for release (must be one of </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">releaselist</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">release</span> <span class="o">==</span> <span class="s2">&quot;v2&quot;</span><span class="p">:</span>
        <span class="n">tablelist</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;summary&quot;</span><span class="p">,</span> <span class="s2">&quot;detailed&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tablelist</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;summary&quot;</span><span class="p">,</span> <span class="s2">&quot;detailed&quot;</span><span class="p">,</span> <span class="s2">&quot;propermotions&quot;</span><span class="p">,</span> <span class="s2">&quot;sourcepositions&quot;</span><span class="p">,</span> <span class="s2">&quot;hcvsummary&quot;</span><span class="p">,</span> <span class="s2">&quot;hcv&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">table</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tablelist</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bad value for table (for </span><span class="si">{</span><span class="n">release</span><span class="si">}</span><span class="s2"> must be one of </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tablelist</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">table</span> <span class="o">==</span> <span class="s2">&quot;summary&quot;</span><span class="p">:</span>
        <span class="n">magtypelist</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;magaper2&quot;</span><span class="p">,</span> <span class="s2">&quot;magauto&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">magtype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">magtypelist</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bad value for magtype (must be one of </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">magtypelist</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="variable-objects-near-ic-1613-a-name-ic1613-a">
<h2>Variable objects near IC 1613 <a name="ic1613"></a><a class="headerlink" href="#variable-objects-near-ic-1613-a-name-ic1613-a" title="Permalink to this heading">#</a></h2>
<section id="use-mast-name-resolver-to-get-position-of-ic-1613-a-name-resolver-a">
<h3>Use MAST name resolver to get position of IC 1613 <a name="resolver"></a><a class="headerlink" href="#use-mast-name-resolver-to-get-position-of-ic-1613-a-name-resolver-a" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target</span> <span class="o">=</span> <span class="s1">&#39;IC 1613&#39;</span>
<span class="n">coord_ic1613</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="o">.</span><span class="n">from_name</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>

<span class="n">ra_ic1613</span> <span class="o">=</span> <span class="n">coord_ic1613</span><span class="o">.</span><span class="n">ra</span><span class="o">.</span><span class="n">degree</span>
<span class="n">dec_ic1613</span> <span class="o">=</span> <span class="n">coord_ic1613</span><span class="o">.</span><span class="n">dec</span><span class="o">.</span><span class="n">degree</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ra: </span><span class="si">{</span><span class="n">ra_ic1613</span><span class="si">}</span><span class="se">\n</span><span class="s1">dec: </span><span class="si">{</span><span class="n">dec_ic1613</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ra: 16.22583
dec: 2.13333
</pre></div>
</div>
</div>
</div>
</section>
<section id="select-objects-near-ic-1613-from-hcv-a-name-summary-a">
<h3>Select objects near IC 1613 from HCV <a name="summary"></a><a class="headerlink" href="#select-objects-near-ic-1613-from-hcv-a-name-summary-a" title="Permalink to this heading">#</a></h3>
<p>This searches the HCV summary table for objects within 0.5 degrees of the galaxy center.  Note that this returns both variable and non-variable objects.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">radius</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="c1"># degrees</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">tab</span> <span class="o">=</span> <span class="n">ascii</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">hcvcone</span><span class="p">(</span><span class="n">ra_ic1613</span><span class="p">,</span> <span class="n">dec_ic1613</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="s2">&quot;hcvsummary&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Completed in </span><span class="si">{:.1f}</span><span class="s2"> sec&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">))</span>

<span class="c1"># clean up the output format</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MeanMag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MeanCorrMag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MAD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Chi2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;RA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.6f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Dec&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.6f}</span><span class="s2">&quot;</span>

<span class="c1"># show some of the variable sources</span>
<span class="n">tab</span><span class="p">[</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;AutoClass&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Completed in 4.9 sec
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=533</i>
<table id="table140471323544592" class="table-striped table-bordered table-condensed">
<thead><tr><th>MatchID</th><th>Filter</th><th>GroupID</th><th>SubGroupID</th><th>RA</th><th>Dec</th><th>AutoClass</th><th>ExpertClass</th><th>VarQualFlag</th><th>FilterDetFlag</th><th>NumLC</th><th>MeanMag</th><th>MeanCorrMag</th><th>MAD</th><th>Chi2</th></tr></thead>
<thead><tr><th>int64</th><th>str11</th><th>int64</th><th>int64</th><th>float64</th><th>float64</th><th>int64</th><th>int64</th><th>str5</th><th>int64</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>96457</td><td>ACS_F814W</td><td>69810</td><td>-5</td><td>16.141516</td><td>2.177815</td><td>2</td><td>1</td><td>AAAAC</td><td>1</td><td>12</td><td>22.946</td><td>22.947</td><td>0.0402</td><td>77.5733</td></tr>
<tr><td>813653</td><td>ACS_F814W</td><td>69810</td><td>-5</td><td>16.128353</td><td>2.160147</td><td>1</td><td>4</td><td>BACAB</td><td>1</td><td>11</td><td>24.906</td><td>24.908</td><td>0.0795</td><td>8.5797</td></tr>
<tr><td>1012692</td><td>ACS_F814W</td><td>69810</td><td>-5</td><td>16.134809</td><td>2.144720</td><td>2</td><td>1</td><td>AABAB</td><td>1</td><td>8</td><td>25.208</td><td>25.210</td><td>0.1152</td><td>6.6471</td></tr>
<tr><td>1085386</td><td>ACS_F814W</td><td>69810</td><td>-5</td><td>16.118544</td><td>2.160845</td><td>1</td><td>4</td><td>BABBB</td><td>1</td><td>11</td><td>23.476</td><td>23.476</td><td>0.0697</td><td>40.7630</td></tr>
<tr><td>1286857</td><td>ACS_F814W</td><td>69810</td><td>-5</td><td>16.119205</td><td>2.184252</td><td>1</td><td>2</td><td>AAAAC</td><td>0</td><td>12</td><td>21.073</td><td>21.075</td><td>0.0128</td><td>46.8982</td></tr>
<tr><td>1309271</td><td>ACS_F814W</td><td>69810</td><td>-5</td><td>16.130571</td><td>2.152512</td><td>2</td><td>1</td><td>AAAAC</td><td>1</td><td>12</td><td>25.043</td><td>25.044</td><td>0.0804</td><td>5.2954</td></tr>
<tr><td>1479646</td><td>ACS_F814W</td><td>69810</td><td>-5</td><td>16.120852</td><td>2.152737</td><td>1</td><td>2</td><td>AABAB</td><td>1</td><td>12</td><td>22.501</td><td>22.503</td><td>0.0362</td><td>68.2414</td></tr>
<tr><td>1661315</td><td>ACS_F814W</td><td>69810</td><td>-5</td><td>16.110571</td><td>2.143526</td><td>1</td><td>4</td><td>AAAAC</td><td>0</td><td>12</td><td>25.887</td><td>25.889</td><td>0.0595</td><td>0.8037</td></tr>
<tr><td>1674498</td><td>ACS_F814W</td><td>69810</td><td>-5</td><td>16.134724</td><td>2.147768</td><td>1</td><td>2</td><td>CAAAC</td><td>1</td><td>7</td><td>21.109</td><td>21.111</td><td>0.0350</td><td>84.3783</td></tr>
<tr><td>1826474</td><td>ACS_F814W</td><td>69810</td><td>-5</td><td>16.101532</td><td>2.171855</td><td>1</td><td>2</td><td>BACAB</td><td>1</td><td>11</td><td>24.889</td><td>24.890</td><td>0.0822</td><td>9.2131</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>107834538</td><td>ACS_F814W</td><td>69810</td><td>-5</td><td>16.107105</td><td>2.160084</td><td>1</td><td>1</td><td>AAAAC</td><td>0</td><td>12</td><td>25.128</td><td>25.129</td><td>0.0578</td><td>1.7916</td></tr>
<tr><td>108048053</td><td>ACS_F814W</td><td>69810</td><td>-5</td><td>16.150572</td><td>2.142590</td><td>1</td><td>2</td><td>AAAAC</td><td>0</td><td>11</td><td>24.544</td><td>24.546</td><td>0.0273</td><td>1.6361</td></tr>
<tr><td>103232694</td><td>ACS_F475W</td><td>69810</td><td>-5</td><td>16.107565</td><td>2.174399</td><td>1</td><td>4</td><td>AAAAC</td><td>0</td><td>11</td><td>22.422</td><td>22.422</td><td>0.0060</td><td>1.7118</td></tr>
<tr><td>104300195</td><td>ACS_F475W</td><td>69810</td><td>-5</td><td>16.124981</td><td>2.171772</td><td>2</td><td>1</td><td>AACAA</td><td>1</td><td>12</td><td>25.540</td><td>25.541</td><td>0.1054</td><td>58.7587</td></tr>
<tr><td>105173757</td><td>ACS_F814W</td><td>69810</td><td>-5</td><td>16.133703</td><td>2.184506</td><td>2</td><td>1</td><td>AACAA</td><td>1</td><td>12</td><td>22.240</td><td>22.242</td><td>0.1825</td><td>829.2399</td></tr>
<tr><td>106466795</td><td>ACS_F475W</td><td>69810</td><td>-5</td><td>16.127056</td><td>2.166390</td><td>1</td><td>1</td><td>AACAA</td><td>1</td><td>12</td><td>25.357</td><td>25.358</td><td>0.1425</td><td>13.4065</td></tr>
<tr><td>106640363</td><td>ACS_F475W</td><td>69810</td><td>-5</td><td>16.135796</td><td>2.149099</td><td>1</td><td>2</td><td>CACAA</td><td>1</td><td>8</td><td>25.577</td><td>25.579</td><td>0.1161</td><td>5.8168</td></tr>
<tr><td>106843213</td><td>ACS_F475W</td><td>69810</td><td>-5</td><td>16.110342</td><td>2.150373</td><td>1</td><td>4</td><td>CACCB</td><td>0</td><td>12</td><td>23.691</td><td>23.691</td><td>0.0269</td><td>30.7690</td></tr>
<tr><td>107834538</td><td>ACS_F475W</td><td>69810</td><td>-5</td><td>16.107105</td><td>2.160084</td><td>1</td><td>1</td><td>AABAC</td><td>1</td><td>12</td><td>25.400</td><td>25.401</td><td>0.0818</td><td>3.4254</td></tr>
<tr><td>108048053</td><td>ACS_F475W</td><td>69810</td><td>-5</td><td>16.150572</td><td>2.142590</td><td>1</td><td>2</td><td>AACCA</td><td>1</td><td>10</td><td>25.297</td><td>25.297</td><td>0.0697</td><td>22.9085</td></tr>
</table></div></div></div>
</div>
</section>
<section id="description-of-the-variable-classification-columns-a-name-classification-a">
<h3>Description of the variable classification columns <a name="classification"></a><a class="headerlink" href="#description-of-the-variable-classification-columns-a-name-classification-a" title="Permalink to this heading">#</a></h3>
<p>Several of the table columns have information on the variability.</p>
<ul class="simple">
<li><p>The columns <code class="docutils literal notranslate"><span class="pre">AutoClass</span></code> and <code class="docutils literal notranslate"><span class="pre">ExpertClass</span></code> have summary information on the variability for a given <code class="docutils literal notranslate"><span class="pre">MatchID</span></code> object.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">AutoClass</span></code>: Classification as provided by the system: 0=constant 1=single filter variable candidate (SFVC) 2=multi-filter variable candidate (MFVC)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ExpertClass</span></code>: Classification as provided by expert: 0=not classified by expert, 1=high confidence variable, 2=probable variable, 4=possible artifact</p></li>
</ul>
</li>
<li><p>The columns <code class="docutils literal notranslate"><span class="pre">MAD</span></code> and <code class="docutils literal notranslate"><span class="pre">Chi2</span></code> are variability indices using the median absolute deviation and the $\chi^2$ parameter for the given filter.</p></li>
<li><p>The column <code class="docutils literal notranslate"><span class="pre">VarQualFlag</span></code> is a variability quality flag (see Section 5 of the paper). The five letters correspond to CI, D, MagerrAper2, MagAper2-MagAuto, p2p; AAAAA corresponds to the highest quality flag.</p></li>
<li><p>The column <code class="docutils literal notranslate"><span class="pre">FilterDetFlag</span></code> is the filter detection flag: 1=source is variable in this filter, 0=source is not variable in this filter.</p></li>
</ul>
<p>See the HCV paper by <a class="reference external" href="https://www.aanda.org/component/article?access=doi&amp;doi=10.1051/0004-6361/201936026">Bonanos et al. (2019, AAp)</a> for more details on the computation and meaning of these quantities.</p>
</section>
<section id="find-objects-with-measurements-in-both-f475w-and-f814w">
<h3>Find objects with measurements in both F475W and F814W<a class="headerlink" href="#find-objects-with-measurements-in-both-f475w-and-f814w" title="Permalink to this heading">#</a></h3>
<p>This could be done in a SQL query through the CasJobs interface.  Here we use the <code class="docutils literal notranslate"><span class="pre">Astropy.table.join</span></code> function instead.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># the only key needed to do the join is MatchID, but we include other common columns</span>
<span class="c1"># so that join includes only one copy of them</span>
<span class="n">jtab</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Filter&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ACS_F475W&#39;</span><span class="p">],</span> <span class="n">tab</span><span class="p">[</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Filter&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ACS_F814W&#39;</span><span class="p">],</span>
            <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MatchID&#39;</span><span class="p">,</span> <span class="s1">&#39;GroupID&#39;</span><span class="p">,</span> <span class="s1">&#39;SubGroupID&#39;</span><span class="p">,</span> <span class="s1">&#39;RA&#39;</span><span class="p">,</span> <span class="s1">&#39;Dec&#39;</span><span class="p">,</span> <span class="s1">&#39;AutoClass&#39;</span><span class="p">,</span> <span class="s1">&#39;ExpertClass&#39;</span><span class="p">],</span>
            <span class="n">table_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;f475&#39;</span><span class="p">,</span> <span class="s1">&#39;f814&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">jtab</span><span class="p">),</span> <span class="s2">&quot;matched F475W+F814W objects&quot;</span><span class="p">)</span>
<span class="n">jtab</span><span class="p">[</span><span class="n">jtab</span><span class="p">[</span><span class="s1">&#39;AutoClass&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>17090 matched F475W+F814W objects
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=258</i>
<table id="table140471323543968" class="table-striped table-bordered table-condensed">
<thead><tr><th>MatchID</th><th>Filter_f475</th><th>GroupID</th><th>SubGroupID</th><th>RA</th><th>Dec</th><th>AutoClass</th><th>ExpertClass</th><th>VarQualFlag_f475</th><th>FilterDetFlag_f475</th><th>NumLC_f475</th><th>MeanMag_f475</th><th>MeanCorrMag_f475</th><th>MAD_f475</th><th>Chi2_f475</th><th>Filter_f814</th><th>VarQualFlag_f814</th><th>FilterDetFlag_f814</th><th>NumLC_f814</th><th>MeanMag_f814</th><th>MeanCorrMag_f814</th><th>MAD_f814</th><th>Chi2_f814</th></tr></thead>
<thead><tr><th>int64</th><th>str11</th><th>int64</th><th>int64</th><th>float64</th><th>float64</th><th>int64</th><th>int64</th><th>str5</th><th>int64</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>str11</th><th>str5</th><th>int64</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>96457</td><td>ACS_F475W</td><td>69810</td><td>-5</td><td>16.141516</td><td>2.177815</td><td>2</td><td>1</td><td>AACAA</td><td>1</td><td>12</td><td>23.192</td><td>23.192</td><td>0.0686</td><td>424.7097</td><td>ACS_F814W</td><td>AAAAC</td><td>1</td><td>12</td><td>22.946</td><td>22.947</td><td>0.0402</td><td>77.5733</td></tr>
<tr><td>813653</td><td>ACS_F475W</td><td>69810</td><td>-5</td><td>16.128353</td><td>2.160147</td><td>1</td><td>4</td><td>AAAAC</td><td>0</td><td>10</td><td>25.508</td><td>25.507</td><td>0.0243</td><td>0.2945</td><td>ACS_F814W</td><td>BACAB</td><td>1</td><td>11</td><td>24.906</td><td>24.908</td><td>0.0795</td><td>8.5797</td></tr>
<tr><td>1012692</td><td>ACS_F475W</td><td>69810</td><td>-5</td><td>16.134809</td><td>2.144720</td><td>2</td><td>1</td><td>AACAA</td><td>1</td><td>7</td><td>25.439</td><td>25.438</td><td>0.1446</td><td>17.9867</td><td>ACS_F814W</td><td>AABAB</td><td>1</td><td>8</td><td>25.208</td><td>25.210</td><td>0.1152</td><td>6.6471</td></tr>
<tr><td>1085386</td><td>ACS_F475W</td><td>69810</td><td>-5</td><td>16.118544</td><td>2.160845</td><td>1</td><td>4</td><td>AAAAC</td><td>0</td><td>11</td><td>24.351</td><td>24.352</td><td>0.0174</td><td>3.1311</td><td>ACS_F814W</td><td>BABBB</td><td>1</td><td>11</td><td>23.476</td><td>23.476</td><td>0.0697</td><td>40.7630</td></tr>
<tr><td>1286857</td><td>ACS_F475W</td><td>69810</td><td>-5</td><td>16.119205</td><td>2.184252</td><td>1</td><td>2</td><td>AABAB</td><td>1</td><td>12</td><td>23.137</td><td>23.138</td><td>0.0477</td><td>53.2282</td><td>ACS_F814W</td><td>AAAAC</td><td>0</td><td>12</td><td>21.073</td><td>21.075</td><td>0.0128</td><td>46.8982</td></tr>
<tr><td>1309271</td><td>ACS_F475W</td><td>69810</td><td>-5</td><td>16.130571</td><td>2.152512</td><td>2</td><td>1</td><td>AACAA</td><td>1</td><td>12</td><td>25.347</td><td>25.348</td><td>0.1399</td><td>20.0434</td><td>ACS_F814W</td><td>AAAAC</td><td>1</td><td>12</td><td>25.043</td><td>25.044</td><td>0.0804</td><td>5.2954</td></tr>
<tr><td>1479646</td><td>ACS_F475W</td><td>69810</td><td>-5</td><td>16.120852</td><td>2.152737</td><td>1</td><td>2</td><td>CACAA</td><td>0</td><td>12</td><td>23.691</td><td>23.692</td><td>0.0332</td><td>41.9525</td><td>ACS_F814W</td><td>AABAB</td><td>1</td><td>12</td><td>22.501</td><td>22.503</td><td>0.0362</td><td>68.2414</td></tr>
<tr><td>1661315</td><td>ACS_F475W</td><td>69810</td><td>-5</td><td>16.110571</td><td>2.143526</td><td>1</td><td>4</td><td>AACAB</td><td>1</td><td>12</td><td>25.220</td><td>25.221</td><td>0.0780</td><td>5.8648</td><td>ACS_F814W</td><td>AAAAC</td><td>0</td><td>12</td><td>25.887</td><td>25.889</td><td>0.0595</td><td>0.8037</td></tr>
<tr><td>1826474</td><td>ACS_F475W</td><td>69810</td><td>-5</td><td>16.101532</td><td>2.171855</td><td>1</td><td>2</td><td>AAAAC</td><td>0</td><td>11</td><td>25.735</td><td>25.737</td><td>0.0259</td><td>0.5195</td><td>ACS_F814W</td><td>BACAB</td><td>1</td><td>11</td><td>24.889</td><td>24.890</td><td>0.0822</td><td>9.2131</td></tr>
<tr><td>1849621</td><td>ACS_F475W</td><td>69810</td><td>-5</td><td>16.147049</td><td>2.153722</td><td>2</td><td>1</td><td>AACAA</td><td>1</td><td>11</td><td>25.501</td><td>25.502</td><td>0.2134</td><td>57.0725</td><td>ACS_F814W</td><td>AACAA</td><td>1</td><td>11</td><td>25.393</td><td>25.394</td><td>0.1483</td><td>18.3074</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>102132800</td><td>ACS_F475W</td><td>69810</td><td>-5</td><td>16.126160</td><td>2.145442</td><td>2</td><td>1</td><td>AACAA</td><td>1</td><td>12</td><td>23.691</td><td>23.692</td><td>0.0750</td><td>129.5717</td><td>ACS_F814W</td><td>AACBA</td><td>1</td><td>12</td><td>24.503</td><td>24.505</td><td>0.1038</td><td>27.1660</td></tr>
<tr><td>102239423</td><td>ACS_F475W</td><td>69810</td><td>-5</td><td>16.138706</td><td>2.155652</td><td>1</td><td>2</td><td>AABAA</td><td>1</td><td>12</td><td>22.810</td><td>22.811</td><td>0.0982</td><td>307.5226</td><td>ACS_F814W</td><td>AABAA</td><td>0</td><td>12</td><td>22.735</td><td>22.737</td><td>0.0382</td><td>96.9001</td></tr>
<tr><td>103232694</td><td>ACS_F475W</td><td>69810</td><td>-5</td><td>16.107565</td><td>2.174399</td><td>1</td><td>4</td><td>AAAAC</td><td>0</td><td>11</td><td>22.422</td><td>22.422</td><td>0.0060</td><td>1.7118</td><td>ACS_F814W</td><td>AAAAC</td><td>1</td><td>11</td><td>22.425</td><td>22.426</td><td>0.0335</td><td>27.9930</td></tr>
<tr><td>104300195</td><td>ACS_F475W</td><td>69810</td><td>-5</td><td>16.124981</td><td>2.171772</td><td>2</td><td>1</td><td>AACAA</td><td>1</td><td>12</td><td>25.540</td><td>25.541</td><td>0.1054</td><td>58.7587</td><td>ACS_F814W</td><td>AACAA</td><td>1</td><td>12</td><td>25.382</td><td>25.384</td><td>0.1217</td><td>9.4811</td></tr>
<tr><td>105173757</td><td>ACS_F475W</td><td>69810</td><td>-5</td><td>16.133703</td><td>2.184506</td><td>2</td><td>1</td><td>AAAAA</td><td>1</td><td>12</td><td>21.372</td><td>21.372</td><td>0.1589</td><td>2810.1572</td><td>ACS_F814W</td><td>AACAA</td><td>1</td><td>12</td><td>22.240</td><td>22.242</td><td>0.1825</td><td>829.2399</td></tr>
<tr><td>106466795</td><td>ACS_F475W</td><td>69810</td><td>-5</td><td>16.127056</td><td>2.166390</td><td>1</td><td>1</td><td>AACAA</td><td>1</td><td>12</td><td>25.357</td><td>25.358</td><td>0.1425</td><td>13.4065</td><td>ACS_F814W</td><td>AAAAC</td><td>0</td><td>12</td><td>25.257</td><td>25.259</td><td>0.0462</td><td>2.8032</td></tr>
<tr><td>106640363</td><td>ACS_F475W</td><td>69810</td><td>-5</td><td>16.135796</td><td>2.149099</td><td>1</td><td>2</td><td>CACAA</td><td>1</td><td>8</td><td>25.577</td><td>25.579</td><td>0.1161</td><td>5.8168</td><td>ACS_F814W</td><td>AABAB</td><td>0</td><td>9</td><td>24.944</td><td>24.946</td><td>0.0661</td><td>8.3312</td></tr>
<tr><td>106843213</td><td>ACS_F475W</td><td>69810</td><td>-5</td><td>16.110342</td><td>2.150373</td><td>1</td><td>4</td><td>CACCB</td><td>0</td><td>12</td><td>23.691</td><td>23.691</td><td>0.0269</td><td>30.7690</td><td>ACS_F814W</td><td>CACBA</td><td>1</td><td>12</td><td>24.429</td><td>24.431</td><td>0.0710</td><td>25.8158</td></tr>
<tr><td>107834538</td><td>ACS_F475W</td><td>69810</td><td>-5</td><td>16.107105</td><td>2.160084</td><td>1</td><td>1</td><td>AABAC</td><td>1</td><td>12</td><td>25.400</td><td>25.401</td><td>0.0818</td><td>3.4254</td><td>ACS_F814W</td><td>AAAAC</td><td>0</td><td>12</td><td>25.128</td><td>25.129</td><td>0.0578</td><td>1.7916</td></tr>
<tr><td>108048053</td><td>ACS_F475W</td><td>69810</td><td>-5</td><td>16.150572</td><td>2.142590</td><td>1</td><td>2</td><td>AACCA</td><td>1</td><td>10</td><td>25.297</td><td>25.297</td><td>0.0697</td><td>22.9085</td><td>ACS_F814W</td><td>AAAAC</td><td>0</td><td>11</td><td>24.544</td><td>24.546</td><td>0.0273</td><td>1.6361</td></tr>
</table></div></div></div>
</div>
</section>
<section id="plot-object-positions-on-the-sky-a-name-positions-a">
<h3>Plot object positions on the sky <a name="positions"></a><a class="headerlink" href="#plot-object-positions-on-the-sky-a-name-positions-a" title="Permalink to this heading">#</a></h3>
<p>We mark the galaxy center as well.  Note that this field is in the outskirts of IC 1613.  The 0.5 degree search radius (which is the maximum allowed in the API) allows finding these objects.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;RA&#39;</span><span class="p">,</span> <span class="s1">&#39;Dec&#39;</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tab</span><span class="p">)</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="s1"> HCV measurements&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">jtab</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ra_ic1613</span><span class="p">,</span> <span class="n">dec_ic1613</span><span class="p">,</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">target</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;RA [deg]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Dec [deg]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fc203fded10&gt;
</pre></div>
</div>
<img alt="../../../../_images/8b9219dcc961851970d406874e839c8fbbba8bf75bb57d0d0d84e80696f3aa1a.png" src="../../../../_images/8b9219dcc961851970d406874e839c8fbbba8bf75bb57d0d0d84e80696f3aa1a.png" />
</div>
</div>
</section>
<section id="plot-hcv-mad-variability-index-versus-magnitude-in-f475w-a-name-variability-a">
<h3>Plot HCV MAD variability index versus magnitude in F475W <a name="variability"></a><a class="headerlink" href="#plot-hcv-mad-variability-index-versus-magnitude-in-f475w-a-name-variability-a" title="Permalink to this heading">#</a></h3>
<p>The median absolute deviation variability index is used by the HCV to identify variables.  It measures the scatter among the multi-epoch measurements.  Some scatter is expected from noise (which increases for fainter objects).   Objects with MAD values that are high are likely to be variable.</p>
<p>This plots single-filter and multi-filter variable candidates (SFVC and MFVC) in different colors.  Note that variable objects with low F475W MAD values are variable in a different filter (typically F814W in this field).</p>
<p>This plot is similar to the upper panel of Figure 4 in <a class="reference external" href="https://www.aanda.org/component/article?access=doi&amp;doi=10.1051/0004-6361/201936026">Bonanos et al. (2019, AAp)</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define plot parameter lists</span>
<span class="n">auto_class</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">jtab</span><span class="p">[</span><span class="s1">&#39;AutoClass&#39;</span><span class="p">])</span>
<span class="n">markers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;silver&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;tab:cyan&#39;</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;non-&#39;</span><span class="p">,</span> <span class="s1">&#39;single-filter &#39;</span><span class="p">,</span> <span class="s1">&#39;multi-filter &#39;</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">ac</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">auto_class</span><span class="p">,</span> <span class="n">markers</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">jtab</span><span class="p">[</span><span class="n">jtab</span><span class="p">[</span><span class="s1">&#39;AutoClass&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">ac</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;MeanCorrMag_f475&#39;</span><span class="p">,</span> <span class="s1">&#39;MAD_f475&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">variable candidates&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;ACS_F475W [mag]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;ACS_F475W MAD [mag]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">jtab</span><span class="p">)</span><span class="si">}</span><span class="s1"> HSC measurements near </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fc207575180&gt;
</pre></div>
</div>
<img alt="../../../../_images/372c7f10df99caff641de7d3a112169f70d806c317f734a7d6dc712f34c69afc.png" src="../../../../_images/372c7f10df99caff641de7d3a112169f70d806c317f734a7d6dc712f34c69afc.png" />
</div>
</div>
</section>
<section id="plot-variables-in-color-magnitude-diagram-a-name-cmd-a">
<h3>Plot variables in color-magnitude diagram <a name="cmd"></a><a class="headerlink" href="#plot-variables-in-color-magnitude-diagram-a-name-cmd-a" title="Permalink to this heading">#</a></h3>
<p>Many of the candidate variables lie on the instability strip.</p>
<p>This plot is similar to the lower panel of Figure 4 in <a class="reference external" href="https://www.aanda.org/component/article?access=doi&amp;doi=10.1051/0004-6361/201936026">Bonanos et al. (2019, AAp)</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># add a new column to jtab</span>
<span class="n">jtab</span><span class="p">[</span><span class="s1">&#39;MCMf475-MCMf814&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">jtab</span><span class="p">[</span><span class="s1">&#39;MeanCorrMag_f475&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">jtab</span><span class="p">[</span><span class="s1">&#39;MeanCorrMag_f814&#39;</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="c1"># uses same plot parameters defined in the previous plot</span>
<span class="k">for</span> <span class="n">ac</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">auto_class</span><span class="p">,</span> <span class="n">markers</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">jtab</span><span class="p">[</span><span class="n">jtab</span><span class="p">[</span><span class="s1">&#39;AutoClass&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">ac</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;MCMf475-MCMf814&#39;</span><span class="p">,</span> <span class="s1">&#39;MeanCorrMag_f475&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">variable candidates&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
    
<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;ACS F475W - F814W [mag]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;ACS F475W [mag]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">jtab</span><span class="p">)</span><span class="si">}</span><span class="s1"> HSC measurements near </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fc2016bc970&gt;
</pre></div>
</div>
<img alt="../../../../_images/2d2da1f16f59ba7f30443f8a2c41b05e38c88d95b4f2c985e21e970a9f933441.png" src="../../../../_images/2d2da1f16f59ba7f30443f8a2c41b05e38c88d95b4f2c985e21e970a9f933441.png" />
</div>
</div>
</section>
</section>
<section id="get-a-light-curve-for-a-nova-in-m87-a-name-m87-a">
<h2>Get a light curve for a nova in M87 <a name="m87"></a><a class="headerlink" href="#get-a-light-curve-for-a-nova-in-m87-a-name-m87-a" title="Permalink to this heading">#</a></h2>
<section id="extract-light-curve-for-a-given-matchid-a-name-lightcurve-a">
<h3>Extract light curve for a given MatchID <a name="lightcurve"></a><a class="headerlink" href="#extract-light-curve-for-a-given-matchid-a-name-lightcurve-a" title="Permalink to this heading">#</a></h3>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">MatchID</span></code> could be determined by positional searches, filtering the catalog, etc.  This object comes from the top left panel of Figure 9 in <a class="reference external" href="https://www.aanda.org/component/article?access=doi&amp;doi=10.1051/0004-6361/201936026">Bonanos et al. (2019, AAp)</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">matchid</span> <span class="o">=</span> <span class="mi">1905457</span>

<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># get light curves for F606W and F814W</span>
<span class="n">nova_606</span> <span class="o">=</span> <span class="n">ascii</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">hcvsearch</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;hcv&#39;</span><span class="p">,</span> <span class="n">MatchID</span><span class="o">=</span><span class="n">matchid</span><span class="p">,</span> <span class="n">Filter</span><span class="o">=</span><span class="s1">&#39;ACS_F606W&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> sec: retrieved </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">nova_606</span><span class="p">)</span><span class="si">}</span><span class="s2"> F606W measurements&quot;</span><span class="p">)</span>

<span class="n">nova_814</span> <span class="o">=</span> <span class="n">ascii</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">hcvsearch</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;hcv&#39;</span><span class="p">,</span> <span class="n">MatchID</span><span class="o">=</span><span class="n">matchid</span><span class="p">,</span> <span class="n">Filter</span><span class="o">=</span><span class="s1">&#39;ACS_F814W&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> sec: retrieved </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">nova_814</span><span class="p">)</span><span class="si">}</span><span class="s2"> F814W measurements&quot;</span><span class="p">)</span>

<span class="c1"># get the object RA and Dec as well</span>
<span class="n">nova_tab</span> <span class="o">=</span> <span class="n">ascii</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">hcvsearch</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;hcvsummary&#39;</span><span class="p">,</span> <span class="n">MatchID</span><span class="o">=</span><span class="n">matchid</span><span class="p">,</span> <span class="n">Filter</span><span class="o">=</span><span class="s1">&#39;ACS_F814W&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> sec: retrieved object info&quot;</span><span class="p">)</span>

<span class="n">nova_606</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.4 sec: retrieved 21 F606W measurements
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7 sec: retrieved 22 F814W measurements
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9 sec: retrieved object info
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=21</i>
<table id="table140471224660320" class="table-striped table-bordered table-condensed">
<thead><tr><th>MatchID</th><th>Filter</th><th>MJD</th><th>ImageName</th><th>Mag</th><th>CorrMag</th><th>MagErr</th><th>CI</th><th>D</th></tr></thead>
<thead><tr><th>int64</th><th>str9</th><th>float64</th><th>str26</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>1905457</td><td>ACS_F606W</td><td>53767.4197952871</td><td>hst_10543_29_acs_wfc_f606w</td><td>25.327</td><td>25.3267132802993</td><td>0.1305</td><td>0.840648114681244</td><td>13.499119758606</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53768.4190663833</td><td>hst_10543_30_acs_wfc_f606w</td><td>23.9694</td><td>23.9676109802196</td><td>0.0394</td><td>1.04379630088806</td><td>11.9895544052124</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53769.3576541713</td><td>hst_10543_31_acs_wfc_f606w</td><td>23.6005</td><td>23.6000842124737</td><td>0.0306</td><td>0.974166631698608</td><td>9.30478286743164</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53771.1017052617</td><td>hst_10543_33_acs_wfc_f606w</td><td>23.6105</td><td>23.6157510517543</td><td>0.030300001</td><td>0.96657407283783</td><td>2.96933674812317</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53772.8098534283</td><td>hst_10543_35_acs_wfc_f606w</td><td>23.621799</td><td>23.602993885395</td><td>0.0328</td><td>0.992037057876587</td><td>4.45478820800781</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53774.4746564087</td><td>hst_10543_37_acs_wfc_f606w</td><td>24.015499</td><td>24.0123868023881</td><td>0.042599998</td><td>1.0246297121048</td><td>3.4874792098999</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53775.2799112014</td><td>hst_10543_38_acs_wfc_f606w</td><td>23.9037</td><td>23.9077547341058</td><td>0.0381</td><td>0.985185205936432</td><td>3.49740219116211</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53776.0893441574</td><td>hst_10543_39_acs_wfc_f606w</td><td>24.015499</td><td>24.0182108840315</td><td>0.0414</td><td>1.05314815044403</td><td>8.44466972351074</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53776.9439852673</td><td>hst_10543_40_acs_wfc_f606w</td><td>24.065701</td><td>24.0743889490328</td><td>0.044599999</td><td>1.24157404899597</td><td>7.6749701499939</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53778.562434162</td><td>hst_10543_42_acs_wfc_f606w</td><td>24.430799</td><td>24.4274937224049</td><td>0.059500001</td><td>1.07425928115845</td><td>3.26662158966064</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53779.4097260174</td><td>hst_10543_43_acs_wfc_f606w</td><td>24.415899</td><td>24.4150584573105</td><td>0.062600002</td><td>0.965277791023254</td><td>2.09669971466064</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53780.2090778507</td><td>hst_10543_44_acs_wfc_f606w</td><td>24.697599</td><td>24.6944838119623</td><td>0.080499999</td><td>0.810648143291473</td><td>6.5630521774292</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53782.61915897</td><td>hst_10543_47_acs_wfc_f606w</td><td>24.560801</td><td>24.5570748994592</td><td>0.065399997</td><td>1.09907412528992</td><td>2.88692712783813</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53784.2176541714</td><td>hst_10543_73_acs_wfc_f606w</td><td>24.7827</td><td>24.7770110702267</td><td>0.079000004</td><td>0.888148188591003</td><td>3.16040587425232</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53786.1563230369</td><td>hst_10543_86_acs_wfc_f606w</td><td>24.9091</td><td>24.8532684587691</td><td>0.0902</td><td>1.03777778148651</td><td>8.54914951324463</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53787.0225386124</td><td>hst_10543_92_acs_wfc_f606w</td><td>25.114599</td><td>25.0878230960564</td><td>0.1127</td><td>0.924444437026978</td><td>4.14372444152832</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53792.6850963715</td><td>hst_10543_49_acs_wfc_f606w</td><td>25.228001</td><td>25.231832236643</td><td>0.1147</td><td>1.14425933361053</td><td>11.9895496368408</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53793.5260915786</td><td>hst_10543_a1_acs_wfc_f606w</td><td>25.153601</td><td>25.1604359861786</td><td>0.1071</td><td>0.925648152828217</td><td>7.5528678894043</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53796.1486378878</td><td>hst_10543_b8_acs_wfc_f606w</td><td>24.0172</td><td>23.9985920051837</td><td>0.0436</td><td>1.51175928115845</td><td>10.1193161010742</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53798.5892174062</td><td>hst_10543_50_acs_wfc_f606w</td><td>25.563601</td><td>25.5708965234736</td><td>0.15350001</td><td>0.953240752220154</td><td>12.9010400772095</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53799.4608942058</td><td>hst_10543_c4_acs_wfc_f606w</td><td>25.5895</td><td>25.5908707417737</td><td>0.1602</td><td>0.92981481552124</td><td>5.97602415084839</td></tr>
</table></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;MJD&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;CorrMag&#39;</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="s1">&#39;MagErr&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;ob&#39;</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ACS F606W&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">nova_606</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;MJD&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;CorrMag&#39;</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="s1">&#39;MagErr&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;or&#39;</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ACS F814W&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">nova_814</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;MJD [days]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;magnitude&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Nova in M87 (MatchID: </span><span class="si">{</span><span class="n">matchid</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fc20174b580&gt;
</pre></div>
</div>
<img alt="../../../../_images/caa80f28b442a35a55a78c8b4b7d979d76f2ec7a6fa425bf01ed9a53e17b9e11.png" src="../../../../_images/caa80f28b442a35a55a78c8b4b7d979d76f2ec7a6fa425bf01ed9a53e17b9e11.png" />
</div>
</div>
</section>
<section id="get-hla-image-cutouts-for-the-nova-a-name-cutouts-a">
<h3>Get HLA image cutouts for the nova <a name="cutouts"></a><a class="headerlink" href="#get-hla-image-cutouts-for-the-nova-a-name-cutouts-a" title="Permalink to this heading">#</a></h3>
<p>The <a class="reference external" href="https://hla.stsci.edu">Hubble Legacy Archive (HLA)</a> images were the source of the measurements in the HSC and HCV, and it can be useful to look at the images.  Examination of the images can be useful to identified cosmic-ray contamination and other possible image artifacts.  In this case, no issues are seen, so the light curve is reliable.</p>
<p>Note that the ACS F606W images of M87 have only a single exposure, so they do have cosmic ray contamination.  The accompanying F814W images have multiple exposures, allowing CRs to be removed.  In this case the F814W combined image is used to find objects, while the F606W exposure is used only for photometry.  That reduces the effects of F606W CRs on the catalog but it is still a good idea to confirm the quality of the images.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">get_hla_cutout</span></code> function reads a single cutout image (as a JPEG grayscale image) and returns a PIL image object.  See the documentation on the <a class="reference external" href="http://hla.stsci.edu/fitscutcgi_interface.html">fitscut image cutout service</a> for more information on the web service being used.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_hla_cutout</span><span class="p">(</span><span class="n">imagename</span><span class="p">,</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">33</span><span class="p">,</span> <span class="n">autoscale</span><span class="o">=</span><span class="mf">99.5</span><span class="p">,</span> <span class="n">asinh</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get JPEG cutout for an image&quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://hla.stsci.edu/cgi-bin/fitscut.cgi&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="o">=</span><span class="n">dec</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
                                      <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;jpeg&quot;</span><span class="p">,</span> <span class="n">red</span><span class="o">=</span><span class="n">imagename</span><span class="p">,</span> <span class="n">autoscale</span><span class="o">=</span><span class="n">autoscale</span><span class="p">,</span> <span class="n">asinh</span><span class="o">=</span><span class="n">asinh</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="n">zoom</span><span class="p">))</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">im</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sort images by magnitude from brightest to faintest</span>
<span class="n">phot</span> <span class="o">=</span> <span class="n">nova_606</span>
<span class="n">isort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">phot</span><span class="p">[</span><span class="s1">&#39;CorrMag&#39;</span><span class="p">])</span>
<span class="c1"># select the brightest, median and faintest magnitudes</span>
<span class="n">ind</span> <span class="o">=</span> <span class="p">[</span><span class="n">isort</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">isort</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">isort</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span> <span class="n">isort</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>

<span class="c1"># we plot zoomed-in and zoomed-out views side-by-side for each selected image</span>
<span class="n">nim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># images per row</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="p">(</span><span class="n">nim</span><span class="o">+</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="n">ncols</span>

<span class="n">imsize1</span> <span class="o">=</span> <span class="mi">19</span>
<span class="n">imsize2</span> <span class="o">=</span> <span class="mi">101</span>
<span class="n">mra</span> <span class="o">=</span> <span class="n">nova_tab</span><span class="p">[</span><span class="s1">&#39;RA&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">mdec</span> <span class="o">=</span> <span class="n">nova_tab</span><span class="p">[</span><span class="s1">&#39;Dec&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># define figure and axes</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="o">/</span><span class="n">ncols</span><span class="p">)</span><span class="o">*</span><span class="n">nrows</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># iterate through each set of two subplots in axes</span>
<span class="k">for</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">),</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">ind</span><span class="p">):</span>
    
    <span class="c1"># get the images</span>
    <span class="n">im1</span> <span class="o">=</span> <span class="n">get_hla_cutout</span><span class="p">(</span><span class="n">phot</span><span class="p">[</span><span class="s1">&#39;ImageName&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">mra</span><span class="p">,</span> <span class="n">mdec</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">imsize1</span><span class="p">)</span>
    <span class="n">im2</span> <span class="o">=</span> <span class="n">get_hla_cutout</span><span class="p">(</span><span class="n">phot</span><span class="p">[</span><span class="s1">&#39;ImageName&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">mra</span><span class="p">,</span> <span class="n">mdec</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">imsize2</span><span class="p">)</span>
    
    <span class="c1"># plot left column   </span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im1</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">phot</span><span class="p">[</span><span class="s1">&#39;ImageName&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2"> m=</span><span class="si">{</span><span class="n">phot</span><span class="p">[</span><span class="s1">&#39;CorrMag&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    
    <span class="c1"># plot right column</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im2</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">xbox</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">imsize1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">imsize2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xbox</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">xbox</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">phot</span><span class="p">[</span><span class="s1">&#39;ImageName&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2"> m=</span><span class="si">{</span><span class="n">phot</span><span class="p">[</span><span class="s1">&#39;CorrMag&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>    
    
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> s: got </span><span class="si">{</span><span class="n">nrows</span><span class="o">*</span><span class="n">ncols</span><span class="si">}</span><span class="s2"> cutouts&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7.3 s: got 6 cutouts
</pre></div>
</div>
<img alt="../../../../_images/1df1613ca73329d2656f801ba72fdeaa5bb722124f0cf255f10dce4455a998f3.png" src="../../../../_images/1df1613ca73329d2656f801ba72fdeaa5bb722124f0cf255f10dce4455a998f3.png" />
</div>
</div>
</section>
</section>
<section id="compare-the-hcv-automatic-classification-to-expert-validations-a-name-expert-a">
<h2>Compare the HCV automatic classification to expert validations <a name="expert"></a><a class="headerlink" href="#compare-the-hcv-automatic-classification-to-expert-validations-a-name-expert-a" title="Permalink to this heading">#</a></h2>
<p>The HCV includes an automatic classification <code class="docutils literal notranslate"><span class="pre">AutoClass</span></code> for candidate variables as well as an expert validation for some fields that were selected for visual examination.  For this example, we select all the objects in the HCV that have expert classification information.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># get data for objects with an expert validation</span>
<span class="n">constraints</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ExpertClass.gte&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">tab</span> <span class="o">=</span> <span class="n">ascii</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">hcvsearch</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="s2">&quot;hcvsummary&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">constraints</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Retrieved </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tab</span><span class="p">)</span><span class="si">}</span><span class="s2"> rows in </span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> sec&quot;</span><span class="p">)</span>

<span class="c1"># clean up the output format</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MeanMag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MeanCorrMag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MAD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Chi2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;RA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.6f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Dec&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.6f}</span><span class="s2">&quot;</span>

<span class="c1"># tab includes 1 row for each filter (so multiple rows for objects with multiple filters)</span>
<span class="c1"># get an array that has only one row per object</span>
<span class="n">mval</span><span class="p">,</span> <span class="n">uindex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MatchID&#39;</span><span class="p">],</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">utab</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="n">uindex</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">utab</span><span class="p">)</span><span class="si">}</span><span class="s2"> unique MatchIDs in table&quot;</span><span class="p">)</span>

<span class="n">tab</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Retrieved 31258 rows in 2.0 sec
13533 unique MatchIDs in table
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=31258</i>
<table id="table140471293419936" class="table-striped table-bordered table-condensed">
<thead><tr><th>MatchID</th><th>Filter</th><th>GroupID</th><th>SubGroupID</th><th>RA</th><th>Dec</th><th>AutoClass</th><th>ExpertClass</th><th>VarQualFlag</th><th>FilterDetFlag</th><th>NumLC</th><th>MeanMag</th><th>MeanCorrMag</th><th>MAD</th><th>Chi2</th></tr></thead>
<thead><tr><th>int64</th><th>str11</th><th>int64</th><th>int64</th><th>float64</th><th>float64</th><th>int64</th><th>int64</th><th>str5</th><th>int64</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>875</td><td>ACS_F435W</td><td>1040153</td><td>-5</td><td>64.149673</td><td>-24.110353</td><td>2</td><td>2</td><td>AAAAA</td><td>0</td><td>13</td><td>24.166</td><td>24.166</td><td>0.0384</td><td>7.1169</td></tr>
<tr><td>875</td><td>ACS_F606W</td><td>1040153</td><td>-5</td><td>64.149673</td><td>-24.110353</td><td>2</td><td>2</td><td>AAAAC</td><td>0</td><td>9</td><td>22.836</td><td>22.835</td><td>0.0349</td><td>81.3676</td></tr>
<tr><td>875</td><td>ACS_F814W</td><td>1040153</td><td>-5</td><td>64.149673</td><td>-24.110353</td><td>2</td><td>2</td><td>AAAAA</td><td>0</td><td>23</td><td>22.156</td><td>22.156</td><td>0.0325</td><td>141.7171</td></tr>
<tr><td>875</td><td>WFC3_F105W</td><td>1040153</td><td>-5</td><td>64.149673</td><td>-24.110353</td><td>2</td><td>2</td><td>CAAAB</td><td>1</td><td>14</td><td>21.843</td><td>21.843</td><td>0.0503</td><td>223.4961</td></tr>
<tr><td>875</td><td>WFC3_F125W</td><td>1040153</td><td>-5</td><td>64.149673</td><td>-24.110353</td><td>2</td><td>2</td><td>CBCCA</td><td>1</td><td>6</td><td>21.813</td><td>21.814</td><td>0.0655</td><td>792.8662</td></tr>
<tr><td>875</td><td>WFC3_F140W</td><td>1040153</td><td>-5</td><td>64.149673</td><td>-24.110353</td><td>2</td><td>2</td><td>AAAAA</td><td>0</td><td>6</td><td>21.705</td><td>21.704</td><td>0.0205</td><td>127.6242</td></tr>
<tr><td>875</td><td>WFC3_F160W</td><td>1040153</td><td>-5</td><td>64.149673</td><td>-24.110353</td><td>2</td><td>2</td><td>BABAA</td><td>1</td><td>13</td><td>21.623</td><td>21.624</td><td>0.0322</td><td>112.8544</td></tr>
<tr><td>2006</td><td>WFPC2_F555W</td><td>521507</td><td>-5</td><td>268.112152</td><td>-17.684282</td><td>2</td><td>2</td><td>AAAAC</td><td>1</td><td>7</td><td>21.811</td><td>21.821</td><td>0.1545</td><td>85.2812</td></tr>
<tr><td>2006</td><td>WFPC2_F814W</td><td>521507</td><td>-5</td><td>268.112152</td><td>-17.684282</td><td>2</td><td>2</td><td>AAAAA</td><td>1</td><td>7</td><td>20.513</td><td>20.519</td><td>0.0988</td><td>105.2348</td></tr>
<tr><td>15830</td><td>ACS_F475W</td><td>1037453</td><td>-5</td><td>340.407806</td><td>-64.413185</td><td>1</td><td>1</td><td>AACAA</td><td>1</td><td>16</td><td>25.713</td><td>25.714</td><td>0.1582</td><td>20.3584</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>106335946</td><td>ACS_F814W</td><td>1045904</td><td>37</td><td>11.262936</td><td>41.668705</td><td>1</td><td>1</td><td>AAAAA</td><td>1</td><td>5</td><td>22.255</td><td>22.256</td><td>0.1372</td><td>422.6666</td></tr>
<tr><td>106343576</td><td>ACS_F606W</td><td>1042327</td><td>-5</td><td>143.725647</td><td>17.042946</td><td>2</td><td>1</td><td>AACAA</td><td>1</td><td>8</td><td>22.765</td><td>22.765</td><td>0.1420</td><td>2257.9950</td></tr>
<tr><td>106343576</td><td>ACS_F814W</td><td>1042327</td><td>-5</td><td>143.725647</td><td>17.042946</td><td>2</td><td>1</td><td>AAAAA</td><td>1</td><td>8</td><td>22.803</td><td>22.808</td><td>0.1327</td><td>214.2041</td></tr>
<tr><td>106346931</td><td>ACS_F814W</td><td>1033918</td><td>-5</td><td>267.603882</td><td>-37.147392</td><td>1</td><td>1</td><td>CBABA</td><td>1</td><td>6</td><td>19.903</td><td>19.905</td><td>0.0838</td><td>361.7145</td></tr>
<tr><td>106349395</td><td>WFC3_F606W</td><td>1024360</td><td>1</td><td>267.225891</td><td>-20.360847</td><td>2</td><td>2</td><td>CACAA</td><td>1</td><td>8</td><td>25.105</td><td>25.115</td><td>0.2310</td><td>20.3759</td></tr>
<tr><td>106349395</td><td>WFC3_F814W</td><td>1024360</td><td>1</td><td>267.225891</td><td>-20.360847</td><td>2</td><td>2</td><td>CACAA</td><td>1</td><td>8</td><td>23.418</td><td>23.421</td><td>0.1945</td><td>43.4230</td></tr>
<tr><td>106352519</td><td>WFC3_F125W</td><td>1043384</td><td>0</td><td>184.724442</td><td>47.335121</td><td>1</td><td>2</td><td>CABAA</td><td>0</td><td>7</td><td>23.323</td><td>23.326</td><td>0.2482</td><td>32.8326</td></tr>
<tr><td>106352519</td><td>WFC3_F160W</td><td>1043384</td><td>0</td><td>184.724442</td><td>47.335121</td><td>1</td><td>2</td><td>CACAA</td><td>1</td><td>7</td><td>23.057</td><td>23.056</td><td>0.4689</td><td>189.1727</td></tr>
<tr><td>106357454</td><td>WFC3_F110W</td><td>1053852</td><td>2</td><td>210.779648</td><td>54.284416</td><td>2</td><td>1</td><td>AAAAB</td><td>1</td><td>5</td><td>23.628</td><td>23.628</td><td>0.1821</td><td>92.0342</td></tr>
<tr><td>106357454</td><td>WFC3_F160W</td><td>1053852</td><td>2</td><td>210.779648</td><td>54.284416</td><td>2</td><td>1</td><td>AAAAB</td><td>1</td><td>5</td><td>23.118</td><td>23.118</td><td>0.1523</td><td>49.9244</td></tr>
</table></div></div></div>
</div>
<p>An <code class="docutils literal notranslate"><span class="pre">ExpertClass</span></code> value of 1 indicates that the object is confidently confirmed to be a variable; 2 means that the measurements do not have apparent problems and so the object is likely to be variable (usually the variability is too small to be obvious in the image); 4 means that the variability is likely to be the result of artifacts in the image (e.g., residual cosmic rays or diffraction spikes from nearby bright stars).</p>
<p>Compare the distributions for single-filter variable candidates (SFVC, <code class="docutils literal notranslate"><span class="pre">AutoClass</span></code>=1) and multi-filter variable candidates (MFVC, <code class="docutils literal notranslate"><span class="pre">AutoClass</span></code>=2).  The fraction of artifacts is lower in the MFVC sample.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sfcount</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">utab</span><span class="p">[</span><span class="s1">&#39;ExpertClass&#39;</span><span class="p">][</span><span class="n">utab</span><span class="p">[</span><span class="s1">&#39;AutoClass&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">mfcount</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">utab</span><span class="p">[</span><span class="s1">&#39;ExpertClass&#39;</span><span class="p">][</span><span class="n">utab</span><span class="p">[</span><span class="s1">&#39;AutoClass&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">sfrat</span> <span class="o">=</span> <span class="n">sfcount</span><span class="o">/</span><span class="n">sfcount</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">mfrat</span> <span class="o">=</span> <span class="n">mfcount</span><span class="o">/</span><span class="n">mfcount</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Type Variable Likely Artifact Total&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SFVC </span><span class="si">{:8d}</span><span class="s2"> </span><span class="si">{:6d}</span><span class="s2"> </span><span class="si">{:8d}</span><span class="s2"> </span><span class="si">{:5d}</span><span class="s2"> counts&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sfcount</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sfcount</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">sfcount</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">sfcount</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MFVC </span><span class="si">{:8d}</span><span class="s2"> </span><span class="si">{:6d}</span><span class="s2"> </span><span class="si">{:8d}</span><span class="s2"> </span><span class="si">{:5d}</span><span class="s2"> counts&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mfcount</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">mfcount</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">mfcount</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">mfcount</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SFVC </span><span class="si">{:8.3f}</span><span class="s2"> </span><span class="si">{:6.3f}</span><span class="s2"> </span><span class="si">{:8.3f}</span><span class="s2"> </span><span class="si">{:5.3f}</span><span class="s2"> fraction&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sfrat</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sfrat</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">sfrat</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">sfrat</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MFVC </span><span class="si">{:8.3f}</span><span class="s2"> </span><span class="si">{:6.3f}</span><span class="s2"> </span><span class="si">{:8.3f}</span><span class="s2"> </span><span class="si">{:5.3f}</span><span class="s2"> fraction&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mfrat</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">mfrat</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">mfrat</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">mfrat</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type Variable Likely Artifact Total
SFVC     3323   3055     1761  8139 counts
MFVC     2101   2442      851  5394 counts
SFVC    0.408  0.375    0.216 1.000 fraction
MFVC    0.390  0.453    0.158 1.000 fraction
</pre></div>
</div>
</div>
</div>
<section id="plot-the-mad-variability-index-distribution-with-expert-classifications-a-name-mad-expert-a">
<h3>Plot the MAD variability index distribution with expert classifications <a name="mad_expert"></a><a class="headerlink" href="#plot-the-mad-variability-index-distribution-with-expert-classifications-a-name-mad-expert-a" title="Permalink to this heading">#</a></h3>
<p>Note that only the filters identified as variable (<code class="docutils literal notranslate"><span class="pre">FilterDetFlag</span></code> &gt; 0) are included here.</p>
<p>This version of the plot shows the distributions for the various <code class="docutils literal notranslate"><span class="pre">ExpertClass</span></code> values along with, for comparison, the distribution for all objects in gray (which is identical in each panel).  Most objects are classified as confident or likely variables.  Objects with lower MAD values (indicating a lower amplitude of variability) are less likely to be identified as confident variables because low-level variability is more difficult to confirm via visual examination.</p>
<section id="data-bins">
<h4>Data &amp; Bins<a class="headerlink" href="#data-bins" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;FilterDetFlag&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">mad</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MAD&#39;</span><span class="p">][</span><span class="n">w</span><span class="p">]</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;ExpertClass&#39;</span><span class="p">][</span><span class="n">w</span><span class="p">]</span>

<span class="n">xrange</span> <span class="o">=</span> <span class="p">[</span><span class="mf">7.e-3</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">xrange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">xrange</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">xrange</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plots">
<h4>Plots<a class="headerlink" href="#plots" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Confident&#39;</span><span class="p">,</span> <span class="s1">&#39;Likely&#39;</span><span class="p">,</span> <span class="s1">&#39;Artifact&#39;</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C0&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">labels</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mad</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;All&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mad</span><span class="p">[</span><span class="n">e</span> <span class="o">==</span> <span class="n">v</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
    
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;HCV Expert Validation&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;MAD Variability Index [mag]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/acbe840456b6532c21aed2b07ef584baa34f6172da813762d57a86715634c84d.png" src="../../../../_images/acbe840456b6532c21aed2b07ef584baa34f6172da813762d57a86715634c84d.png" />
</div>
</div>
<p>The plot below shows the same distributions, but plotted as stacked histograms.  The top panel uses a linear scale on the y-axis and the bottom panel uses a log y scale.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="n">ylogs</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">ylog</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">ylogs</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mad</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="n">ylog</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Artifact&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mad</span><span class="p">[</span><span class="n">e</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="n">ylog</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Likely Variable&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mad</span><span class="p">[</span><span class="n">e</span> <span class="o">==</span> <span class="mi">1</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="n">ylog</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Confident Variable&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;MAD Variability Index [mag]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;HCV Expert Validation&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/ed667957814436f66780f91121af7ec1358cb3f8c327ee75ddca5b2e6605a4a8.png" src="../../../../_images/ed667957814436f66780f91121af7ec1358cb3f8c327ee75ddca5b2e6605a4a8.png" />
</div>
</div>
</section>
</section>
<section id="plot-the-fraction-of-artifacts-as-a-function-of-mad-variability-index-a-name-artifacts-a">
<h3>Plot the fraction of artifacts as a function of MAD variability index <a name="artifacts"></a><a class="headerlink" href="#plot-the-fraction-of-artifacts-as-a-function-of-mad-variability-index-a-name-artifacts-a" title="Permalink to this heading">#</a></h3>
<p>This shows how the fraction of artifacts varies with the MAD value.  For larger MAD values the fraction decreases sharply, presumably because such large values are less likely to result from the usual artifacts.  Interestingly, the artifact fraction also declines for smaller MAD values (MAD &lt; 0.1 mag).  Probably that happens because typical artifacts are more likely to produce strong signals than the weaker signals indicated by a low MAD value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;FilterDetFlag&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">mad</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MAD&#39;</span><span class="p">][</span><span class="n">w</span><span class="p">]</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;ExpertClass&#39;</span><span class="p">][</span><span class="n">w</span><span class="p">]</span>

<span class="n">xrange</span> <span class="o">=</span> <span class="p">[</span><span class="mf">7.e-3</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">xrange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">xrange</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">xrange</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="n">all_count</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">mad</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
<span class="n">artifact_count</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">mad</span><span class="p">[</span><span class="n">e</span> <span class="o">==</span> <span class="mi">4</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
<span class="n">wnz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">all_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">nnz</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wnz</span><span class="p">)</span>

<span class="n">artifact_count</span> <span class="o">=</span> <span class="n">artifact_count</span><span class="p">[</span><span class="n">wnz</span><span class="p">]</span>
<span class="n">all_count</span> <span class="o">=</span> <span class="n">all_count</span><span class="p">[</span><span class="n">wnz</span><span class="p">]</span>
<span class="n">xerr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">nnz</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">xerr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">bin_edges</span><span class="p">[</span><span class="n">wnz</span><span class="p">]</span>
<span class="n">xerr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">bin_edges</span><span class="p">[</span><span class="n">wnz</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># combine bins at edge into one big bin to improve the statistics there</span>
<span class="n">iz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">all_count</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="k">if</span> <span class="n">iz</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">all_count</span><span class="p">[</span><span class="n">iz</span><span class="p">]</span> <span class="o">+=</span> <span class="n">all_count</span><span class="p">[:</span><span class="n">iz</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">artifact_count</span><span class="p">[</span><span class="n">iz</span><span class="p">]</span> <span class="o">+=</span> <span class="n">artifact_count</span><span class="p">[:</span><span class="n">iz</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">xerr</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">iz</span><span class="p">]</span> <span class="o">=</span> <span class="n">xerr</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">all_count</span> <span class="o">=</span> <span class="n">all_count</span><span class="p">[</span><span class="n">iz</span><span class="p">:]</span>
    <span class="n">artifact_count</span> <span class="o">=</span> <span class="n">artifact_count</span><span class="p">[</span><span class="n">iz</span><span class="p">:]</span>
    <span class="n">xerr</span> <span class="o">=</span> <span class="n">xerr</span><span class="p">[:,</span> <span class="n">iz</span><span class="p">:]</span>
    
<span class="n">iz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">all_count</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">40</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="k">if</span> <span class="n">iz</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">all_count</span><span class="p">[</span><span class="o">-</span><span class="n">iz</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">all_count</span><span class="p">[</span><span class="o">-</span><span class="n">iz</span><span class="p">:]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">artifact_count</span><span class="p">[</span><span class="o">-</span><span class="n">iz</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">artifact_count</span><span class="p">[</span><span class="o">-</span><span class="n">iz</span><span class="p">:]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">xerr</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">iz</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">xerr</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">all_count</span> <span class="o">=</span> <span class="n">all_count</span><span class="p">[:</span><span class="o">-</span><span class="n">iz</span><span class="p">]</span>
    <span class="n">artifact_count</span> <span class="o">=</span> <span class="n">artifact_count</span><span class="p">[:</span><span class="o">-</span><span class="n">iz</span><span class="p">]</span>
    <span class="n">xerr</span> <span class="o">=</span> <span class="n">xerr</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="n">iz</span><span class="p">]</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">xerr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">xerr</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">xerr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">xerr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">xerr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">xerr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span>

<span class="n">frac</span> <span class="o">=</span> <span class="n">artifact_count</span><span class="o">/</span><span class="n">all_count</span>
<span class="c1"># error on fraction using binomial distribution (approximate)</span>
<span class="n">ferr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">frac</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">frac</span><span class="p">)</span><span class="o">/</span><span class="n">all_count</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Create the plot</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">frac</span><span class="p">,</span> <span class="n">xerr</span><span class="o">=</span><span class="n">xerr</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">ferr</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;ob&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Artifact fraction&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;MAD Variability Index [mag]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Artifact Fraction&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;HCV Expert Validation&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fc206c2c280&gt;
</pre></div>
</div>
<img alt="../../../../_images/f9bc134715255c3b0dfe658c1887df2ae44c2ddc9759fa4e0681a9974c52b223.png" src="../../../../_images/f9bc134715255c3b0dfe658c1887df2ae44c2ddc9759fa4e0681a9974c52b223.png" />
</div>
</div>
</section>
<section id="plot-light-curve-for-the-most-variable-high-quality-candidate-in-the-hcv-a-name-most-variable-a">
<h3>Plot light curve for the most variable high quality candidate in the HCV <a name="most_variable"></a><a class="headerlink" href="#plot-light-curve-for-the-most-variable-high-quality-candidate-in-the-hcv-a-name-most-variable-a" title="Permalink to this heading">#</a></h3>
<p>Select the candidate variable with the largest MAD value and <code class="docutils literal notranslate"><span class="pre">VarQualFlag</span></code> = ‘AAAAA’.  To find the highest MAD value, we sort by MAD in descending order and select the first result.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">constraints</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;VarQualFlag&#39;</span><span class="p">:</span> <span class="s1">&#39;AAAAA&#39;</span><span class="p">,</span> <span class="s1">&#39;sort_by&#39;</span><span class="p">:</span> <span class="s1">&#39;MAD.desc&#39;</span><span class="p">,</span> <span class="s1">&#39;pagesize&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>

<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">tab</span> <span class="o">=</span> <span class="n">ascii</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">hcvsearch</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;hcvsummary&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">constraints</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Completed in </span><span class="si">{:.1f}</span><span class="s2"> sec&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">))</span>

<span class="c1"># clean up the output format</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MeanMag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MeanCorrMag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MAD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Chi2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;RA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.6f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Dec&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.6f}</span><span class="s2">&quot;</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MatchID </span><span class="si">{}</span><span class="s2"> has largest MAD value = </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MatchID&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MAD&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">tab</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Completed in 1.6 sec
MatchID 5742711 has largest MAD value = 0.86
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=1</i>
<table id="table140471318528256" class="table-striped table-bordered table-condensed">
<thead><tr><th>MatchID</th><th>Filter</th><th>GroupID</th><th>SubGroupID</th><th>RA</th><th>Dec</th><th>AutoClass</th><th>ExpertClass</th><th>VarQualFlag</th><th>FilterDetFlag</th><th>NumLC</th><th>MeanMag</th><th>MeanCorrMag</th><th>MAD</th><th>Chi2</th></tr></thead>
<thead><tr><th>int64</th><th>str9</th><th>int64</th><th>int64</th><th>float64</th><th>float64</th><th>int64</th><th>int64</th><th>str5</th><th>int64</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>5742711</td><td>ACS_F814W</td><td>1045904</td><td>16</td><td>10.928601</td><td>41.164295</td><td>1</td><td>0</td><td>AAAAA</td><td>1</td><td>5</td><td>22.264</td><td>22.265</td><td>0.8581</td><td>6698.4430</td></tr>
</table></div></div></div>
</div>
<p>Get the light curve.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">matchid</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MatchID&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">mfilter</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Filter&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">lc</span> <span class="o">=</span> <span class="n">ascii</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">hcvsearch</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="s2">&quot;hcv&quot;</span><span class="p">,</span> <span class="n">MatchID</span><span class="o">=</span><span class="n">matchid</span><span class="p">,</span> <span class="n">Filter</span><span class="o">=</span><span class="n">mfilter</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> sec: retrieved </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lc</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">mfilter</span><span class="si">}</span><span class="s2"> measurements&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.2 sec: retrieved 5 ACS_F814W measurements
</pre></div>
</div>
</div>
</div>
<p>Plot the light curve.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;MJD&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;CorrMag&#39;</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="s1">&#39;MagErr&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;ob&#39;</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">mfilter</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">lc</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;MJD [days]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;magnitude&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;MatchID: </span><span class="si">{</span><span class="n">matchid</span><span class="si">}</span><span class="s2"> MAD=</span><span class="si">{</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MAD&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fc203958280&gt;
</pre></div>
</div>
<img alt="../../../../_images/0f7639ad3134cc82a1095439b75efca27c72bfdd6bdee93099e8873bccd98f37.png" src="../../../../_images/0f7639ad3134cc82a1095439b75efca27c72bfdd6bdee93099e8873bccd98f37.png" />
</div>
</div>
<p>Extract cutout images for the entire light curve (since it does not have many points).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sort images in MJD order</span>
<span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">lc</span><span class="p">[</span><span class="s1">&#39;MJD&#39;</span><span class="p">])</span>

<span class="c1"># we plot zoomed-in and zoomed-out views side-by-side for each selected image</span>
<span class="n">nim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># images per row</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="p">(</span><span class="n">nim</span><span class="o">+</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="n">ncols</span>

<span class="n">imsize1</span> <span class="o">=</span> <span class="mi">19</span>
<span class="n">imsize2</span> <span class="o">=</span> <span class="mi">101</span>
<span class="n">mra</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;RA&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">mdec</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Dec&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># define figure and axes</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="o">/</span><span class="n">ncols</span><span class="p">)</span><span class="o">*</span><span class="n">nrows</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># iterate through each set of two subplots in axes</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">((</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">),</span> <span class="n">k</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">ind</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span>
    
    <span class="c1"># get the images</span>
    <span class="n">im1</span> <span class="o">=</span> <span class="n">get_hla_cutout</span><span class="p">(</span><span class="n">lc</span><span class="p">[</span><span class="s1">&#39;ImageName&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">mra</span><span class="p">,</span> <span class="n">mdec</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">imsize1</span><span class="p">)</span>
    <span class="n">im2</span> <span class="o">=</span> <span class="n">get_hla_cutout</span><span class="p">(</span><span class="n">lc</span><span class="p">[</span><span class="s1">&#39;ImageName&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">mra</span><span class="p">,</span> <span class="n">mdec</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">imsize2</span><span class="p">)</span>
    
    <span class="c1"># plot left column    </span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im1</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">lc</span><span class="p">[</span><span class="s1">&#39;ImageName&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    
    <span class="c1"># plot right column</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im2</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">xbox</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">imsize1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">imsize2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xbox</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">xbox</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;m=</span><span class="si">{</span><span class="n">lc</span><span class="p">[</span><span class="s1">&#39;CorrMag&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> MJD=</span><span class="si">{</span><span class="n">lc</span><span class="p">[</span><span class="s1">&#39;MJD&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> s: finished </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span><span class="si">}</span><span class="s2"> epochs&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> s: got </span><span class="si">{</span><span class="n">nrows</span><span class="o">*</span><span class="n">ncols</span><span class="si">}</span><span class="s2"> cutouts&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.4 s: finished 1 of 5 epochs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.9 s: finished 2 of 5 epochs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7.3 s: finished 3 of 5 epochs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9.9 s: finished 4 of 5 epochs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12.5 s: finished 5 of 5 epochs
12.5 s: got 10 cutouts
</pre></div>
</div>
<img alt="../../../../_images/1d407b7a1a56d1d931c08934f48419259345f2be788e5d8199d53fe988273b28.png" src="../../../../_images/1d407b7a1a56d1d931c08934f48419259345f2be788e5d8199d53fe988273b28.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/MAST/HSC/HCV_API"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

            </article>
            

            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="../../astroquery/large_downloads/large_downloads.html" title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">Large Downloads in <code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code></p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="../HSCV3_API/hscv3_api.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">Hubble Source Catalog API Notebook</p>
  </div>
  <i class="fa-solid fa-angle-right"></i>
  </a>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Hubble Catalog of Variables Notebook (API version)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rick-white-steve-lubow-trenton-mckinney">
     2019 - 2022, Rick White, Steve Lubow, Trenton McKinney
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#instructions">
   Instructions
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#table-of-contents">
   Table of Contents
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#initialization-a-name-initialization-a">
   Initialization
   <a name="initialization">
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#install-python-modules">
     Install Python modules
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mast-api-functions">
     MAST API functions
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#variable-objects-near-ic-1613-a-name-ic1613-a">
     Variable objects near IC 1613
     <a name="ic1613">
     </a>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#use-mast-name-resolver-to-get-position-of-ic-1613-a-name-resolver-a">
       Use MAST name resolver to get position of IC 1613
       <a name="resolver">
       </a>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#select-objects-near-ic-1613-from-hcv-a-name-summary-a">
       Select objects near IC 1613 from HCV
       <a name="summary">
       </a>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#description-of-the-variable-classification-columns-a-name-classification-a">
       Description of the variable classification columns
       <a name="classification">
       </a>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#find-objects-with-measurements-in-both-f475w-and-f814w">
       Find objects with measurements in both F475W and F814W
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-object-positions-on-the-sky-a-name-positions-a">
       Plot object positions on the sky
       <a name="positions">
       </a>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-hcv-mad-variability-index-versus-magnitude-in-f475w-a-name-variability-a">
       Plot HCV MAD variability index versus magnitude in F475W
       <a name="variability">
       </a>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-variables-in-color-magnitude-diagram-a-name-cmd-a">
       Plot variables in color-magnitude diagram
       <a name="cmd">
       </a>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-a-light-curve-for-a-nova-in-m87-a-name-m87-a">
     Get a light curve for a nova in M87
     <a name="m87">
     </a>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#extract-light-curve-for-a-given-matchid-a-name-lightcurve-a">
       Extract light curve for a given MatchID
       <a name="lightcurve">
       </a>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#get-hla-image-cutouts-for-the-nova-a-name-cutouts-a">
       Get HLA image cutouts for the nova
       <a name="cutouts">
       </a>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compare-the-hcv-automatic-classification-to-expert-validations-a-name-expert-a">
     Compare the HCV automatic classification to expert validations
     <a name="expert">
     </a>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-the-mad-variability-index-distribution-with-expert-classifications-a-name-mad-expert-a">
       Plot the MAD variability index distribution with expert classifications
       <a name="mad_expert">
       </a>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#data-bins">
         Data &amp; Bins
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#plots">
         Plots
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-the-fraction-of-artifacts-as-a-function-of-mad-variability-index-a-name-artifacts-a">
       Plot the fraction of artifacts as a function of MAD variability index
       <a name="artifacts">
       </a>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-light-curve-for-the-most-variable-high-quality-candidate-in-the-hcv-a-name-most-variable-a">
       Plot light curve for the most variable high quality candidate in the HCV
       <a name="most_variable">
       </a>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

</nav>
</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By STScI
</p>

  </div>
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright 2022.<br>

</p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
Last updated on None.<br>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </div>
        </footer>
        

      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94"></script>
<script src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94"></script>

  </body>
</html>