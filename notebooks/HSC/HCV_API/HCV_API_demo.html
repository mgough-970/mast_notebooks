

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Hubble Catalog of Variables Notebook (API version) &#8212; MAST Notebook Repository</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/main.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/table.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-SK672ZMP7G"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-SK672ZMP7G');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/HSC/HCV_API/HCV_API_demo';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Hubble Source Catalog API Notebook" href="../HSCV3_API/hscv3_api.html" />
    <link rel="prev" title="Wildcard Handling with Astroquery.mast" href="../../astroquery/wildcard_searches/wildcard_searches.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/mastlogo.svg" class="logo__image only-light" alt="MAST Notebook Repository - Home"/>
    <script>document.write(`<img src="../../../_static/mastlogo.svg" class="logo__image only-dark" alt="MAST Notebook Repository - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    Welcome to the MAST Notebook Repository!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Astrocut</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../astrocut/making_tess_cubes_and_cutouts/making_tess_cubes_and_cutouts.html">Generating Cubes and Cutouts from TESS FFIs</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Astroquery</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../astroquery/intro.html">Intro</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../astroquery/nb.html">Notebooks</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../astroquery/beginner_search/beginner_search.html">Beginner: Searching MAST using astroquery.mast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../astroquery/beginner_zcut/beginner_zcut.html">Beginner: Zcut and Astroquery Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../astroquery/large_downloads/large_downloads.html">Large Downloads in <code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../astroquery/historic_quasar_observations/historic_quasar_observations.html">Historical Quasar Observations</a></li>





<li class="toctree-l2"><a class="reference internal" href="../../astroquery/wildcard_searches/wildcard_searches.html">Wildcard Handling with Astroquery.mast</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">HSC</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Hubble Catalog of Variables Notebook (API version)</a></li>



<li class="toctree-l1"><a class="reference internal" href="../HSCV3_API/hscv3_api.html">Hubble Source Catalog API Notebook</a></li>



<li class="toctree-l1"><a class="reference internal" href="../HSCV3_SMC_API/hscv3_smc_api.html">Hubble Source Catalog API Notebook: SMC Color-Magnitude Diagram</a></li>



<li class="toctree-l1"><a class="reference internal" href="../HSC_TAP/HSC_TAP.html">MAST Table Access Protocol Hubble Source Catalog Demo</a></li>

<li class="toctree-l1"><a class="reference internal" href="../SWEEPS_HSCV3P1/sweeps_hscv3p1.html">Hubble Source Catalog SWEEPS Proper Motion Notebook</a></li>






















</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">IUE</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../IUE/exploring_UV_extinction_curves/exploring_UV_extinction_curves.html">Exploring UV Extinction Curves</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">JWST</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../JWST/download_by_program_id/download_by_program_id.html">Accessing JWST Proposal Data in astroquery.mast</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../JWST/duplication_checking/duplication_checking.html">JWST Duplication Checking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../JWST/Engineering_Database_Retreival/EDB_Retrieval.html">JWST Engineering Data Retrieval</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../JWST/SI_keyword_exoplanet_search/SI_keyword_exoplanet_search.html">JWST SI Keyword Search for Exoplanet Spectra</a></li>




</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Kepler</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/beginner.html">Beginner Notebooks</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/plotting_lightcurves/plotting_lightcurves.html">Using Kepler Data to Plot a Light Curve</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/plotting_images_from_tpf/plotting_images_from_tpf.html">Plotting Images from Kepler Target Pixel Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/plotting_dvts/plotting_dvts.html">Read and Plot A Kepler Data Validation Timeseries File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/plotting_catalog_over_FFI/plotting_catalog_over_FFI.html">Plotting a Catalog over a Kepler Full Frame Image File</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/lightkurve.html">Lightkurve</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_analyzing_lc_products/lightkurve_analyzing_lc_products.html">Using <em>Kepler</em> Light Curve Products with Lightkurve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_analyzing_tpf_products/lightkurve_analyzing_tpf_products.html">Using <em>Kepler</em> Target Pixel File Products with Lightkurve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_searching_for_data/lightkurve_searching_for_data.html">Searching for <em>Kepler</em>/<em>K2</em> and <em>TESS</em> Data Products Using Lightkurve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_custom_aperture_photometry/lightkurve_custom_aperture_photometry.html">Creating Your Own Light Curves using Custom Aperture Photometry</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_combining_multiple_quarters/lightkurve_combining_multiple_quarters.html">Combining Multiple Quarters of <em>Kepler</em> Data with Lightkurve</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_interactively_inspecting_TPFs_and_LCs/lightkurve_interactively_inspecting_TPFs_and_LCs.html">Interactively Inspecting Target Pixel Files and Light Curves</a></li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/inst_noise.html">Instrumental Noise</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/instrumental_noise_1_data_gaps_and_quality_flags/instrumental_noise_1_data_gaps_and_quality_flags.html">Data Gaps and Quality Flags</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/instrumental_noise_2_spurious_signals_and_time_sampling_effects/instrumental_noise_2_spurious_signals_and_time_sampling_effects.html">Spurious Signals and Time Sampling Effects</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/instrumental_noise_3_seasonal_and_detector_effects/instrumental_noise_3_seasonal_and_detector_effects.html">Seasonal and Detector Effects</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/instrumental_noise_4_electronic_noise/instrumental_noise_4_electronic_noise.html">Electronic Noise</a></li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/signals.html">Identifying Periodic Signals</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/identifying_transiting_planet_signals/identifying_transiting_planet_signals.html">Identifying Transiting Planet Signals in a <em>Kepler</em> Light Curve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/measuring_a_rotation_period/measuring_a_rotation_period.html">Measuring and Removing a Rotation Period Signal from a <em>Kepler</em> Light Curve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/visualizing_periodic_signals_using_a_river_plot/visualizing_periodic_signals_using_a_river_plot.html">Visualizing Periodic Signals Using a River Plot</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/verifying_the_location_of_a_signal/verifying_the_location_of_a_signal.html">Verifying the Location of a Signal in <em>Kepler</em> Pixel Data</a></li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/periodograms.html">Periodograms &amp; Asteroseismology</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/creating_periodograms/creating_periodograms.html">Creating Periodograms</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/how_to_understand_and_manipulate_the_periodogram_of_an_oscillating_star/how_to_understand_and_manipulate_the_periodogram_of_an_oscillating_star.html">How to Understand and Manipulate the Periodogram of an Oscillating Star</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/how_to_estimate_a_stars_mass_and_radius_using_asteroseismology/how_to_estimate_a_stars_mass_and_radius_using_asteroseismology.html">How to Estimate a Star’s Mass and Radius Using Asteroseismology</a></li>

</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">K2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../K2/TPF/TPF.html">Beginner: Read and Display A K2 Target Pixel File</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../K2/beginner_how_to_use_ffi/beginner_how_to_use_ffi.html">Beginner: Read and Display a K2 Full Frame Image</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../K2/removing_instrumental_noise_using_pld/removing_instrumental_noise_using_pld.html">Removing Instrumental Noise from <em>K2</em> and <em>TESS</em> Light Curves Using Pixel Level Decorrelation (PLD)</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MCCM</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../MCCM/FIMS-SPEAR/hyperspectral_healpix_maps/hyperspectral_healpix_maps.html">Working with FIMS-SPEAR Hyperspectral HEALPix Maps</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PanSTARRS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../PanSTARRS/PS1_DR2_TAP/PS1_DR2_TAP.html">MAST Table Access Protocol PanSTARRS 1 DR2 Demo</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../PanSTARRS/PS1_image/PS1_image.html">Get Images from the PS1 Image Server</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">TESS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TESS/beginner.html">Beginner Notebooks</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_astroquery_dv/beginner_astroquery_dv.html">Retrieve TESS Data Validation Products with Astroquery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_how_to_use_dvt/beginner_how_to_use_dvt.html">Read and Plot A TESS Data Validation Timeseries File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_how_to_use_ffi/beginner_how_to_use_ffi.html">Read and Display a TESS Full Frame Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_how_to_use_lc/beginner_how_to_use_lc.html">Read and Plot A TESS Light Curve File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_how_to_use_tp/beginner_how_to_use_tp.html">Read and Display A TESS Target Pixel File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tess_exomast/beginner_tess_exomast.html">Exoplanet Data and TESS Light Curves Using Python Requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tess_tap_search/beginner_tess_tap_search.html">Download MAST TESS Light Curves Within an FFI Footprint Using TAP</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tic_search_hd209458/beginner_tic_search_hd209458.html">Search The TESS Input Catalog Centered On HD 209458.</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tour_lc_tp/beginner_tour_lc_tp.html">A Tour of the Contents of the TESS 2-minute Cadence Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tesscut_astroquery/beginner_tesscut_astroquery.html">Cutout of the TESS FFIs using Astrocut and Astroquery</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TESS/lc.html">Light Curves</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_gi_query/interm_gi_query.html">Intermediate:  Search and Download GI Program Light Curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_tasoc_lc/interm_tasoc_lc.html">Intermediate: Finding Flares and Variable Stars in TASOC Light Curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/asteroid_rotation/asteroid_rotation.html">Finding the Rotation Curve of an Asteroid or Comet with TESScut and Lightkurve</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TESS/FFIs.html">TESS FFIs</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_tesscut_dss_overlay/interm_tesscut_dss_overlay.html">Intermediate: Overlay a Cutout of the TESS FFIs with DSS imaging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_tesscut_requests/interm_tesscut_requests.html">Intermediate: Create TESS FFI Cutout using Python Requests</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TESS/noise.html">Instrumental Noise</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_tess_prf_retrieve/interm_tess_prf_retrieve.html">Intermediate: Retrieve TESS Pixel Response Function Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/removing_scattered_light_using_regression/removing_scattered_light_using_regression.html">Removing Scattered Light from <em>TESS</em> Data Using the Lightkurve <code class="docutils literal notranslate"><span class="pre">RegressionCorrector</span></code></a></li>

</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/spacetelescope/mast_notebooks/main?urlpath=tree/notebooks/HSC/HCV_API/HCV_API_demo.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/spacetelescope/mast_notebooks/blob/main/notebooks/HSC/HCV_API/HCV_API_demo.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/spacetelescope/mast_notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/spacetelescope/mast_notebooks/issues/new?title=Issue%20on%20page%20%2Fnotebooks/HSC/HCV_API/HCV_API_demo.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/notebooks/HSC/HCV_API/HCV_API_demo.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Hubble Catalog of Variables Notebook (API version)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Hubble Catalog of Variables Notebook (API version)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rick-white-steve-lubow-trenton-mckinney">2019 - 2022, Rick White, Steve Lubow, Trenton McKinney</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#instructions">Instructions</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#initialization-a-name-initialization-a">Initialization <a name="initialization"></a></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#install-python-modules">Install Python modules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mast-api-functions">MAST API functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variable-objects-near-ic-1613-a-name-ic1613-a">Variable objects near IC 1613 <a name="ic1613"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-mast-name-resolver-to-get-position-of-ic-1613-a-name-resolver-a">Use MAST name resolver to get position of IC 1613 <a name="resolver"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#select-objects-near-ic-1613-from-hcv-a-name-summary-a">Select objects near IC 1613 from HCV <a name="summary"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#description-of-the-variable-classification-columns-a-name-classification-a">Description of the variable classification columns <a name="classification"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#find-objects-with-measurements-in-both-f475w-and-f814w">Find objects with measurements in both F475W and F814W</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-object-positions-on-the-sky-a-name-positions-a">Plot object positions on the sky <a name="positions"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-hcv-mad-variability-index-versus-magnitude-in-f475w-a-name-variability-a">Plot HCV MAD variability index versus magnitude in F475W <a name="variability"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-variables-in-color-magnitude-diagram-a-name-cmd-a">Plot variables in color-magnitude diagram <a name="cmd"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-a-light-curve-for-a-nova-in-m87-a-name-m87-a">Get a light curve for a nova in M87 <a name="m87"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-light-curve-for-a-given-matchid-a-name-lightcurve-a">Extract light curve for a given MatchID <a name="lightcurve"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#get-hla-image-cutouts-for-the-nova-a-name-cutouts-a">Get HLA image cutouts for the nova <a name="cutouts"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-the-hcv-automatic-classification-to-expert-validations-a-name-expert-a">Compare the HCV automatic classification to expert validations <a name="expert"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-mad-variability-index-distribution-with-expert-classifications-a-name-mad-expert-a">Plot the MAD variability index distribution with expert classifications <a name="mad_expert"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-bins">Data &amp; Bins</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plots">Plots</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-fraction-of-artifacts-as-a-function-of-mad-variability-index-a-name-artifacts-a">Plot the fraction of artifacts as a function of MAD variability index <a name="artifacts"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-light-curve-for-the-most-variable-high-quality-candidate-in-the-hcv-a-name-most-variable-a">Plot light curve for the most variable high quality candidate in the HCV <a name="most_variable"></a></a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="hubble-catalog-of-variables-notebook-api-version">
<h1>Hubble Catalog of Variables Notebook (API version)<a class="headerlink" href="#hubble-catalog-of-variables-notebook-api-version" title="Permalink to this heading">#</a></h1>
<section id="rick-white-steve-lubow-trenton-mckinney">
<h2>2019 - 2022, Rick White, Steve Lubow, Trenton McKinney<a class="headerlink" href="#rick-white-steve-lubow-trenton-mckinney" title="Permalink to this heading">#</a></h2>
<p>This notebook shows how to access the <a class="reference external" href="http://archive.stsci.edu/hlsp/hcv/">Hubble Catalogs of Variables (HCV)</a>. The HCV is a large catalog of faint variable objects extracted from version 3 of the <a class="reference external" href="https://archive.stsci.edu/hst/hsc">Hubble Source Catalog</a>. The HCV project at the National Observatory of Athens was funded by the European Space Agency (PI: Alceste Bonanos). The data products for the HCV are available both at the <a class="reference external" href="http://archives.esac.esa.int/ehst">ESA Hubble Archive</a> at <a class="reference external" href="https://www.cosmos.esa.int/web/esdc">ESAC</a> through the <a class="reference external" href="http://archives.esac.esa.int/hcv-explorer">HCV Explorer</a> interface and at STScI.</p>
<p>This notebook uses the <a class="reference external" href="https://catalogs.mast.stsci.edu/hsc">MAST HSC catalog interface</a>, which supports queries to the current and previous versions of the <a class="reference external" href="https://archive.stsci.edu/hst/hsc">Hubble Source Catalog</a>. It allows searches of several different tables including the HCV summary and detailed tables. It also has an associated <a class="reference external" href="https://catalogs.mast.stsci.edu/docs/hsc.html">API</a> that is used for data access in this notebook.</p>
<p>For similar examples using the <a class="reference external" href="https://mastweb.stsci.edu/hcasjobs">MAST CasJobs</a> interface, a SQL database query interface that is more complex to use, but more powerful than the API, see <a class="reference internal" href="../HCV_CASJOBS/HCV_casjobs_demo.html"><span class="doc std std-doc">HCV_CasJobs</span></a>.</p>
</section>
</section>
<section id="instructions">
<h1>Instructions<a class="headerlink" href="#instructions" title="Permalink to this heading">#</a></h1>
<ul class="simple">
<li><p>Complete the initialization steps <span class="xref myst">described below</span>.</p></li>
<li><p>Run the initialization steps before running the rest of the notebook.</p></li>
<li><p>Modify and rerun any sections of the Table of Contents below.</p></li>
</ul>
</section>
<section id="table-of-contents">
<h1>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this heading">#</a></h1>
<ul class="simple">
<li><p><span class="xref myst">Intialization</span></p></li>
<li><p><span class="xref myst">Variable objects in IC 1613</span></p>
<ul>
<li><p><span class="xref myst">Name resolver</span></p></li>
<li><p><span class="xref myst">Select objects from HCV</span></p></li>
<li><p><span class="xref myst">Information on HCV variable classification</span></p></li>
<li><p><span class="xref myst">Sky coverage</span></p></li>
<li><p><span class="xref myst">Properties of variable objects</span></p></li>
<li><p><span class="xref myst">Color magnitude diagram</span></p></li>
</ul>
</li>
<li><p><span class="xref myst">Light curve for a nova in M87</span></p>
<ul>
<li><p><span class="xref myst">Extract and plot light curve for the nova</span></p></li>
<li><p><span class="xref myst">HLA cutout images for selected measurements</span></p></li>
</ul>
</li>
<li><p><span class="xref myst">Compare the HCV automatic classification to expert validations</span></p>
<ul>
<li><p><span class="xref myst">Plot MAD variability index distribution</span></p></li>
<li><p><span class="xref myst">Plot fraction of artifacts vs. MAD</span></p></li>
</ul>
</li>
<li><p><span class="xref myst">Plot light curve for most variable high-quality candidate in the HCV</span></p></li>
</ul>
</section>
<section id="initialization-a-name-initialization-a">
<h1>Initialization <a name="initialization"></a><a class="headerlink" href="#initialization-a-name-initialization-a" title="Permalink to this heading">#</a></h1>
<section id="install-python-modules">
<h2>Install Python modules<a class="headerlink" href="#install-python-modules" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><em>This notebook requires the use of <strong>Python 3</strong>.</em></p></li>
<li><p>Modules can be installed with <code class="docutils literal notranslate"><span class="pre">conda</span></code>, if using the <a class="reference external" href="http://archive.stsci.edu/hlsp/hcv/">Anaconda distribution</a> of python, or with <code class="docutils literal notranslate"><span class="pre">pip</span></code>.</p>
<ul class="simple">
<li><p>If you are using <code class="docutils literal notranslate"><span class="pre">conda</span></code>, do not install / update / remove a module with <code class="docutils literal notranslate"><span class="pre">pip</span></code>, that exists in a <code class="docutils literal notranslate"><span class="pre">conda</span></code> <a class="reference external" href="https://archive.stsci.edu/hst/hsc">channel</a>.</p></li>
<li><p>If a module is not available with <code class="docutils literal notranslate"><span class="pre">conda</span></code>, then it’s okay to install it with <code class="docutils literal notranslate"><span class="pre">pip</span></code></p></li>
</ul>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">astropy</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">SkyCoord</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>

<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">Table</span><span class="p">,</span> <span class="n">join</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">ascii</span>

<span class="c1"># set width for pprint</span>
<span class="n">astropy</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">max_width</span> <span class="o">=</span> <span class="mi">150</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set universal matplotlib parameters</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="mast-api-functions">
<h2>MAST API functions<a class="headerlink" href="#mast-api-functions" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Here we define several interrelated functions for retrieving information from the MAST API.</p>
<ul>
<li><p>The <code class="docutils literal notranslate"><span class="pre">hcvcone(ra,</span> <span class="pre">dec,</span> <span class="pre">radius</span> <span class="pre">[,</span> <span class="pre">keywords])</span></code> function searches the HCV catalog near a position.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">hcvsearch()</span></code> function performs general non-positional queries.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">hcvmetadata()</span></code> function gives information about the columns available in a table.</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hscapiurl</span> <span class="o">=</span> <span class="s2">&quot;https://catalogs.mast.stsci.edu/api/v0.1/hsc&quot;</span>


<span class="k">def</span> <span class="nf">hcvcone</span><span class="p">(</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="s2">&quot;hcvsummary&quot;</span><span class="p">,</span> <span class="n">release</span><span class="o">=</span><span class="s2">&quot;v3&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;csv&quot;</span><span class="p">,</span> <span class="n">magtype</span><span class="o">=</span><span class="s2">&quot;magaper2&quot;</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="n">hscapiurl</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Do a cone search of the HSC catalog (including the HCV)</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ra (float): (degrees) J2000 Right Ascension</span>
<span class="sd">    dec (float): (degrees) J2000 Declination</span>
<span class="sd">    radius (float): (degrees) Search radius (&lt;= 0.5 degrees)</span>
<span class="sd">    table (string): hcvsummary, hcv, summary, detailed, propermotions, or sourcepositions</span>
<span class="sd">    release (string): v3 or v2</span>
<span class="sd">    magtype (string): magaper2 or magauto (only applies to summary table)</span>
<span class="sd">    format: csv, votable, json</span>
<span class="sd">    columns: list of column names to include (None means use defaults)</span>
<span class="sd">    baseurl: base URL for the request</span>
<span class="sd">    verbose: print info about request</span>
<span class="sd">    **kw: other parameters (e.g., &#39;numimages.gte&#39;:2)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">data</span> <span class="o">=</span> <span class="n">kw</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ra</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dec</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">radius</span>
    <span class="k">return</span> <span class="n">hcvsearch</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">,</span> <span class="n">release</span><span class="o">=</span><span class="n">release</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">,</span> <span class="n">magtype</span><span class="o">=</span><span class="n">magtype</span><span class="p">,</span>
                     <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="n">baseurl</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">hcvsearch</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="s2">&quot;hcvsummary&quot;</span><span class="p">,</span> <span class="n">release</span><span class="o">=</span><span class="s2">&quot;v3&quot;</span><span class="p">,</span> <span class="n">magtype</span><span class="o">=</span><span class="s2">&quot;magaper2&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;csv&quot;</span><span class="p">,</span>
              <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="n">hscapiurl</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Do a general search of the HSC catalog (possibly without ra/dec/radius)</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    table (string): hcvsummary, hcv, summary, detailed, propermotions, or sourcepositions</span>
<span class="sd">    release (string): v3 or v2</span>
<span class="sd">    magtype (string): magaper2 or magauto (only applies to summary table)</span>
<span class="sd">    format: csv, votable, json</span>
<span class="sd">    columns: list of column names to include (None means use defaults)</span>
<span class="sd">    baseurl: base URL for the request</span>
<span class="sd">    verbose: print info about request</span>
<span class="sd">    **kw: other parameters (e.g., &#39;numimages.gte&#39;:2).  Note this is required!</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">data</span> <span class="o">=</span> <span class="n">kw</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You must specify some parameters for search&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">format</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;csv&quot;</span><span class="p">,</span> <span class="s2">&quot;votable&quot;</span><span class="p">,</span> <span class="s2">&quot;json&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Bad value for format&quot;</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cat2url</span><span class="p">(</span><span class="n">table</span><span class="p">,</span><span class="w"> </span><span class="n">release</span><span class="p">,</span><span class="w"> </span><span class="n">magtype</span><span class="p">,</span><span class="w"> </span><span class="n">baseurl</span><span class="o">=</span><span class="n">baseurl</span><span class="p">)</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="nb">format</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="n">columns</span><span class="p">:</span>
        <span class="c1"># check that column values are legal</span>
        <span class="c1"># create a dictionary to speed this up</span>
        <span class="n">dcols</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">hcvmetadata</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">release</span><span class="p">,</span> <span class="n">magtype</span><span class="p">)[</span><span class="s1">&#39;name&#39;</span><span class="p">]:</span>
            <span class="n">dcols</span><span class="p">[</span><span class="n">col</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">badcols</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dcols</span><span class="p">:</span>
                <span class="n">badcols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">badcols</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Some columns not found in table: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">badcols</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># two different ways to specify a list of column values in the API</span>
        <span class="c1"># data[&#39;columns&#39;] = columns</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;columns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">]&quot;</span>

    <span class="c1"># either get or post works</span>
    <span class="c1"># r = requests.post(url, data=data)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">format</span> <span class="o">==</span> <span class="s2">&quot;json&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span>


<span class="k">def</span> <span class="nf">hcvmetadata</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="s2">&quot;hcvsummary&quot;</span><span class="p">,</span> <span class="n">release</span><span class="o">=</span><span class="s2">&quot;v3&quot;</span><span class="p">,</span> <span class="n">magtype</span><span class="o">=</span><span class="s2">&quot;magaper2&quot;</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="n">hscapiurl</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return metadata for the specified catalog and table</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    table (string): hcvsummary, hcv, summary, detailed, propermotions, or sourcepositions</span>
<span class="sd">    release (string): v3 or v2</span>
<span class="sd">    magtype (string): magaper2 or magauto (only applies to summary table)</span>
<span class="sd">    baseurl: base URL for the request</span>
<span class="sd">    </span>
<span class="sd">    Returns an astropy table with columns name, type, description</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cat2url</span><span class="p">(</span><span class="n">table</span><span class="p">,</span><span class="n">release</span><span class="p">,</span><span class="n">magtype</span><span class="p">,</span><span class="n">baseurl</span><span class="o">=</span><span class="n">baseurl</span><span class="p">)</span><span class="si">}</span><span class="s2">/metadata&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="c1"># convert to astropy table</span>
    <span class="n">tab</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="p">[(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">v</span><span class="p">],</span>
                <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">tab</span>


<span class="k">def</span> <span class="nf">cat2url</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="s2">&quot;hcvsummary&quot;</span><span class="p">,</span> <span class="n">release</span><span class="o">=</span><span class="s2">&quot;v3&quot;</span><span class="p">,</span> <span class="n">magtype</span><span class="o">=</span><span class="s2">&quot;magaper2&quot;</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="n">hscapiurl</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return URL for the specified catalog and table</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    table (string): hcvsummary, hcv, summary, detailed, propermotions, or sourcepositions</span>
<span class="sd">    release (string): v3 or v2</span>
<span class="sd">    magtype (string): magaper2 or magauto (only applies to summary table)</span>
<span class="sd">    baseurl: base URL for the request</span>
<span class="sd">    </span>
<span class="sd">    Returns a string with the base URL for this request</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">checklegal</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">release</span><span class="p">,</span> <span class="n">magtype</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">table</span> <span class="o">==</span> <span class="s2">&quot;summary&quot;</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">baseurl</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">release</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">magtype</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">baseurl</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">release</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="n">url</span>


<span class="k">def</span> <span class="nf">checklegal</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">release</span><span class="p">,</span> <span class="n">magtype</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if this combination of table, release and magtype is acceptable</span>
<span class="sd">    </span>
<span class="sd">    Raises a ValueError exception if there is problem</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">releaselist</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;v2&quot;</span><span class="p">,</span> <span class="s2">&quot;v3&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">release</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">releaselist</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bad value for release (must be one of </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">releaselist</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">release</span> <span class="o">==</span> <span class="s2">&quot;v2&quot;</span><span class="p">:</span>
        <span class="n">tablelist</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;summary&quot;</span><span class="p">,</span> <span class="s2">&quot;detailed&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tablelist</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;summary&quot;</span><span class="p">,</span> <span class="s2">&quot;detailed&quot;</span><span class="p">,</span> <span class="s2">&quot;propermotions&quot;</span><span class="p">,</span> <span class="s2">&quot;sourcepositions&quot;</span><span class="p">,</span> <span class="s2">&quot;hcvsummary&quot;</span><span class="p">,</span> <span class="s2">&quot;hcv&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">table</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tablelist</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bad value for table (for </span><span class="si">{</span><span class="n">release</span><span class="si">}</span><span class="s2"> must be one of </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tablelist</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">table</span> <span class="o">==</span> <span class="s2">&quot;summary&quot;</span><span class="p">:</span>
        <span class="n">magtypelist</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;magaper2&quot;</span><span class="p">,</span> <span class="s2">&quot;magauto&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">magtype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">magtypelist</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bad value for magtype (must be one of </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">magtypelist</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="variable-objects-near-ic-1613-a-name-ic1613-a">
<h2>Variable objects near IC 1613 <a name="ic1613"></a><a class="headerlink" href="#variable-objects-near-ic-1613-a-name-ic1613-a" title="Permalink to this heading">#</a></h2>
<section id="use-mast-name-resolver-to-get-position-of-ic-1613-a-name-resolver-a">
<h3>Use MAST name resolver to get position of IC 1613 <a name="resolver"></a><a class="headerlink" href="#use-mast-name-resolver-to-get-position-of-ic-1613-a-name-resolver-a" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target</span> <span class="o">=</span> <span class="s1">&#39;IC 1613&#39;</span>
<span class="n">coord_ic1613</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="o">.</span><span class="n">from_name</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>

<span class="n">ra_ic1613</span> <span class="o">=</span> <span class="n">coord_ic1613</span><span class="o">.</span><span class="n">ra</span><span class="o">.</span><span class="n">degree</span>
<span class="n">dec_ic1613</span> <span class="o">=</span> <span class="n">coord_ic1613</span><span class="o">.</span><span class="n">dec</span><span class="o">.</span><span class="n">degree</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ra: </span><span class="si">{</span><span class="n">ra_ic1613</span><span class="si">}</span><span class="se">\n</span><span class="s1">dec: </span><span class="si">{</span><span class="n">dec_ic1613</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="select-objects-near-ic-1613-from-hcv-a-name-summary-a">
<h3>Select objects near IC 1613 from HCV <a name="summary"></a><a class="headerlink" href="#select-objects-near-ic-1613-from-hcv-a-name-summary-a" title="Permalink to this heading">#</a></h3>
<p>This searches the HCV summary table for objects within 0.5 degrees of the galaxy center.  Note that this returns both variable and non-variable objects.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">radius</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="c1"># degrees</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">tab</span> <span class="o">=</span> <span class="n">ascii</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">hcvcone</span><span class="p">(</span><span class="n">ra_ic1613</span><span class="p">,</span> <span class="n">dec_ic1613</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="s2">&quot;hcvsummary&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Completed in </span><span class="si">{:.1f}</span><span class="s2"> sec&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">))</span>

<span class="c1"># clean up the output format</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MeanMag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MeanCorrMag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MAD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Chi2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;RA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.6f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Dec&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.6f}</span><span class="s2">&quot;</span>

<span class="c1"># show some of the variable sources</span>
<span class="n">tab</span><span class="p">[</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;AutoClass&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="description-of-the-variable-classification-columns-a-name-classification-a">
<h3>Description of the variable classification columns <a name="classification"></a><a class="headerlink" href="#description-of-the-variable-classification-columns-a-name-classification-a" title="Permalink to this heading">#</a></h3>
<p>Several of the table columns have information on the variability.</p>
<ul class="simple">
<li><p>The columns <code class="docutils literal notranslate"><span class="pre">AutoClass</span></code> and <code class="docutils literal notranslate"><span class="pre">ExpertClass</span></code> have summary information on the variability for a given <code class="docutils literal notranslate"><span class="pre">MatchID</span></code> object.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">AutoClass</span></code>: Classification as provided by the system: 0=constant 1=single filter variable candidate (SFVC) 2=multi-filter variable candidate (MFVC)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ExpertClass</span></code>: Classification as provided by expert: 0=not classified by expert, 1=high confidence variable, 2=probable variable, 4=possible artifact</p></li>
</ul>
</li>
<li><p>The columns <code class="docutils literal notranslate"><span class="pre">MAD</span></code> and <code class="docutils literal notranslate"><span class="pre">Chi2</span></code> are variability indices using the median absolute deviation and the $\chi^2$ parameter for the given filter.</p></li>
<li><p>The column <code class="docutils literal notranslate"><span class="pre">VarQualFlag</span></code> is a variability quality flag (see Section 5 of the paper). The five letters correspond to CI, D, MagerrAper2, MagAper2-MagAuto, p2p; AAAAA corresponds to the highest quality flag.</p></li>
<li><p>The column <code class="docutils literal notranslate"><span class="pre">FilterDetFlag</span></code> is the filter detection flag: 1=source is variable in this filter, 0=source is not variable in this filter.</p></li>
</ul>
<p>See the HCV paper by <a class="reference external" href="https://www.aanda.org/component/article?access=doi&amp;doi=10.1051/0004-6361/201936026">Bonanos et al. (2019, AAp)</a> for more details on the computation and meaning of these quantities.</p>
</section>
<section id="find-objects-with-measurements-in-both-f475w-and-f814w">
<h3>Find objects with measurements in both F475W and F814W<a class="headerlink" href="#find-objects-with-measurements-in-both-f475w-and-f814w" title="Permalink to this heading">#</a></h3>
<p>This could be done in a SQL query through the CasJobs interface.  Here we use the <code class="docutils literal notranslate"><span class="pre">Astropy.table.join</span></code> function instead.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># the only key needed to do the join is MatchID, but we include other common columns</span>
<span class="c1"># so that join includes only one copy of them</span>
<span class="n">jtab</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Filter&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ACS_F475W&#39;</span><span class="p">],</span> <span class="n">tab</span><span class="p">[</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Filter&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ACS_F814W&#39;</span><span class="p">],</span>
            <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MatchID&#39;</span><span class="p">,</span> <span class="s1">&#39;GroupID&#39;</span><span class="p">,</span> <span class="s1">&#39;SubGroupID&#39;</span><span class="p">,</span> <span class="s1">&#39;RA&#39;</span><span class="p">,</span> <span class="s1">&#39;Dec&#39;</span><span class="p">,</span> <span class="s1">&#39;AutoClass&#39;</span><span class="p">,</span> <span class="s1">&#39;ExpertClass&#39;</span><span class="p">],</span>
            <span class="n">table_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;f475&#39;</span><span class="p">,</span> <span class="s1">&#39;f814&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">jtab</span><span class="p">),</span> <span class="s2">&quot;matched F475W+F814W objects&quot;</span><span class="p">)</span>
<span class="n">jtab</span><span class="p">[</span><span class="n">jtab</span><span class="p">[</span><span class="s1">&#39;AutoClass&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-object-positions-on-the-sky-a-name-positions-a">
<h3>Plot object positions on the sky <a name="positions"></a><a class="headerlink" href="#plot-object-positions-on-the-sky-a-name-positions-a" title="Permalink to this heading">#</a></h3>
<p>We mark the galaxy center as well.  Note that this field is in the outskirts of IC 1613.  The 0.5 degree search radius (which is the maximum allowed in the API) allows finding these objects.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;RA&#39;</span><span class="p">,</span> <span class="s1">&#39;Dec&#39;</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tab</span><span class="p">)</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="s1"> HCV measurements&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">jtab</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ra_ic1613</span><span class="p">,</span> <span class="n">dec_ic1613</span><span class="p">,</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">target</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;RA [deg]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Dec [deg]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-hcv-mad-variability-index-versus-magnitude-in-f475w-a-name-variability-a">
<h3>Plot HCV MAD variability index versus magnitude in F475W <a name="variability"></a><a class="headerlink" href="#plot-hcv-mad-variability-index-versus-magnitude-in-f475w-a-name-variability-a" title="Permalink to this heading">#</a></h3>
<p>The median absolute deviation variability index is used by the HCV to identify variables.  It measures the scatter among the multi-epoch measurements.  Some scatter is expected from noise (which increases for fainter objects).   Objects with MAD values that are high are likely to be variable.</p>
<p>This plots single-filter and multi-filter variable candidates (SFVC and MFVC) in different colors.  Note that variable objects with low F475W MAD values are variable in a different filter (typically F814W in this field).</p>
<p>This plot is similar to the upper panel of Figure 4 in <a class="reference external" href="https://www.aanda.org/component/article?access=doi&amp;doi=10.1051/0004-6361/201936026">Bonanos et al. (2019, AAp)</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define plot parameter lists</span>
<span class="n">auto_class</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">jtab</span><span class="p">[</span><span class="s1">&#39;AutoClass&#39;</span><span class="p">])</span>
<span class="n">markers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;silver&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;tab:cyan&#39;</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;non-&#39;</span><span class="p">,</span> <span class="s1">&#39;single-filter &#39;</span><span class="p">,</span> <span class="s1">&#39;multi-filter &#39;</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">ac</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">auto_class</span><span class="p">,</span> <span class="n">markers</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">jtab</span><span class="p">[</span><span class="n">jtab</span><span class="p">[</span><span class="s1">&#39;AutoClass&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">ac</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;MeanCorrMag_f475&#39;</span><span class="p">,</span> <span class="s1">&#39;MAD_f475&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">variable candidates&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;ACS_F475W [mag]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;ACS_F475W MAD [mag]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">jtab</span><span class="p">)</span><span class="si">}</span><span class="s1"> HSC measurements near </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-variables-in-color-magnitude-diagram-a-name-cmd-a">
<h3>Plot variables in color-magnitude diagram <a name="cmd"></a><a class="headerlink" href="#plot-variables-in-color-magnitude-diagram-a-name-cmd-a" title="Permalink to this heading">#</a></h3>
<p>Many of the candidate variables lie on the instability strip.</p>
<p>This plot is similar to the lower panel of Figure 4 in <a class="reference external" href="https://www.aanda.org/component/article?access=doi&amp;doi=10.1051/0004-6361/201936026">Bonanos et al. (2019, AAp)</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># add a new column to jtab</span>
<span class="n">jtab</span><span class="p">[</span><span class="s1">&#39;MCMf475-MCMf814&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">jtab</span><span class="p">[</span><span class="s1">&#39;MeanCorrMag_f475&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">jtab</span><span class="p">[</span><span class="s1">&#39;MeanCorrMag_f814&#39;</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="c1"># uses same plot parameters defined in the previous plot</span>
<span class="k">for</span> <span class="n">ac</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">auto_class</span><span class="p">,</span> <span class="n">markers</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">jtab</span><span class="p">[</span><span class="n">jtab</span><span class="p">[</span><span class="s1">&#39;AutoClass&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">ac</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;MCMf475-MCMf814&#39;</span><span class="p">,</span> <span class="s1">&#39;MeanCorrMag_f475&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">variable candidates&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
    
<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;ACS F475W - F814W [mag]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;ACS F475W [mag]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">jtab</span><span class="p">)</span><span class="si">}</span><span class="s1"> HSC measurements near </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="get-a-light-curve-for-a-nova-in-m87-a-name-m87-a">
<h2>Get a light curve for a nova in M87 <a name="m87"></a><a class="headerlink" href="#get-a-light-curve-for-a-nova-in-m87-a-name-m87-a" title="Permalink to this heading">#</a></h2>
<section id="extract-light-curve-for-a-given-matchid-a-name-lightcurve-a">
<h3>Extract light curve for a given MatchID <a name="lightcurve"></a><a class="headerlink" href="#extract-light-curve-for-a-given-matchid-a-name-lightcurve-a" title="Permalink to this heading">#</a></h3>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">MatchID</span></code> could be determined by positional searches, filtering the catalog, etc.  This object comes from the top left panel of Figure 9 in <a class="reference external" href="https://www.aanda.org/component/article?access=doi&amp;doi=10.1051/0004-6361/201936026">Bonanos et al. (2019, AAp)</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">matchid</span> <span class="o">=</span> <span class="mi">1905457</span>

<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># get light curves for F606W and F814W</span>
<span class="n">nova_606</span> <span class="o">=</span> <span class="n">ascii</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">hcvsearch</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;hcv&#39;</span><span class="p">,</span> <span class="n">MatchID</span><span class="o">=</span><span class="n">matchid</span><span class="p">,</span> <span class="n">Filter</span><span class="o">=</span><span class="s1">&#39;ACS_F606W&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> sec: retrieved </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">nova_606</span><span class="p">)</span><span class="si">}</span><span class="s2"> F606W measurements&quot;</span><span class="p">)</span>

<span class="n">nova_814</span> <span class="o">=</span> <span class="n">ascii</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">hcvsearch</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;hcv&#39;</span><span class="p">,</span> <span class="n">MatchID</span><span class="o">=</span><span class="n">matchid</span><span class="p">,</span> <span class="n">Filter</span><span class="o">=</span><span class="s1">&#39;ACS_F814W&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> sec: retrieved </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">nova_814</span><span class="p">)</span><span class="si">}</span><span class="s2"> F814W measurements&quot;</span><span class="p">)</span>

<span class="c1"># get the object RA and Dec as well</span>
<span class="n">nova_tab</span> <span class="o">=</span> <span class="n">ascii</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">hcvsearch</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;hcvsummary&#39;</span><span class="p">,</span> <span class="n">MatchID</span><span class="o">=</span><span class="n">matchid</span><span class="p">,</span> <span class="n">Filter</span><span class="o">=</span><span class="s1">&#39;ACS_F814W&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> sec: retrieved object info&quot;</span><span class="p">)</span>

<span class="n">nova_606</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;MJD&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;CorrMag&#39;</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="s1">&#39;MagErr&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;ob&#39;</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ACS F606W&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">nova_606</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;MJD&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;CorrMag&#39;</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="s1">&#39;MagErr&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;or&#39;</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ACS F814W&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">nova_814</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;MJD [days]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;magnitude&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Nova in M87 (MatchID: </span><span class="si">{</span><span class="n">matchid</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="get-hla-image-cutouts-for-the-nova-a-name-cutouts-a">
<h3>Get HLA image cutouts for the nova <a name="cutouts"></a><a class="headerlink" href="#get-hla-image-cutouts-for-the-nova-a-name-cutouts-a" title="Permalink to this heading">#</a></h3>
<p>The <a class="reference external" href="https://hla.stsci.edu">Hubble Legacy Archive (HLA)</a> images were the source of the measurements in the HSC and HCV, and it can be useful to look at the images.  Examination of the images can be useful to identified cosmic-ray contamination and other possible image artifacts.  In this case, no issues are seen, so the light curve is reliable.</p>
<p>Note that the ACS F606W images of M87 have only a single exposure, so they do have cosmic ray contamination.  The accompanying F814W images have multiple exposures, allowing CRs to be removed.  In this case the F814W combined image is used to find objects, while the F606W exposure is used only for photometry.  That reduces the effects of F606W CRs on the catalog but it is still a good idea to confirm the quality of the images.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">get_hla_cutout</span></code> function reads a single cutout image (as a JPEG grayscale image) and returns a PIL image object.  See the documentation on the <a class="reference external" href="http://hla.stsci.edu/fitscutcgi_interface.html">fitscut image cutout service</a> for more information on the web service being used.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_hla_cutout</span><span class="p">(</span><span class="n">imagename</span><span class="p">,</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">33</span><span class="p">,</span> <span class="n">autoscale</span><span class="o">=</span><span class="mf">99.5</span><span class="p">,</span> <span class="n">asinh</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get JPEG cutout for an image&quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://hla.stsci.edu/cgi-bin/fitscut.cgi&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="o">=</span><span class="n">dec</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
                                      <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;jpeg&quot;</span><span class="p">,</span> <span class="n">red</span><span class="o">=</span><span class="n">imagename</span><span class="p">,</span> <span class="n">autoscale</span><span class="o">=</span><span class="n">autoscale</span><span class="p">,</span> <span class="n">asinh</span><span class="o">=</span><span class="n">asinh</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="n">zoom</span><span class="p">))</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">im</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sort images by magnitude from brightest to faintest</span>
<span class="n">phot</span> <span class="o">=</span> <span class="n">nova_606</span>
<span class="n">isort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">phot</span><span class="p">[</span><span class="s1">&#39;CorrMag&#39;</span><span class="p">])</span>
<span class="c1"># select the brightest, median and faintest magnitudes</span>
<span class="n">ind</span> <span class="o">=</span> <span class="p">[</span><span class="n">isort</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">isort</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">isort</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span> <span class="n">isort</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>

<span class="c1"># we plot zoomed-in and zoomed-out views side-by-side for each selected image</span>
<span class="n">nim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># images per row</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="p">(</span><span class="n">nim</span><span class="o">+</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="n">ncols</span>

<span class="n">imsize1</span> <span class="o">=</span> <span class="mi">19</span>
<span class="n">imsize2</span> <span class="o">=</span> <span class="mi">101</span>
<span class="n">mra</span> <span class="o">=</span> <span class="n">nova_tab</span><span class="p">[</span><span class="s1">&#39;RA&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">mdec</span> <span class="o">=</span> <span class="n">nova_tab</span><span class="p">[</span><span class="s1">&#39;Dec&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># define figure and axes</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="o">/</span><span class="n">ncols</span><span class="p">)</span><span class="o">*</span><span class="n">nrows</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># iterate through each set of two subplots in axes</span>
<span class="k">for</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">),</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">ind</span><span class="p">):</span>
    
    <span class="c1"># get the images</span>
    <span class="n">im1</span> <span class="o">=</span> <span class="n">get_hla_cutout</span><span class="p">(</span><span class="n">phot</span><span class="p">[</span><span class="s1">&#39;ImageName&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">mra</span><span class="p">,</span> <span class="n">mdec</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">imsize1</span><span class="p">)</span>
    <span class="n">im2</span> <span class="o">=</span> <span class="n">get_hla_cutout</span><span class="p">(</span><span class="n">phot</span><span class="p">[</span><span class="s1">&#39;ImageName&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">mra</span><span class="p">,</span> <span class="n">mdec</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">imsize2</span><span class="p">)</span>
    
    <span class="c1"># plot left column   </span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im1</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">phot</span><span class="p">[</span><span class="s1">&#39;ImageName&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2"> m=</span><span class="si">{</span><span class="n">phot</span><span class="p">[</span><span class="s1">&#39;CorrMag&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    
    <span class="c1"># plot right column</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im2</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">xbox</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">imsize1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">imsize2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xbox</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">xbox</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">phot</span><span class="p">[</span><span class="s1">&#39;ImageName&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2"> m=</span><span class="si">{</span><span class="n">phot</span><span class="p">[</span><span class="s1">&#39;CorrMag&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>    
    
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> s: got </span><span class="si">{</span><span class="n">nrows</span><span class="o">*</span><span class="n">ncols</span><span class="si">}</span><span class="s2"> cutouts&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="compare-the-hcv-automatic-classification-to-expert-validations-a-name-expert-a">
<h2>Compare the HCV automatic classification to expert validations <a name="expert"></a><a class="headerlink" href="#compare-the-hcv-automatic-classification-to-expert-validations-a-name-expert-a" title="Permalink to this heading">#</a></h2>
<p>The HCV includes an automatic classification <code class="docutils literal notranslate"><span class="pre">AutoClass</span></code> for candidate variables as well as an expert validation for some fields that were selected for visual examination.  For this example, we select all the objects in the HCV that have expert classification information.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># get data for objects with an expert validation</span>
<span class="n">constraints</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ExpertClass.gte&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">tab</span> <span class="o">=</span> <span class="n">ascii</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">hcvsearch</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="s2">&quot;hcvsummary&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">constraints</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Retrieved </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tab</span><span class="p">)</span><span class="si">}</span><span class="s2"> rows in </span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> sec&quot;</span><span class="p">)</span>

<span class="c1"># clean up the output format</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MeanMag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MeanCorrMag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MAD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Chi2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;RA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.6f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Dec&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.6f}</span><span class="s2">&quot;</span>

<span class="c1"># tab includes 1 row for each filter (so multiple rows for objects with multiple filters)</span>
<span class="c1"># get an array that has only one row per object</span>
<span class="n">mval</span><span class="p">,</span> <span class="n">uindex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MatchID&#39;</span><span class="p">],</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">utab</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="n">uindex</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">utab</span><span class="p">)</span><span class="si">}</span><span class="s2"> unique MatchIDs in table&quot;</span><span class="p">)</span>

<span class="n">tab</span>
</pre></div>
</div>
</div>
</div>
<p>An <code class="docutils literal notranslate"><span class="pre">ExpertClass</span></code> value of 1 indicates that the object is confidently confirmed to be a variable; 2 means that the measurements do not have apparent problems and so the object is likely to be variable (usually the variability is too small to be obvious in the image); 4 means that the variability is likely to be the result of artifacts in the image (e.g., residual cosmic rays or diffraction spikes from nearby bright stars).</p>
<p>Compare the distributions for single-filter variable candidates (SFVC, <code class="docutils literal notranslate"><span class="pre">AutoClass</span></code>=1) and multi-filter variable candidates (MFVC, <code class="docutils literal notranslate"><span class="pre">AutoClass</span></code>=2).  The fraction of artifacts is lower in the MFVC sample.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sfcount</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">utab</span><span class="p">[</span><span class="s1">&#39;ExpertClass&#39;</span><span class="p">][</span><span class="n">utab</span><span class="p">[</span><span class="s1">&#39;AutoClass&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">mfcount</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">utab</span><span class="p">[</span><span class="s1">&#39;ExpertClass&#39;</span><span class="p">][</span><span class="n">utab</span><span class="p">[</span><span class="s1">&#39;AutoClass&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">sfrat</span> <span class="o">=</span> <span class="n">sfcount</span><span class="o">/</span><span class="n">sfcount</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">mfrat</span> <span class="o">=</span> <span class="n">mfcount</span><span class="o">/</span><span class="n">mfcount</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Type Variable Likely Artifact Total&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SFVC </span><span class="si">{:8d}</span><span class="s2"> </span><span class="si">{:6d}</span><span class="s2"> </span><span class="si">{:8d}</span><span class="s2"> </span><span class="si">{:5d}</span><span class="s2"> counts&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sfcount</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sfcount</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">sfcount</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">sfcount</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MFVC </span><span class="si">{:8d}</span><span class="s2"> </span><span class="si">{:6d}</span><span class="s2"> </span><span class="si">{:8d}</span><span class="s2"> </span><span class="si">{:5d}</span><span class="s2"> counts&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mfcount</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">mfcount</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">mfcount</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">mfcount</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SFVC </span><span class="si">{:8.3f}</span><span class="s2"> </span><span class="si">{:6.3f}</span><span class="s2"> </span><span class="si">{:8.3f}</span><span class="s2"> </span><span class="si">{:5.3f}</span><span class="s2"> fraction&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sfrat</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sfrat</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">sfrat</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">sfrat</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MFVC </span><span class="si">{:8.3f}</span><span class="s2"> </span><span class="si">{:6.3f}</span><span class="s2"> </span><span class="si">{:8.3f}</span><span class="s2"> </span><span class="si">{:5.3f}</span><span class="s2"> fraction&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mfrat</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">mfrat</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">mfrat</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">mfrat</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
</pre></div>
</div>
</div>
</div>
<section id="plot-the-mad-variability-index-distribution-with-expert-classifications-a-name-mad-expert-a">
<h3>Plot the MAD variability index distribution with expert classifications <a name="mad_expert"></a><a class="headerlink" href="#plot-the-mad-variability-index-distribution-with-expert-classifications-a-name-mad-expert-a" title="Permalink to this heading">#</a></h3>
<p>Note that only the filters identified as variable (<code class="docutils literal notranslate"><span class="pre">FilterDetFlag</span></code> &gt; 0) are included here.</p>
<p>This version of the plot shows the distributions for the various <code class="docutils literal notranslate"><span class="pre">ExpertClass</span></code> values along with, for comparison, the distribution for all objects in gray (which is identical in each panel).  Most objects are classified as confident or likely variables.  Objects with lower MAD values (indicating a lower amplitude of variability) are less likely to be identified as confident variables because low-level variability is more difficult to confirm via visual examination.</p>
<section id="data-bins">
<h4>Data &amp; Bins<a class="headerlink" href="#data-bins" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;FilterDetFlag&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">mad</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MAD&#39;</span><span class="p">][</span><span class="n">w</span><span class="p">]</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;ExpertClass&#39;</span><span class="p">][</span><span class="n">w</span><span class="p">]</span>

<span class="n">xrange</span> <span class="o">=</span> <span class="p">[</span><span class="mf">7.e-3</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">xrange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">xrange</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">xrange</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plots">
<h4>Plots<a class="headerlink" href="#plots" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Confident&#39;</span><span class="p">,</span> <span class="s1">&#39;Likely&#39;</span><span class="p">,</span> <span class="s1">&#39;Artifact&#39;</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C0&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">labels</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mad</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;All&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mad</span><span class="p">[</span><span class="n">e</span> <span class="o">==</span> <span class="n">v</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
    
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;HCV Expert Validation&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;MAD Variability Index [mag]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The plot below shows the same distributions, but plotted as stacked histograms.  The top panel uses a linear scale on the y-axis and the bottom panel uses a log y scale.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="n">ylogs</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">ylog</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">ylogs</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mad</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="n">ylog</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Artifact&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mad</span><span class="p">[</span><span class="n">e</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="n">ylog</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Likely Variable&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mad</span><span class="p">[</span><span class="n">e</span> <span class="o">==</span> <span class="mi">1</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="n">ylog</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Confident Variable&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;MAD Variability Index [mag]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;HCV Expert Validation&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="plot-the-fraction-of-artifacts-as-a-function-of-mad-variability-index-a-name-artifacts-a">
<h3>Plot the fraction of artifacts as a function of MAD variability index <a name="artifacts"></a><a class="headerlink" href="#plot-the-fraction-of-artifacts-as-a-function-of-mad-variability-index-a-name-artifacts-a" title="Permalink to this heading">#</a></h3>
<p>This shows how the fraction of artifacts varies with the MAD value.  For larger MAD values the fraction decreases sharply, presumably because such large values are less likely to result from the usual artifacts.  Interestingly, the artifact fraction also declines for smaller MAD values (MAD &lt; 0.1 mag).  Probably that happens because typical artifacts are more likely to produce strong signals than the weaker signals indicated by a low MAD value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;FilterDetFlag&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">mad</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MAD&#39;</span><span class="p">][</span><span class="n">w</span><span class="p">]</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;ExpertClass&#39;</span><span class="p">][</span><span class="n">w</span><span class="p">]</span>

<span class="n">xrange</span> <span class="o">=</span> <span class="p">[</span><span class="mf">7.e-3</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">xrange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">xrange</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">xrange</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="n">all_count</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">mad</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
<span class="n">artifact_count</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">mad</span><span class="p">[</span><span class="n">e</span> <span class="o">==</span> <span class="mi">4</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
<span class="n">wnz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">all_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">nnz</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wnz</span><span class="p">)</span>

<span class="n">artifact_count</span> <span class="o">=</span> <span class="n">artifact_count</span><span class="p">[</span><span class="n">wnz</span><span class="p">]</span>
<span class="n">all_count</span> <span class="o">=</span> <span class="n">all_count</span><span class="p">[</span><span class="n">wnz</span><span class="p">]</span>
<span class="n">xerr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">nnz</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">xerr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">bin_edges</span><span class="p">[</span><span class="n">wnz</span><span class="p">]</span>
<span class="n">xerr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">bin_edges</span><span class="p">[</span><span class="n">wnz</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># combine bins at edge into one big bin to improve the statistics there</span>
<span class="n">iz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">all_count</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="k">if</span> <span class="n">iz</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">all_count</span><span class="p">[</span><span class="n">iz</span><span class="p">]</span> <span class="o">+=</span> <span class="n">all_count</span><span class="p">[:</span><span class="n">iz</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">artifact_count</span><span class="p">[</span><span class="n">iz</span><span class="p">]</span> <span class="o">+=</span> <span class="n">artifact_count</span><span class="p">[:</span><span class="n">iz</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">xerr</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">iz</span><span class="p">]</span> <span class="o">=</span> <span class="n">xerr</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">all_count</span> <span class="o">=</span> <span class="n">all_count</span><span class="p">[</span><span class="n">iz</span><span class="p">:]</span>
    <span class="n">artifact_count</span> <span class="o">=</span> <span class="n">artifact_count</span><span class="p">[</span><span class="n">iz</span><span class="p">:]</span>
    <span class="n">xerr</span> <span class="o">=</span> <span class="n">xerr</span><span class="p">[:,</span> <span class="n">iz</span><span class="p">:]</span>
    
<span class="n">iz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">all_count</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">40</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="k">if</span> <span class="n">iz</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">all_count</span><span class="p">[</span><span class="o">-</span><span class="n">iz</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">all_count</span><span class="p">[</span><span class="o">-</span><span class="n">iz</span><span class="p">:]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">artifact_count</span><span class="p">[</span><span class="o">-</span><span class="n">iz</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">artifact_count</span><span class="p">[</span><span class="o">-</span><span class="n">iz</span><span class="p">:]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">xerr</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">iz</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">xerr</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">all_count</span> <span class="o">=</span> <span class="n">all_count</span><span class="p">[:</span><span class="o">-</span><span class="n">iz</span><span class="p">]</span>
    <span class="n">artifact_count</span> <span class="o">=</span> <span class="n">artifact_count</span><span class="p">[:</span><span class="o">-</span><span class="n">iz</span><span class="p">]</span>
    <span class="n">xerr</span> <span class="o">=</span> <span class="n">xerr</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="n">iz</span><span class="p">]</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">xerr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">xerr</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">xerr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">xerr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">xerr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">xerr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span>

<span class="n">frac</span> <span class="o">=</span> <span class="n">artifact_count</span><span class="o">/</span><span class="n">all_count</span>
<span class="c1"># error on fraction using binomial distribution (approximate)</span>
<span class="n">ferr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">frac</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">frac</span><span class="p">)</span><span class="o">/</span><span class="n">all_count</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Create the plot</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">frac</span><span class="p">,</span> <span class="n">xerr</span><span class="o">=</span><span class="n">xerr</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">ferr</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;ob&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Artifact fraction&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;MAD Variability Index [mag]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Artifact Fraction&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;HCV Expert Validation&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-light-curve-for-the-most-variable-high-quality-candidate-in-the-hcv-a-name-most-variable-a">
<h3>Plot light curve for the most variable high quality candidate in the HCV <a name="most_variable"></a><a class="headerlink" href="#plot-light-curve-for-the-most-variable-high-quality-candidate-in-the-hcv-a-name-most-variable-a" title="Permalink to this heading">#</a></h3>
<p>Select the candidate variable with the largest MAD value and <code class="docutils literal notranslate"><span class="pre">VarQualFlag</span></code> = ‘AAAAA’.  To find the highest MAD value, we sort by MAD in descending order and select the first result.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">constraints</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;VarQualFlag&#39;</span><span class="p">:</span> <span class="s1">&#39;AAAAA&#39;</span><span class="p">,</span> <span class="s1">&#39;sort_by&#39;</span><span class="p">:</span> <span class="s1">&#39;MAD.desc&#39;</span><span class="p">,</span> <span class="s1">&#39;pagesize&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>

<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">tab</span> <span class="o">=</span> <span class="n">ascii</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">hcvsearch</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;hcvsummary&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">constraints</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Completed in </span><span class="si">{:.1f}</span><span class="s2"> sec&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">))</span>

<span class="c1"># clean up the output format</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MeanMag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MeanCorrMag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MAD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Chi2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;RA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.6f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Dec&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.6f}</span><span class="s2">&quot;</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MatchID </span><span class="si">{}</span><span class="s2"> has largest MAD value = </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MatchID&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MAD&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">tab</span>
</pre></div>
</div>
</div>
</div>
<p>Get the light curve.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">matchid</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MatchID&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">mfilter</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Filter&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">lc</span> <span class="o">=</span> <span class="n">ascii</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">hcvsearch</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="s2">&quot;hcv&quot;</span><span class="p">,</span> <span class="n">MatchID</span><span class="o">=</span><span class="n">matchid</span><span class="p">,</span> <span class="n">Filter</span><span class="o">=</span><span class="n">mfilter</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> sec: retrieved </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lc</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">mfilter</span><span class="si">}</span><span class="s2"> measurements&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Plot the light curve.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;MJD&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;CorrMag&#39;</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="s1">&#39;MagErr&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;ob&#39;</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">mfilter</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">lc</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;MJD [days]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;magnitude&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;MatchID: </span><span class="si">{</span><span class="n">matchid</span><span class="si">}</span><span class="s2"> MAD=</span><span class="si">{</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MAD&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Extract cutout images for the entire light curve (since it does not have many points).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sort images in MJD order</span>
<span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">lc</span><span class="p">[</span><span class="s1">&#39;MJD&#39;</span><span class="p">])</span>

<span class="c1"># we plot zoomed-in and zoomed-out views side-by-side for each selected image</span>
<span class="n">nim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># images per row</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="p">(</span><span class="n">nim</span><span class="o">+</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="n">ncols</span>

<span class="n">imsize1</span> <span class="o">=</span> <span class="mi">19</span>
<span class="n">imsize2</span> <span class="o">=</span> <span class="mi">101</span>
<span class="n">mra</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;RA&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">mdec</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Dec&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># define figure and axes</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="o">/</span><span class="n">ncols</span><span class="p">)</span><span class="o">*</span><span class="n">nrows</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># iterate through each set of two subplots in axes</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">((</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">),</span> <span class="n">k</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">ind</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span>
    
    <span class="c1"># get the images</span>
    <span class="n">im1</span> <span class="o">=</span> <span class="n">get_hla_cutout</span><span class="p">(</span><span class="n">lc</span><span class="p">[</span><span class="s1">&#39;ImageName&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">mra</span><span class="p">,</span> <span class="n">mdec</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">imsize1</span><span class="p">)</span>
    <span class="n">im2</span> <span class="o">=</span> <span class="n">get_hla_cutout</span><span class="p">(</span><span class="n">lc</span><span class="p">[</span><span class="s1">&#39;ImageName&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">mra</span><span class="p">,</span> <span class="n">mdec</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">imsize2</span><span class="p">)</span>
    
    <span class="c1"># plot left column    </span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im1</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">lc</span><span class="p">[</span><span class="s1">&#39;ImageName&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    
    <span class="c1"># plot right column</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im2</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">xbox</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">imsize1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">imsize2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xbox</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">xbox</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;m=</span><span class="si">{</span><span class="n">lc</span><span class="p">[</span><span class="s1">&#39;CorrMag&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> MJD=</span><span class="si">{</span><span class="n">lc</span><span class="p">[</span><span class="s1">&#39;MJD&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> s: finished </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span><span class="si">}</span><span class="s2"> epochs&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> s: got </span><span class="si">{</span><span class="n">nrows</span><span class="o">*</span><span class="n">ncols</span><span class="si">}</span><span class="s2"> cutouts&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/HSC/HCV_API"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../../astroquery/wildcard_searches/wildcard_searches.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Wildcard Handling with Astroquery.mast</p>
      </div>
    </a>
    <a class="right-next"
       href="../HSCV3_API/hscv3_api.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Hubble Source Catalog API Notebook</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Hubble Catalog of Variables Notebook (API version)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rick-white-steve-lubow-trenton-mckinney">2019 - 2022, Rick White, Steve Lubow, Trenton McKinney</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#instructions">Instructions</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#initialization-a-name-initialization-a">Initialization <a name="initialization"></a></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#install-python-modules">Install Python modules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mast-api-functions">MAST API functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variable-objects-near-ic-1613-a-name-ic1613-a">Variable objects near IC 1613 <a name="ic1613"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-mast-name-resolver-to-get-position-of-ic-1613-a-name-resolver-a">Use MAST name resolver to get position of IC 1613 <a name="resolver"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#select-objects-near-ic-1613-from-hcv-a-name-summary-a">Select objects near IC 1613 from HCV <a name="summary"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#description-of-the-variable-classification-columns-a-name-classification-a">Description of the variable classification columns <a name="classification"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#find-objects-with-measurements-in-both-f475w-and-f814w">Find objects with measurements in both F475W and F814W</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-object-positions-on-the-sky-a-name-positions-a">Plot object positions on the sky <a name="positions"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-hcv-mad-variability-index-versus-magnitude-in-f475w-a-name-variability-a">Plot HCV MAD variability index versus magnitude in F475W <a name="variability"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-variables-in-color-magnitude-diagram-a-name-cmd-a">Plot variables in color-magnitude diagram <a name="cmd"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-a-light-curve-for-a-nova-in-m87-a-name-m87-a">Get a light curve for a nova in M87 <a name="m87"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-light-curve-for-a-given-matchid-a-name-lightcurve-a">Extract light curve for a given MatchID <a name="lightcurve"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#get-hla-image-cutouts-for-the-nova-a-name-cutouts-a">Get HLA image cutouts for the nova <a name="cutouts"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-the-hcv-automatic-classification-to-expert-validations-a-name-expert-a">Compare the HCV automatic classification to expert validations <a name="expert"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-mad-variability-index-distribution-with-expert-classifications-a-name-mad-expert-a">Plot the MAD variability index distribution with expert classifications <a name="mad_expert"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-bins">Data &amp; Bins</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plots">Plots</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-fraction-of-artifacts-as-a-function-of-mad-variability-index-a-name-artifacts-a">Plot the fraction of artifacts as a function of MAD variability index <a name="artifacts"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-light-curve-for-the-most-variable-high-quality-candidate-in-the-hcv-a-name-most-variable-a">Plot light curve for the most variable high quality candidate in the HCV <a name="most_variable"></a></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By STScI
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022-2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>