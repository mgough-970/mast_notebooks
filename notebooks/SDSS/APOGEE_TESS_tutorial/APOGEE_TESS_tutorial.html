

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Characterizing Variable Stars with APOGEE + TESS &#8212; MAST Notebook Repository</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/main.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/table.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-SK672ZMP7G"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-SK672ZMP7G');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/SDSS/APOGEE_TESS_tutorial/APOGEE_TESS_tutorial';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Exploring High-Redshift Quasars with eBOSS and JWST" href="../eBOSS_JWST_tutorial/eBOSS_JWST_tutorial.html" />
    <link rel="prev" title="Mapping Galaxy Properties with MaNGA + HST" href="../MaNGA_HST_tutorial/MaNGA_HST_tutorial.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/mastlogo.svg" class="logo__image only-light" alt="MAST Notebook Repository - Home"/>
    <script>document.write(`<img src="../../../_static/mastlogo.svg" class="logo__image only-dark" alt="MAST Notebook Repository - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    Welcome to the MAST Notebook Repository!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">GALEX</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../GALEX/mis_mosaic/mis_mosaic.html">Surveying dust structure via GALEX MIS</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">HSC</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../HSC/queries.html">Intro HSC Queries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../HSC/HSCV3_API/hscv3_api.html">Hubble Source Catalog API Notebook</a></li>



<li class="toctree-l2"><a class="reference internal" href="../../HSC/HSCV3_SMC_API/hscv3_smc_api.html">Hubble Source Catalog API Notebook: SMC Color-Magnitude Diagram</a></li>



<li class="toctree-l2"><a class="reference internal" href="../../HSC/HSC_TAP/HSC_TAP.html">MAST Table Access Protocol Hubble Source Catalog Demo</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../HSC/SWEEPS.html">SWEEPS Queries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../HSC/SWEEPS_HSCV3P1/sweeps_hscv3p1.html">Hubble Source Catalog SWEEPS Proper Motion (CasJobs Version)</a></li>






















<li class="toctree-l2"><a class="reference internal" href="../../HSC/SWEEPS_HSCV3P1_API/sweeps_hscv3p1_api.html">Hubble Source Catalog SWEEPS Proper Motion (API Version)</a></li>









</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../HSC/HCV.html">Hubble Catalog of Variables (HCV) Queries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../HSC/HCV_API/HCV_API_demo.html">Hubble Catalog of Variables Notebook (API version)</a></li>



<li class="toctree-l2"><a class="reference internal" href="../../HSC/HCV_CASJOBS/HCV_casjobs_demo.html">Hubble Catalog of Variables Notebook (CasJobs version)</a></li>



</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">IUE</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../IUE/exploring_UV_extinction_curves/exploring_UV_extinction_curves.html">Exploring UV Extinction Curves</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">JWST</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../JWST/download_by_program_id/download_by_program_id.html">Accessing JWST Proposal Data in astroquery.mast</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../JWST/duplication_checking/duplication_checking.html">JWST Duplication Checking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../JWST/Engineering_Database_Retreival/EDB_Retrieval.html">JWST Engineering Data Retrieval</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../JWST/SI_keyword_exoplanet_search/SI_keyword_exoplanet_search.html">JWST SI Keyword Search for Exoplanet Spectra</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../JWST/MAST_metadata_search/MAST_metadata_search.html">Astroquery: Exploring Metadata from the James Webb Space Telescope</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Kepler</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/beginner.html">Beginner Notebooks</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/plotting_lightcurves/plotting_lightcurves.html">Using Kepler Data to Plot a Light Curve</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/plotting_images_from_tpf/plotting_images_from_tpf.html">Plotting Images from Kepler Target Pixel Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/plotting_dvts/plotting_dvts.html">Read and Plot A Kepler Data Validation Timeseries File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/plotting_catalog_over_FFI/plotting_catalog_over_FFI.html">Plotting a Catalog over a Kepler Full Frame Image File</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/lightkurve.html">Lightkurve</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_analyzing_lc_products/lightkurve_analyzing_lc_products.html">Using <em>Kepler</em> Light Curve Products with Lightkurve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_analyzing_tpf_products/lightkurve_analyzing_tpf_products.html">Using <em>Kepler</em> Target Pixel File Products with Lightkurve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_searching_for_data/lightkurve_searching_for_data.html">Searching for <em>Kepler</em>/<em>K2</em> and <em>TESS</em> Data Products Using Lightkurve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_custom_aperture_photometry/lightkurve_custom_aperture_photometry.html">Creating Your Own Light Curves using Custom Aperture Photometry</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_combining_multiple_quarters/lightkurve_combining_multiple_quarters.html">Combining Multiple Quarters of <em>Kepler</em> Data with Lightkurve</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_interactively_inspecting_TPFs_and_LCs/lightkurve_interactively_inspecting_TPFs_and_LCs.html">Interactively Inspecting Target Pixel Files and Light Curves</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/inst_noise.html">Instrumental Noise</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/instrumental_noise_1_data_gaps_and_quality_flags/instrumental_noise_1_data_gaps_and_quality_flags.html">Data Gaps and Quality Flags</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/instrumental_noise_2_spurious_signals_and_time_sampling_effects/instrumental_noise_2_spurious_signals_and_time_sampling_effects.html">Spurious Signals and Time Sampling Effects</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/instrumental_noise_3_seasonal_and_detector_effects/instrumental_noise_3_seasonal_and_detector_effects.html">Seasonal and Detector Effects</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/instrumental_noise_4_electronic_noise/instrumental_noise_4_electronic_noise.html">Electronic Noise</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/signals.html">Identifying Periodic Signals</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/identifying_transiting_planet_signals/identifying_transiting_planet_signals.html">Identifying Transiting Planet Signals in a <em>Kepler</em> Light Curve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/measuring_a_rotation_period/measuring_a_rotation_period.html">Measuring and Removing a Rotation Period Signal from a <em>Kepler</em> Light Curve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/visualizing_periodic_signals_using_a_river_plot/visualizing_periodic_signals_using_a_river_plot.html">Visualizing Periodic Signals Using a River Plot</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/verifying_the_location_of_a_signal/verifying_the_location_of_a_signal.html">Verifying the Location of a Signal in <em>Kepler</em> Pixel Data</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/periodograms.html">Periodograms &amp; Asteroseismology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/creating_periodograms/creating_periodograms.html">Creating Periodograms</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/how_to_understand_and_manipulate_the_periodogram_of_an_oscillating_star/how_to_understand_and_manipulate_the_periodogram_of_an_oscillating_star.html">How to Understand and Manipulate the Periodogram of an Oscillating Star</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/how_to_estimate_a_stars_mass_and_radius_using_asteroseismology/how_to_estimate_a_stars_mass_and_radius_using_asteroseismology.html">How to Estimate a Star’s Mass and Radius Using Asteroseismology</a></li>

</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">K2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../K2/TPF/TPF.html">Beginner: Read and Display A K2 Target Pixel File</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../K2/beginner_how_to_use_ffi/beginner_how_to_use_ffi.html">Beginner: Read and Display a K2 Full Frame Image</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../K2/removing_instrumental_noise_using_pld/removing_instrumental_noise_using_pld.html">Removing Instrumental Noise from <em>K2</em> and <em>TESS</em> Light Curves Using Pixel Level Decorrelation (PLD)</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MCCM</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../MCCM/FIMS-SPEAR/hyperspectral_healpix_maps/hyperspectral_healpix_maps.html">Working with FIMS-SPEAR Hyperspectral HEALPix Maps</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">SDSS</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../sdss.html">Sloan Digital Sky Survey (SDSS)</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../MaNGA_HST_tutorial/MaNGA_HST_tutorial.html">Mapping Galaxy Properties with MaNGA + HST</a></li>



<li class="toctree-l2 current active"><a class="current reference internal" href="#">Characterizing Variable Stars with APOGEE + TESS</a></li>






<li class="toctree-l2"><a class="reference internal" href="../eBOSS_JWST_tutorial/eBOSS_JWST_tutorial.html">Exploring High-Redshift Quasars with eBOSS and JWST</a></li>




</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Multi-Mission Tools</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../multi_mission/astroquery.html">Astroquery</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/beginner_search/beginner_search.html">Beginner: Searching MAST using astroquery.mast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/beginner_zcut/beginner_zcut.html">Beginner: Zcut and Astroquery Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/large_downloads/large_downloads.html">Large Downloads in <code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/historic_quasar_observations/historic_quasar_observations.html">Historical Quasar Observations</a></li>





<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/wildcard_searches/wildcard_searches.html">Wildcard Handling with Astroquery.mast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/missions_mast_search/missions_mast_search.html">Searching for Mission-Specific Data with Astroquery</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../multi_mission/display_footprints/display_footprints.html">PySIAF Observation Footprint Viewer</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PanSTARRS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../PanSTARRS/PS1_DR2_TAP/PS1_DR2_TAP.html">MAST Table Access Protocol PanSTARRS 1 DR2 Demo</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../PanSTARRS/PS1_image/PS1_image.html">Get Images from the PS1 Image Server</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">TESS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TESS/beginner.html">Beginner Notebooks</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_astroquery_dv/beginner_astroquery_dv.html">Retrieve TESS Data Validation Products with Astroquery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_how_to_use_dvt/beginner_how_to_use_dvt.html">Read and Plot A TESS Data Validation Timeseries File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_how_to_use_ffi/beginner_how_to_use_ffi.html">Read and Display a TESS Full Frame Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_how_to_use_lc/beginner_how_to_use_lc.html">Read and Plot A TESS Light Curve File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_how_to_use_tp/beginner_how_to_use_tp.html">Read and Display A TESS Target Pixel File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tess_exomast/beginner_tess_exomast.html">Exoplanet Data and TESS Light Curves Using Python Requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tess_tap_search/beginner_tess_tap_search.html">Download MAST TESS Light Curves Within an FFI Footprint Using TAP</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tic_search_hd209458/beginner_tic_search_hd209458.html">Search The TESS Input Catalog Centered On HD 209458.</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tour_lc_tp/beginner_tour_lc_tp.html">A Tour of the Contents of the TESS 2-minute Cadence Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tesscut_astroquery/beginner_tesscut_astroquery.html">Cutout of the TESS FFIs using Astrocut and Astroquery</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TESS/lc.html">Light Curves</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_gi_query/interm_gi_query.html">Intermediate:  Search and Download GI Program Light Curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_tasoc_lc/interm_tasoc_lc.html">Intermediate: Finding Flares and Variable Stars in TASOC Light Curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/asteroid_rotation/asteroid_rotation.html">Finding the Rotation Curve of an Asteroid or Comet with TESScut and Lightkurve</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TESS/FFIs.html">TESS FFIs</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_tesscut_dss_overlay/interm_tesscut_dss_overlay.html">Intermediate: Overlay a Cutout of the TESS FFIs with DSS imaging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_tesscut_requests/interm_tesscut_requests.html">Intermediate: Create TESS FFI Cutout using Python Requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/making_tess_cubes_and_cutouts/making_tess_cubes_and_cutouts.html">Generating Cubes and Cutouts from TESS FFIs</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TESS/noise.html">Instrumental Noise</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_tess_prf_retrieve/interm_tess_prf_retrieve.html">Intermediate: Retrieve TESS Pixel Response Function Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/removing_scattered_light_using_regression/removing_scattered_light_using_regression.html">Removing Scattered Light from <em>TESS</em> Data Using the Lightkurve <code class="docutils literal notranslate"><span class="pre">RegressionCorrector</span></code></a></li>

</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://timeseries.science.stsci.edu/hub/user-redirect/git-pull?repo=https%3A//github.com/spacetelescope/mast_notebooks&urlpath=lab/tree/mast_notebooks/notebooks/SDSS/APOGEE_TESS_tutorial/APOGEE_TESS_tutorial.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/spacetelescope/mast_notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/spacetelescope/mast_notebooks/issues/new?title=Issue%20on%20page%20%2Fnotebooks/SDSS/APOGEE_TESS_tutorial/APOGEE_TESS_tutorial.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/notebooks/SDSS/APOGEE_TESS_tutorial/APOGEE_TESS_tutorial.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Characterizing Variable Stars with APOGEE + TESS</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Characterizing Variable Stars with APOGEE + TESS</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-apogee-data-at-mast">Accessing APOGEE data at MAST</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#querying-all-apogee-data">Querying all APOGEE data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-for-a-specific-star">Searching for a specific star</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-apogee-data-products">Downloading APOGEE data products</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-an-apogee-spectrum">Plotting an APOGEE Spectrum</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-the-apogee-allstar-catalog">Downloading the APOGEE allStar Catalog</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-an-hr-diagram-or-kiel-diagram-with-apogee">Plotting an HR Diagram (or Kiel Diagram) with APOGEE</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-for-tess-data-of-this-star">Searching for TESS Data of this Star</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coordinate-search-using-astroquery-mast">Coordinate search using astroquery.mast</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-a-light-curve-from-tess">Plotting a light curve from TESS</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-apogee-and-tess-data">Combining APOGEE and TESS data</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-apogee-and-tess-data-together">Plotting APOGEE and TESS data together</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exploring-different-types-of-variable-stars">Exploring different types of Variable Stars</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rr-lyrae-variable-2m11361176-8117369">RR Lyrae Variable - 2M11361176+8117369</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rotationally-variable-2m19181706-5141323">Rotationally Variable - 2M19181706+5141323</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eclipsing-binary-star-2m19203184-3830492">Eclipsing Binary Star - 2M19203184+3830492</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-resources">Additional Resources</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#citations">Citations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><a id="top"></a></p>
<section class="tex2jax_ignore mathjax_ignore" id="characterizing-variable-stars-with-apogee-tess">
<h1>Characterizing Variable Stars with APOGEE + TESS<a class="headerlink" href="#characterizing-variable-stars-with-apogee-tess" title="Permalink to this heading">#</a></h1>
<hr class="docutils" />
<section id="learning-goals">
<h2>Learning Goals<a class="headerlink" href="#learning-goals" title="Permalink to this heading">#</a></h2>
<p>By the end of this tutorial, you will:</p>
<ul class="simple">
<li><p>Understand how to search the MAST Archive and download SDSS APOGEE data using <code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code></p></li>
<li><p>Plot a stellar spectrum and an HR diagram and using APOGEE data</p></li>
<li><p>Understand how to search for TESS light curves complementing the APOGEE observations</p></li>
<li><p>Explore different types of variable stars using their APOGEE parameters and TESS light curves</p></li>
</ul>
</section>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><span class="xref myst">Introduction</span></p></li>
<li><p><span class="xref myst">Imports</span></p></li>
<li><p><span class="xref myst">Accessing APOGEE data at MAST</span></p>
<ul>
<li><p><span class="xref myst">Querying all APOGEE data</span></p></li>
<li><p><span class="xref myst">Searching for a specific star</span></p></li>
<li><p><span class="xref myst">Downloading APOGEE data products</span></p></li>
<li><p><span class="xref myst">Plotting an APOGEE spectrum</span></p></li>
<li><p><span class="xref myst">Downloading the APOGEE allStar catalog</span></p></li>
<li><p><span class="xref myst">Plotting an HR diagram from APOGEE</span></p></li>
</ul>
</li>
<li><p><span class="xref myst">Searching for TESS data of this star</span></p>
<ul>
<li><p><span class="xref myst">Coordinate search using astroquery.mast</span></p></li>
<li><p><span class="xref myst">Plotting a light curve from TESS</span></p></li>
</ul>
</li>
<li><p><span class="xref myst">Combining APOGEE and TESS data</span></p>
<ul>
<li><p><span class="xref myst">Plotting APOGEE and TESS data together</span></p></li>
<li><p><span class="xref myst">Exploring Different types of Variable Stars</span></p>
<ul>
<li><p><span class="xref myst">RR-Lyrae Variable: 2M11361176+8117369</span></p></li>
<li><p><span class="xref myst">Rotationally Variable - 2M19181706+5141323</span></p></li>
<li><p><span class="xref myst">Eclipsing Binary - 2M19203184+3830492</span></p></li>
</ul>
</li>
</ul>
</li>
<li><p><span class="xref myst">Additional Resources</span></p>
<ul>
<li><p><span class="xref myst">How to Cite</span></p></li>
<li><p><span class="xref myst">About This Notebook</span></p></li>
</ul>
</li>
</ul>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p><a id="Introduction"></a></p>
<p>The <a class="reference external" href="https://www.sdss4.org/dr17/irspec/">Apache Point Observatory Galactic Evolution Experiment (APOGEE)</a> survey provides infrared-wavelength high-resolution spectroscopy for over 650,000 unique stars from the Milky Way and nearby dwarf galaxies. APOGEE collected data between 2011 - 2020 as part of the <a class="reference external" href="https://www.sdss4.org">Sloan Digital Sky Survey (SDSS-IV) project</a>. APOGEE data is now available at the <a class="reference external" href="https://archive.stsci.edu">Mikulski Archive for Space Telescopes (MAST)</a> through the <a class="reference external" href="https://outerspace.stsci.edu/display/SDSS/The+SDSS+Legacy+Archive+at+MAST">SDSS Legacy Archive at MAST</a>.</p>
<p>In this notebook tutorial, we will demonstrate how to access APOGEE data at MAST using Python. One APOGEE star, a Cepheid Variable named <code class="docutils literal notranslate"><span class="pre">V1154-Cyg</span></code> will be used to demonstrate the basics of how to download and plot APOGEE data. We will then combine this APOGEE spectrum with light curves from the TESS mission, also accessible from MAST, to study this variable star.</p>
</section>
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this heading">#</a></h2>
<p><a id="Imports"></a></p>
<p>The main packages we’re using for this notebook and their use-cases are:</p>
<ul class="simple">
<li><p><em>astroquery.mast Observations</em> for searching the MAST archive</p></li>
<li><p><em>astropy.io fits</em> for accessing FITS files</p></li>
<li><p><em>astropy.table Table</em> for accessing FITS tables</p></li>
<li><p><em>astropy.units</em> for working with astronomical units</p></li>
<li><p><em>astropy.coordinates</em> for handling astronomical coordinates</p></li>
<li><p><em>matplotlib.pyplot</em> for plotting data</p></li>
<li><p><em>numpy</em> to handle array functions</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span><span class="w"> </span><span class="nn">astroquery.mast</span><span class="w"> </span><span class="kn">import</span> <span class="n">Observations</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">astropy.io.fits</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fits</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.table</span><span class="w"> </span><span class="kn">import</span> <span class="n">Table</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.coordinates</span><span class="w"> </span><span class="kn">import</span> <span class="n">SkyCoord</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">astropy.units</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">u</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<p>This cell updates some of the settings in <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> to use larger font sizes in the figures:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Update Plotting Parameters</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;axes.labelsize&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;xtick.labelsize&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;ytick.labelsize&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> 
          <span class="s1">&#39;text.usetex&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;lines.linewidth&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
          <span class="s1">&#39;axes.titlesize&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span> <span class="s1">&#39;font.family&#39;</span><span class="p">:</span> <span class="s1">&#39;serif&#39;</span><span class="p">,</span> <span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">}</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<p><a id="APOGEE"></a></p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="accessing-apogee-data-at-mast">
<h1>Accessing APOGEE data at MAST<a class="headerlink" href="#accessing-apogee-data-at-mast" title="Permalink to this heading">#</a></h1>
<p>The <a class="reference external" href="https://outerspace.stsci.edu/display/SDSS/The+SDSS+Legacy+Archive+at+MAST">SDSS Legacy Archive at MAST</a> hosts all of the science-ready data products from the <a class="reference external" href="https://www.sdss4.org/dr17/irspec/">SDSS-IV APOGEE Survey</a>, which includes spectra for over 650,000 unique stars in the Milky Way. APOGEE acquired observations in both the northern and southern hemispheres, targeting the disk, bulge, bar, and halo components of the Milky Way, as well as several hundred stars in nearby satellite galaxies (including the LMC and SMC). This notebook will demonstrate how to search and download APOGEE data using MAST!</p>
<p><a id="APOGEE-query"></a></p>
<section id="querying-all-apogee-data">
<h2>Querying all APOGEE data<a class="headerlink" href="#querying-all-apogee-data" title="Permalink to this heading">#</a></h2>
<p>Searching for APOGEE data is straightforward with <code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code>. In this example, we use <code class="docutils literal notranslate"><span class="pre">Observations.query_criteria</span></code> and search for <code class="docutils literal notranslate"><span class="pre">provenance_name</span> <span class="pre">=</span> <span class="pre">'APOGEE'</span></code>. This will return a table describing all of the APOGEE data hosted by the MAST archive.</p>
<p>Other useful search parameters for APOGEE data might include:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">obs_collection</span> <span class="pre">=</span> <span class="pre">'SDSS'</span></code>: searches for all SDSS data</p></li>
<li><p>To specify telescope, use the <code class="docutils literal notranslate"><span class="pre">instrument_name</span></code> field. For example, <code class="docutils literal notranslate"><span class="pre">instrument_name</span> <span class="pre">=</span> <span class="pre">'apogee-lco25m'</span></code> limits the search to the stars that were observed with the Las Campanas Observatory 2.5-m telescope in the southern hemisphere.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">target_name</span></code> to search for stars using their APOGEE ID (usually the 2MASS ID - for example <code class="docutils literal notranslate"><span class="pre">'2M05320041-0017041'</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">obs_id</span></code> can help search for specific targets or fields. Note that wild cards (<code class="docutils literal notranslate"><span class="pre">*</span></code>) are allowed in the search fields, for example:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">obs_id='*n7789*'</span></code> for anything in the “N7789” field</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">obs_id='*2M05320041-0017041*'</span></code> for a specific star name (2MASS ID)</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Search for APOGEE data</span>
<span class="c1"># Using the pagesize and page parameters to only return first 10 results</span>
<span class="n">apogee_obs_list</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">provenance_name</span><span class="o">=</span><span class="s1">&#39;APOGEE&#39;</span><span class="p">,</span> <span class="n">pagesize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">page</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Display First Ten Entries in Table</span>
<span class="n">apogee_obs_list</span>
</pre></div>
</div>
</div>
</div>
<p><a id="APOGEE-star"></a></p>
</section>
<section id="searching-for-a-specific-star">
<h2>Searching for a specific star<a class="headerlink" href="#searching-for-a-specific-star" title="Permalink to this heading">#</a></h2>
<p>Let’s narrow down the search to one particular star: cepheid variable “V1154-Cyg”. Cepheid Variables are pulsating stars, which physically grow larger and smaller, and as a result brighter and dimmer, on a regular rhythm of few days. Cepheid variables in particular are useful to study in astronomy because their pulsation period correlates with their intrinsic brightness, making it easy to determine how far away the star is! Later in this notebook, we will look at some other kinds of variable stars.</p>
<p>We can search for this star in particular using the <code class="docutils literal notranslate"><span class="pre">target_name</span></code> keyword:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Search for APOGEE star V1154_Cyg</span>
<span class="n">apogee_obs_list</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">provenance_name</span><span class="o">=</span><span class="s1">&#39;APOGEE&#39;</span><span class="p">,</span>
                                              <span class="n">target_name</span><span class="o">=</span><span class="s1">&#39;V1154_Cyg&#39;</span><span class="p">)</span>

<span class="c1"># Display results</span>
<span class="n">apogee_obs_list</span>
</pre></div>
</div>
</div>
</div>
<p>From this results table, we can see some basic metadata related to this observation:</p>
<ul class="simple">
<li><p>This star was observed with the APO 1-M telescope (<code class="docutils literal notranslate"><span class="pre">instrument_name</span></code>)</p></li>
<li><p>It’s coordinates are in the <code class="docutils literal notranslate"><span class="pre">s_ra</span></code> and <code class="docutils literal notranslate"><span class="pre">s_dec</span></code> columns</p></li>
<li><p>From the <code class="docutils literal notranslate"><span class="pre">t_min</span></code> column, we can see that this star was first observed on the date of MJD 58002 (Correpsonding to 2017-09-06) and last observed on MJD 58069 (2017-11-12 )</p></li>
<li><p>APOGEE provides infrared-wavelength (<code class="docutils literal notranslate"><span class="pre">wavelength_region</span></code>) spectra (<code class="docutils literal notranslate"><span class="pre">dataproduct_type</span></code>) with wavelength range of 1514 - 1696 nanometers (<code class="docutils literal notranslate"><span class="pre">em_min</span></code>, <code class="docutils literal notranslate"><span class="pre">em_max</span></code>)</p></li>
</ul>
<p><a id="APOGEE-download"></a></p>
</section>
<section id="downloading-apogee-data-products">
<h2>Downloading APOGEE data products<a class="headerlink" href="#downloading-apogee-data-products" title="Permalink to this heading">#</a></h2>
<p>List all of the data products available for this star using <code class="docutils literal notranslate"><span class="pre">Observations.get_product_list()</span></code>.</p>
<p>There are 8 total files available for this star, which include the individual spectra from each visit (APVISIT; <code class="docutils literal notranslate"><span class="pre">apVisit-dr17-*-V1154_Cyg.fits</span></code>), the combined spectrum (APSTAR; <code class="docutils literal notranslate"><span class="pre">apStar-dr17-V1154_Cyg.fits</span></code>), the processed and anaylzed spectrum (ASPCAPSTAR; <code class="docutils literal notranslate"><span class="pre">aspcapStar-dr17-V1154_Cyg.fits</span></code>) which contains the best-fit model and stellar parameters from the <a class="reference external" href="https://www.sdss4.org/dr17/irspec/aspcap/">APOGEE Stellar Parameters and Chemical Abundance Pipeline (ASPCAP)</a>. Only the apStar and aspcapStar files are tagged as “Minimum Recommended Products’</p>
<p>More information on the APOGEE data products available at MAST can be found on the <a class="reference external" href="https://outerspace.stsci.edu/display/DraftSDSS/APOGEE+Data+Products">APOGEE Data Products</a> in the Archive Manual, and more information on all of these products can be seen in the search results table:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># List all products available for this observation</span>
<span class="n">products</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">apogee_obs_list</span><span class="p">)</span>

<span class="c1"># Show table</span>
<span class="n">products</span>
</pre></div>
</div>
</div>
</div>
<p>Now we will download the aspcapStar spectrum for this star using <code class="docutils literal notranslate"><span class="pre">Observations.download_products()</span></code>. The download will print a status message when completed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">manifest</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">products</span><span class="p">,</span> <span class="n">productSubGroupDescription</span><span class="o">=</span><span class="s1">&#39;ASPCAPSTAR&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a id="APOGEE-spectrum"></a></p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="plotting-an-apogee-spectrum">
<h1>Plotting an APOGEE Spectrum<a class="headerlink" href="#plotting-an-apogee-spectrum" title="Permalink to this heading">#</a></h1>
<p>Now let’s take a look at the file and plot the spectrum.</p>
<p>Based on the descriptions in the <a class="reference external" href="https://data.sdss.org/datamodel/files/APOGEE_ASPCAP/APRED_VERS/ASPCAP_VERS/TELESCOPE/FIELD/aspcapStar.html">aspcapStar Data Model</a>, this file has four extensions:</p>
<ul class="simple">
<li><p>HDU0: The Primary Header and file metadata</p></li>
<li><p>HDU1: The array containing the observed combined spectrum</p></li>
<li><p>HDU2: The error array for the spectrum</p></li>
<li><p>HDU3: The best fit model spectrum from ASPCAP</p></li>
<li><p>HDU4: The ASPCAP Data Table, containing the best fit stellar parameter values and other information for this star</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Open file</span>
<span class="n">aspcap_star</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">manifest</span><span class="p">[</span><span class="s1">&#39;Local Path&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Display file information</span>
<span class="n">aspcap_star</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>We can plot the spectrum using this information! The wavelength information can be found in the file hearer (HUD0), and observed flux is contained in the first extension (HDU1).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Get wavelength information from the header</span>
<span class="c1"># CRVAL1 is the minimum wavlength, CDELT1 is the step size (in log space) and NAXIS1 is the number of pixels</span>
<span class="n">apogee_wls</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">aspcap_star</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;CRVAL1&#39;</span><span class="p">],</span>
                         <span class="n">aspcap_star</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;CRVAL1&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">aspcap_star</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;CDELT1&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">aspcap_star</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;NAXIS1&#39;</span><span class="p">],</span>
                         <span class="n">aspcap_star</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;NAXIS1&#39;</span><span class="p">])</span>


<span class="c1"># Get the observed and model flux from extensions 1 and 3</span>
<span class="n">observed_flux</span> <span class="o">=</span> <span class="n">aspcap_star</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">model_flux</span> <span class="o">=</span> <span class="n">aspcap_star</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

<span class="c1"># Mask the data using the error array in extenion 2</span>
<span class="n">pixel_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">aspcap_star</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">)</span> <span class="c1"># use only pixels with small errors (10% or less)</span>

<span class="c1"># Plot the observed spectrum</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">apogee_wls</span><span class="p">[</span><span class="n">pixel_mask</span><span class="p">],</span> <span class="n">observed_flux</span><span class="p">[</span><span class="n">pixel_mask</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observed Spectrum&#39;</span><span class="p">)</span>

<span class="c1"># Plot the model spectrum</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">apogee_wls</span><span class="p">[</span><span class="n">pixel_mask</span><span class="p">],</span> <span class="n">model_flux</span><span class="p">[</span><span class="n">pixel_mask</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkred&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Best Fit Model Spectrum&#39;</span><span class="p">)</span>

<span class="c1"># Set axes limits</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">apogee_wls</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">apogee_wls</span><span class="p">))</span>

<span class="c1"># Set labels</span>
<span class="n">apogee_id</span> <span class="o">=</span> <span class="n">aspcap_star</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;APOGEE_ID&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># String containing star&#39;s name</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;APOGEE Spectrum - </span><span class="si">{</span><span class="n">apogee_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Wavelength [$\AA$]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Flux&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>This is the APOGEE spectrum for this star! It looks great. We can tell it must be a hot star because of the large Hydrogen Absorption lines (for example around 15346, 15443, 15560 and 16113 angstroms - this is the Hydrogen Brackett Series!) The gaps in the spectrum around 15800 and 16400 Angstroms are due to the APOGEE instrumentation: APOGEE observes across 3 ccds, which have a small gap in wavelength coverage between them.</p>
<p><a id="APOGEE-allstar"></a></p>
<section id="downloading-the-apogee-allstar-catalog">
<h2>Downloading the APOGEE allStar Catalog<a class="headerlink" href="#downloading-the-apogee-allstar-catalog" title="Permalink to this heading">#</a></h2>
<p>We can also download the APOGEE allStar catalog, which contains a lot of useful information for the full APOGEE sample, including stellar parameters, chemical abundances, positions, and observation data for all of the stars in APOGEE.</p>
<p>We can do this with the <code class="docutils literal notranslate"><span class="pre">download_file</span></code> function in astroquery, knowing the MAST data URL for the allStar catalog is <code class="docutils literal notranslate"><span class="pre">mast:SDSS/apogee/allStar-dr17-synspec_rev1.fits</span></code>.</p>
<p>This is a fairly large file (3.9 GB), so this download may take a few minutes!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download allStar file - this may take a few minutes!</span>
<span class="n">Observations</span><span class="o">.</span><span class="n">download_file</span><span class="p">(</span><span class="s1">&#39;mast:SDSS/apogee/allStar-dr17-synspec_rev1.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Open file </span>
<span class="n">allstar</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;allStar-dr17-synspec_rev1.fits&#39;</span><span class="p">,</span> <span class="n">hdu</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Display table</span>
<span class="n">allstar</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p><a id="APOGEE-plot"></a></p>
</section>
<section id="plotting-an-hr-diagram-or-kiel-diagram-with-apogee">
<h2>Plotting an HR Diagram (or Kiel Diagram) with APOGEE<a class="headerlink" href="#plotting-an-hr-diagram-or-kiel-diagram-with-apogee" title="Permalink to this heading">#</a></h2>
<p>When characterizing stars, a useful plot is the <em>HR diagram</em>, which helps classify stars by their different types (for example, a star can be a Sun-like main sequence star or a massive Red Giant star). Let’s plot an HR Diagram using APOGEE data.</p>
<p>Traditional HR diagrams plot a star’s <em>color</em> on the x-axis and its brightness (or <em>magnitude</em>) on the y-axis. For this excerise, we’ll be using the star’s <em>temperature</em> (<span class="math notranslate nohighlight">\(T_{eff}\)</span>) as a substitute for color and the surface gravity (<span class="math notranslate nohighlight">\(\log g\)</span>) as a proxy for brightness. This variation on the HR diagram is technically called a Kiel Diagram, but they are very similar in appearance and interpretation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot HR Diagram form APOGEE catalog</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Plot Temperature (TEFF) against surface gravity (LOGG)</span>
<span class="c1"># And color points by their metallicity (FE_H)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">allstar</span><span class="p">[</span><span class="s1">&#39;TEFF&#39;</span><span class="p">],</span> <span class="n">allstar</span><span class="p">[</span><span class="s1">&#39;LOGG&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">allstar</span><span class="p">[</span><span class="s1">&#39;FE_H&#39;</span><span class="p">],</span>
                 <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        
<span class="c1"># Add colorbar legend to plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Metallicity [Fe/H]&#39;</span><span class="p">)</span>

        
<span class="c1"># Labels and titles</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">7000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Effective Temperature [$T_{\rm</span><span class="si">{eff}</span><span class="s1">}$, K]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Surface Gravity [$\log(g)$]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;APOGEE Stellar Parameters - allStar&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>This is an HR Diagram made with APOGEE data! The Main Sequence stars are along the bottom, and the Red Giant Branch is in the upper-right portion. The Horizontal Branch stars are the upper-left group of dark blue (metal poor) points.</p>
<p><a id="TESS"></a></p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="searching-for-tess-data-of-this-star">
<h1>Searching for TESS Data of this Star<a class="headerlink" href="#searching-for-tess-data-of-this-star" title="Permalink to this heading">#</a></h1>
<p>Now let’s search MAST for a light curve of our Cepheid Variable star.</p>
<p><a id="TESS-query"></a></p>
<section id="coordinate-search-using-astroquery-mast">
<h2>Coordinate search using astroquery.mast<a class="headerlink" href="#coordinate-search-using-astroquery-mast" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Retrieve RA and DEC of APOGEE star</span>
<span class="n">ra</span> <span class="o">=</span> <span class="n">apogee_obs_list</span><span class="p">[</span><span class="s1">&#39;s_ra&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">dec</span> <span class="o">=</span> <span class="n">apogee_obs_list</span><span class="p">[</span><span class="s1">&#39;s_dec&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># make a SkyCoord object from these coordinates</span>
<span class="n">coord</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">ra</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="n">dec</span><span class="o">=</span><span class="n">dec</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>

<span class="c1"># Search for TESS observations based on coordinates</span>
<span class="n">tess_obs</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">coordinates</span><span class="o">=</span><span class="n">coord</span><span class="p">,</span> <span class="c1"># Search by coordinates</span>
                                       <span class="n">radius</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">60</span><span class="o">/</span><span class="mi">60</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="c1"># search within 1 arcsecond</span>
                                       <span class="c1"># Search for TESS observations</span>
                                       <span class="n">obs_collection</span><span class="o">=</span><span class="s1">&#39;TESS&#39;</span><span class="p">,</span>
                                       <span class="c1"># Select only Science observations (not calibration files)</span>
                                       <span class="n">intentType</span><span class="o">=</span><span class="s1">&#39;science&#39;</span><span class="p">,</span>
                                       <span class="c1"># Search for time series data (light curves)</span>
                                       <span class="n">dataproduct_type</span><span class="o">=</span><span class="s1">&#39;timeseries&#39;</span><span class="p">,</span>
                                       <span class="n">dataURL</span><span class="o">=</span><span class="s1">&#39;*_lc.fits&#39;</span>
                                       <span class="p">)</span>

<span class="c1"># Display Results</span>
<span class="n">tess_obs</span>
</pre></div>
</div>
</div>
</div>
<p>There are a handful of results, but we can find the closest match to this star using the “distance” column which returns the distance (in arcsecs) of each match to our cone search. There are several results with distance of 0, (this star was observed in multiple TESS sectors), so we will just use the first result.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tess_obs</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">tess_obs</span><span class="p">[</span><span class="s1">&#39;distance&#39;</span><span class="p">])]</span>
</pre></div>
</div>
</div>
</div>
<p>And download this file similar to what we did with APOGEE before:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get product list</span>
<span class="n">tess_products</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">tess_obs</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">tess_obs</span><span class="p">[</span><span class="s1">&#39;distance&#39;</span><span class="p">])])</span>

<span class="c1"># Show products</span>
<span class="n">tess_products</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download Products</span>
<span class="n">manifest</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">tess_products</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Light curves&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a id="TESS-lightcurve"></a></p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="plotting-a-light-curve-from-tess">
<h1>Plotting a light curve from TESS<a class="headerlink" href="#plotting-a-light-curve-from-tess" title="Permalink to this heading">#</a></h1>
<p>The TESS light curve file has three extensions:</p>
<ul class="simple">
<li><p>The primary header (HDU0)</p></li>
<li><p>The light curve data (HDU1)</p></li>
<li><p>aperture Information (HDU2)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Open file</span>
<span class="n">tess_lc</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">manifest</span><span class="p">[</span><span class="s1">&#39;Local Path&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Print file information</span>
<span class="n">tess_lc</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>We can plot the light curve by using the <code class="docutils literal notranslate"><span class="pre">TIME</span></code> and <code class="docutils literal notranslate"><span class="pre">SAP_FLUX</span></code> data from the first extension:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Plot the observed spectrum</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tess_lc</span><span class="p">[</span><span class="s1">&#39;LIGHTCURVE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">],</span> <span class="n">tess_lc</span><span class="p">[</span><span class="s1">&#39;LIGHTCURVE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;SAP_FLUX&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;TESS Light Curve&#39;</span><span class="p">)</span>

<span class="c1"># Plot a vertical line for every day</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">tess_lc</span><span class="p">[</span><span class="s1">&#39;LIGHTCURVE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">])),</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">tess_lc</span><span class="p">[</span><span class="s1">&#39;LIGHTCURVE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]))):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">)</span>
    
<span class="c1"># Set labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;TESS-SPOC Light Curve - </span><span class="si">{</span><span class="n">tess_lc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;OBJECT&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [BTJD]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Flux&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>This is a very typical light curve for a Cepheid Variable star, and TESS observed the variations in flux really well! This star cycles over a period of about 6 days.</p>
<p><a id="Combining-APOGEE-and-TESS-data"></a></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="combining-apogee-and-tess-data">
<h1>Combining APOGEE and TESS data<a class="headerlink" href="#combining-apogee-and-tess-data" title="Permalink to this heading">#</a></h1>
<p>Now we are ready to combine everything: the HR Diagram, the spectrum, and the TESS light curve into a single plot!</p>
<p><a id="Plotting-APOGEE-and-TESS-data-together"></a></p>
<section id="plotting-apogee-and-tess-data-together">
<h2>Plotting APOGEE and TESS data together<a class="headerlink" href="#plotting-apogee-and-tess-data-together" title="Permalink to this heading">#</a></h2>
<p>In the below cell, we define a helper function to plot all of the data together for our Cepheid Variable star:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_spectrum_and_lc</span><span class="p">(</span><span class="n">apogee_spec</span><span class="p">,</span> <span class="n">tess_lightcurve</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Helper function for plotting the HR Diagram, APOGEE Spectrum, and TESS Light Curve for a star&quot;&quot;&quot;</span>
    <span class="c1"># Set up axes for subplots</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="c1"># ===================</span>
    <span class="c1"># AX1 - HR Diagram</span>
    <span class="c1"># ===================</span>
    <span class="c1"># Plot HR Diagram form APOGEE catalog</span>
    <span class="c1"># Only plot 1 out of every 10 points with [::10] to reduce plotting time</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">allstar</span><span class="p">[</span><span class="s1">&#39;TEFF&#39;</span><span class="p">][::</span><span class="mi">10</span><span class="p">],</span> <span class="n">allstar</span><span class="p">[</span><span class="s1">&#39;LOGG&#39;</span><span class="p">][::</span><span class="mi">10</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">allstar</span><span class="p">[</span><span class="s1">&#39;FE_H&#39;</span><span class="p">][::</span><span class="mi">10</span><span class="p">],</span>
                     <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Metallicity [Fe/H]&#39;</span><span class="p">)</span>
            
    <span class="c1"># Plot the specific star</span>
    <span class="n">indx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">allstar</span><span class="p">[</span><span class="s1">&#39;APOGEE_ID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">apogee_spec</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;APOGEE_ID&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">allstar</span><span class="p">[</span><span class="s1">&#39;TEFF&#39;</span><span class="p">][</span><span class="n">indx</span><span class="p">]:</span> <span class="c1"># if the star has valid apogee parameters</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">allstar</span><span class="p">[</span><span class="s1">&#39;TEFF&#39;</span><span class="p">][</span><span class="n">indx</span><span class="p">],</span> <span class="n">allstar</span><span class="p">[</span><span class="s1">&#39;LOGG&#39;</span><span class="p">][</span><span class="n">indx</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">allstar</span><span class="p">[</span><span class="s1">&#39;FE_H&#39;</span><span class="p">][</span><span class="n">indx</span><span class="p">],</span>
                    <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                    <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;APOGEE Parameters&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1"># params from aspcapstar (uncalibrated)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WARNING: Quality Warning Flags on ASPCAP star parameters. ASPCAP parameters may not be reliable for this star.&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">apogee_spec</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;FPARAM&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">apogee_spec</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;FPARAM&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">apogee_spec</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;FPARAM&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
                    <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;APOGEE Parameters&#39;</span><span class="p">)</span>
                
    <span class="c1"># Labels and titles</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">7000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Effective Temperature [$T_{\rm</span><span class="si">{eff}</span><span class="s1">}$, K]&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Surface Gravity [$\log(g)$]&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;APOGEE Stellar Parameters - allStar&#39;</span><span class="p">)</span>
            
    <span class="c1"># ===================</span>
    <span class="c1"># AX2 - APOGEE Spectrum</span>
    <span class="c1"># ===================        </span>
    <span class="c1"># Get the observed and model flux from extensions 1 and 3</span>
    <span class="n">observed_flux</span> <span class="o">=</span> <span class="n">apogee_spec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">model_flux</span> <span class="o">=</span> <span class="n">apogee_spec</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    
    <span class="c1"># Mask the data using the error array in extenion 2</span>
    <span class="n">pixel_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">apogee_spec</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">)</span> <span class="c1"># use only pixels with small errors (10% or less)</span>
    
    <span class="c1"># Plot the observed spectrum</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">apogee_wls</span><span class="p">[</span><span class="n">pixel_mask</span><span class="p">],</span> <span class="n">observed_flux</span><span class="p">[</span><span class="n">pixel_mask</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observed Spectrum&#39;</span><span class="p">)</span>
    
    <span class="c1"># Plot the model spectrum</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">apogee_wls</span><span class="p">[</span><span class="n">pixel_mask</span><span class="p">],</span> <span class="n">model_flux</span><span class="p">[</span><span class="n">pixel_mask</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkred&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Best Fit Model Spectrum&#39;</span><span class="p">)</span>
    
    <span class="c1"># Set axes limits</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">apogee_wls</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">apogee_wls</span><span class="p">))</span>
    
    <span class="n">apogee_id</span> <span class="o">=</span> <span class="n">apogee_spec</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;APOGEE_ID&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># String containing star&#39;s name</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;APOGEE Spectrum - </span><span class="si">{</span><span class="n">apogee_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Wavelength [$\AA$]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Flux&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
    <span class="c1"># ===================</span>
    <span class="c1"># AX3 - TESS Light Curve</span>
    <span class="c1"># ===================</span>
    <span class="c1"># Plot Light Curve</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tess_lightcurve</span><span class="p">[</span><span class="s1">&#39;LIGHTCURVE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">],</span> <span class="n">tess_lightcurve</span><span class="p">[</span><span class="s1">&#39;LIGHTCURVE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;SAP_FLUX&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;TESS Light Curve&#39;</span><span class="p">)</span>
    
    <span class="c1"># Plot a vertical line for every day</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">tess_lightcurve</span><span class="p">[</span><span class="s1">&#39;LIGHTCURVE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">])),</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">tess_lightcurve</span><span class="p">[</span><span class="s1">&#39;LIGHTCURVE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]))):</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">)</span>
        
    <span class="c1"># Set labels</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;TESS-SPOC Light Curve - </span><span class="si">{</span><span class="n">tess_lightcurve</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;OBJECT&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [BTJD]&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Flux&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
            
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">save_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">apogee_id</span><span class="si">}</span><span class="s2">_APOGEE_spec_TESS_lightcurve.png&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saved to </span><span class="si">{</span><span class="n">save_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aspcap_star</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;mastDownload/SDSS/sdss_apogee_apo1m_cepheid_v1154_cyg/aspcapStar-dr17-V1154_Cyg.fits&#39;</span><span class="p">)</span>
<span class="n">tess_lc</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">manifest</span><span class="p">[</span><span class="s1">&#39;Local Path&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

<span class="n">plot_spectrum_and_lc</span><span class="p">(</span><span class="n">aspcap_star</span><span class="p">,</span> <span class="n">tess_lc</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Like we saw before, this star is a metal-poor horiztonal branch star, and has a period of about 6 days. A very cool example of a Cepheid Variable!</p>
<p><a id="Exploring-Variables"></a></p>
</section>
<section id="exploring-different-types-of-variable-stars">
<h2>Exploring different types of Variable Stars<a class="headerlink" href="#exploring-different-types-of-variable-stars" title="Permalink to this heading">#</a></h2>
<p>So far in this notebook, we’ve plotted the stellar parameters, spectrum, and light curve of a Cepheid variable star. But what about other types of variables? Here are a few more stars in APOGEE that we will explore and plot in this section!</p>
<ul class="simple">
<li><p>2M11361176+8117369: a RR Lyrae Variable Star, a type of quickly-pulsating old, low-mass star</p></li>
<li><p>2M19181706+5141323: a “Rotationally Variable” Star, a main sequence dwarf star with large starspots blocking out some of the flux on one side of the star as it rotates</p></li>
<li><p>2M19223768+5044541: an Eclipsing Binary Star, a type of close binary system with two stars rotating around each other</p></li>
</ul>
<p>Since we’re going to be going through the same process for each star (search for APOGEE data -&gt; search for TESS data -&gt; plot results), Let’s write a helper function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_variable_star</span><span class="p">(</span><span class="n">apogee_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function takes a star name from APOGEE and downloads the APOGEE and TESS</span>
<span class="sd">    data for this star. It then plots the APOGEE spectrum and TESS Lightcurve together.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    ============</span>
<span class="sd">    apogee_id: str</span>
<span class="sd">        name of star we want to plot</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plotting Spectrum and Light Curve for </span><span class="si">{</span><span class="n">apogee_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>

    <span class="c1"># Search for APOGEE Data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Searching For APOGEE Data...&quot;</span><span class="p">)</span>
    <span class="n">apogee_obs_list</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">provenance_name</span><span class="o">=</span><span class="s1">&#39;APOGEE&#39;</span><span class="p">,</span>
                                                  <span class="n">target_name</span><span class="o">=</span><span class="n">apogee_id</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Downloading APOGEE Data...&quot;</span><span class="p">)</span>
    <span class="c1"># Download APOGEE Spectrum</span>
    <span class="n">product_list</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">apogee_obs_list</span><span class="p">)</span>
    <span class="n">manifest</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">product_list</span><span class="p">,</span> <span class="n">productSubGroupDescription</span><span class="o">=</span><span class="s1">&#39;ASPCAPSTAR&#39;</span><span class="p">)</span>
    <span class="c1"># Open APOGEE Spectrum</span>
    <span class="n">aspcapstar</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">manifest</span><span class="p">[</span><span class="s1">&#39;Local Path&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Coordinates of Star</span>
    <span class="n">coord</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">apogee_obs_list</span><span class="p">[</span><span class="s1">&#39;s_ra&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="n">dec</span><span class="o">=</span><span class="n">apogee_obs_list</span><span class="p">[</span><span class="s1">&#39;s_dec&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>

    <span class="c1"># Search for TESS observations based on coordinates</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Searching For TESS Data...&quot;</span><span class="p">)</span>
    <span class="n">tess_obs</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">coordinates</span><span class="o">=</span><span class="n">coord</span><span class="p">,</span> <span class="c1"># Search by coordinates</span>
                                           <span class="n">radius</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">60</span><span class="o">/</span><span class="mi">60</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="c1"># search within 1 arcsecond</span>
                                           <span class="n">obs_collection</span><span class="o">=</span><span class="s1">&#39;TESS&#39;</span><span class="p">,</span> <span class="c1"># Search for TESS observations</span>
                                           <span class="n">intentType</span><span class="o">=</span><span class="s1">&#39;science&#39;</span><span class="p">,</span> <span class="c1"># Select only Science observations (not calibration files)</span>
                                           <span class="n">dataproduct_type</span><span class="o">=</span><span class="s1">&#39;timeseries&#39;</span><span class="p">,</span> <span class="n">dataURL</span><span class="o">=</span><span class="s2">&quot;*lc.fits&quot;</span><span class="p">)</span> <span class="c1"># Search for time series data (light curves)</span>

    <span class="c1"># Pick closest match by distance</span>
    <span class="n">tess_obs</span> <span class="o">=</span> <span class="n">tess_obs</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">tess_obs</span><span class="p">[</span><span class="s1">&#39;distance&#39;</span><span class="p">])]</span>

    <span class="c1"># Download TESS Light Curve</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Downloading TESS Data...&quot;</span><span class="p">)</span>
    <span class="n">tess_products</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">tess_obs</span><span class="p">)</span>
    <span class="n">manifest</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">tess_products</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Light curves&#39;</span><span class="p">)</span>

    <span class="c1"># Open light curve</span>
    <span class="n">tess_lc</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">manifest</span><span class="p">[</span><span class="s1">&#39;Local Path&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Plot star</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Making Plot...&quot;</span><span class="p">)</span>
    <span class="n">plot_spectrum_and_lc</span><span class="p">(</span><span class="n">aspcapstar</span><span class="p">,</span> <span class="n">tess_lc</span><span class="p">)</span>  
</pre></div>
</div>
</div>
</div>
<p><a id="rr-lyrae"></a></p>
</section>
<section id="rr-lyrae-variable-2m11361176-8117369">
<h2>RR Lyrae Variable - 2M11361176+8117369<a class="headerlink" href="#rr-lyrae-variable-2m11361176-8117369" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the star name we want to search for</span>
<span class="n">star_name</span> <span class="o">=</span> <span class="s1">&#39;2M11361176+8117369&#39;</span>
<span class="c1"># Call our helper function to download data and plot the results</span>
<span class="n">plot_variable_star</span><span class="p">(</span><span class="n">star_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This star is also a horizontal branch star, but it is hotter and more metal-poor than the Cepheid Variable was. It pulsates a lot more quickly too - from the light curve, the pulsation period is about 12 hours!</p>
<p><a id="rotationally-variable"></a></p>
</section>
<section id="rotationally-variable-2m19181706-5141323">
<h2>Rotationally Variable - 2M19181706+5141323<a class="headerlink" href="#rotationally-variable-2m19181706-5141323" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">star_name</span> <span class="o">=</span> <span class="s1">&#39;2M19181706+5141323&#39;</span>
<span class="n">plot_variable_star</span><span class="p">(</span><span class="n">star_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This star is a main-sequence dwarf star, a lot like the Sun but a little bit cooler in temperature. Its light curve is not as periodic as the other two, because the variation in flux is caused by the stars rotation, not pulsation! Large star spots likely block out the flux on part of this star, causing it to dip in brightness roughly every 14 days.</p>
<p><a id="eclipsing-binary"></a></p>
</section>
<section id="eclipsing-binary-star-2m19203184-3830492">
<h2>Eclipsing Binary Star - 2M19203184+3830492<a class="headerlink" href="#eclipsing-binary-star-2m19203184-3830492" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">star_name</span> <span class="o">=</span> <span class="s1">&#39;2M19203184+3830492&#39;</span>
<span class="n">plot_variable_star</span><span class="p">(</span><span class="n">star_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Every few days, this star’s flux dips dramatically in brightness by over 25%! This system is an eclipsing binary pair - a pair of stars orbiting around each other, and eclipsing one another along our line-of-sight, causing the fluctuations in brightness seen in the light curve.</p>
<p>Because this is an eclipsing binary pair, the ASPCAP parameters have a quality warning and may not be as reliable as the parameter estimates for other stars (which explains why the star is slightly off of the main sequence in the HR Diagram!). The single visit spectra (apVisit files) are probably more useful for most science cases involving binary stars than the combined spectrum (aspcapStar file) we plotted here. The apVisit files can be dowloaded using the <code class="docutils literal notranslate"><span class="pre">productSubGroupDescription='APVISIT'</span></code> keyword when downloading the products.</p>
<hr class="docutils" />
<p>Congratulations! You have reached the end of this tutorial notebook. You have learned how to access and download APOGEE data from MAST, and combine it with TESS light curves to characterize different types of variable stars.</p>
<p><a id="Resources"></a></p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="additional-resources">
<h1>Additional Resources<a class="headerlink" href="#additional-resources" title="Permalink to this heading">#</a></h1>
<p>Additional resources are linked below:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://outerspace.stsci.edu/display/SDSS/The+SDSS+Legacy+Archive+at+MAST">SDSS Legacy Archive at MAST</a></p></li>
<li><p><a class="reference external" href="https://www.sdss4.org/dr17/irspec/">SDSS-IV APOGEE Survey</a></p></li>
<li><p><a class="reference external" href="https://astroquery.readthedocs.io/en/latest/mast/mast.html">astroquery.mast User Manual</a></p></li>
<li><p><a class="reference external" href="https://mast.stsci.edu/api/v0/index.html">MAST API</a></p></li>
</ul>
<section id="citations">
<h2>Citations<a class="headerlink" href="#citations" title="Permalink to this heading">#</a></h2>
<p><a id="Citations"></a></p>
<p>If you use MaNGA data for published research, see the following links for information on which citations to include in your paper:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://sdss.org/collaboration/citing-sdss/">Citing SDSS</a></p></li>
<li><p><a class="reference external" href="https://www.sdss4.org/dr17/irspec/technical-papers-and-additional-references/">Citing APOGEE</a></p></li>
<li><p><a class="reference external" href="https://archive.stsci.edu/publishing/mission-acknowledgements">Citing MAST</a></p></li>
<li><p><a class="reference external" href="https://www.astropy.org/acknowledging.html">Citing astropy</a></p></li>
</ul>
</section>
<section id="about-this-notebook">
<h2>About this Notebook<a class="headerlink" href="#about-this-notebook" title="Permalink to this heading">#</a></h2>
<p><a id="About"></a></p>
<p><strong>Author(s):</strong> Julie Imig (jimig&#64;stsci.edu) <br>
<strong>Keyword(s):</strong> Tutorial, SDSS, APOGEE, TESS, stars <br>
<strong>First published:</strong> January 2025 <br>
<strong>Last updated:</strong> January 2025 <br></p>
<hr class="docutils" />
<p><span class="xref myst">Top of Page</span>
<a class="reference internal" href="https://raw.githubusercontent.com/spacetelescope/style-guides/master/guides/images/stsci-logo.png"><img alt="Space Telescope Logo" src="https://raw.githubusercontent.com/spacetelescope/style-guides/master/guides/images/stsci-logo.png" style="width: 200px;" /></a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/SDSS/APOGEE_TESS_tutorial"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../MaNGA_HST_tutorial/MaNGA_HST_tutorial.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Mapping Galaxy Properties with MaNGA + HST</p>
      </div>
    </a>
    <a class="right-next"
       href="../eBOSS_JWST_tutorial/eBOSS_JWST_tutorial.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Exploring High-Redshift Quasars with eBOSS and JWST</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Characterizing Variable Stars with APOGEE + TESS</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-apogee-data-at-mast">Accessing APOGEE data at MAST</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#querying-all-apogee-data">Querying all APOGEE data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-for-a-specific-star">Searching for a specific star</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-apogee-data-products">Downloading APOGEE data products</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-an-apogee-spectrum">Plotting an APOGEE Spectrum</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-the-apogee-allstar-catalog">Downloading the APOGEE allStar Catalog</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-an-hr-diagram-or-kiel-diagram-with-apogee">Plotting an HR Diagram (or Kiel Diagram) with APOGEE</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-for-tess-data-of-this-star">Searching for TESS Data of this Star</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coordinate-search-using-astroquery-mast">Coordinate search using astroquery.mast</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-a-light-curve-from-tess">Plotting a light curve from TESS</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-apogee-and-tess-data">Combining APOGEE and TESS data</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-apogee-and-tess-data-together">Plotting APOGEE and TESS data together</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exploring-different-types-of-variable-stars">Exploring different types of Variable Stars</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rr-lyrae-variable-2m11361176-8117369">RR Lyrae Variable - 2M11361176+8117369</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rotationally-variable-2m19181706-5141323">Rotationally Variable - 2M19181706+5141323</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eclipsing-binary-star-2m19203184-3830492">Eclipsing Binary Star - 2M19203184+3830492</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-resources">Additional Resources</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#citations">Citations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By STScI
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022-2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>